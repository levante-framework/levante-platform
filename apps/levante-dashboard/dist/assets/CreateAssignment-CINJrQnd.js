import{d as En,aM as yo,aD as wo,aE as xo,aF as _o,aN as Co,k as ue,a0 as Ae,w as Ue,j as st,aI as Zn,z as Jn,aO as Eo,aP as So,D as ft,aQ as eo,J as ko,ah as To,a2 as Do,O as Oo,aR as Ao,aS as yt,aT as Io,m as $o,e as Vo,s as No,aU as Po,f as Lo}from"./index-kdKfEdeI.js";import{s as it}from"./index-D6IoMtKH.js";import{s as In}from"./index-ai9ELtVp.js";import{a as Ro,s as ut}from"./index-d6wokVQG.js";import{s as to}from"./index-BEZzqj1Q.js";import{d as wt,e as De,f as Yt}from"./index-SnZVGOaT.js";import{s as Fo,_ as Ht}from"./index-CNfLgq8b.js";import{_ as nt}from"./forEach-Bss9sJkU.js";import{s as lt,_ as Vt,a as Mo}from"./index-Ca817Vow.js";import{u as Uo,_ as jo}from"./useDistrictsQuery-CeEXa47D.js";import{u as qo,r as $n,a as Nt}from"./index-BKPVmv-6.js";import{u as Bo,a as Yo,b as Ho,c as zo}from"./useGroupsQuery-nr4_Vz4U.js";import{u as Go}from"./useTaskVariantsQuery-DJR-0uxB.js";import{a8 as no,a9 as Xo,d as At,Z as Qo,h as Vn,g as gn,o as Sn,r as B,c as de,t as pe,R as k,O as _,F as Be,k as h,z as c,_ as $,S as s,N as j,W as G,a1 as H,a0 as mt,U as kn,Y as qe,M as Ke,a2 as Ee,w as je,$ as Zt,L as Jt,H as Me,V as Wo,ae as Ko,a4 as Zo,a7 as Jo,i as Nn,q as el}from"./tanstack-CsBZeLmk.js";import{_ as Pn}from"./debounce-Aau0xGE_.js";import{g as tl}from"./lodash-DAY8-RAI.js";import{s as oo}from"./index-DgqMGbNZ.js";import{s as en,_ as nl}from"./GroupPicker.vue_vue_type_style_index_0_lang-CQJrHQRv.js";import{s as Ln}from"./index-D4pzgRTJ.js";import{s as Tn}from"./index-CvlP-Xmk.js";import{s as Rn}from"./index-BbFXSlD1.js";import{_ as hn}from"./cloneDeep-Y1f-YOpN.js";import{m as ol}from"./marked.esm-C9B6iGib.js";import{s as ll}from"./index-CmbHKKL9.js";import{_ as sl}from"./capitalize-DtoFwN2t.js";import{T as Ze,a as Je}from"./toasts-BqURhU4z.js";import"./phoneme-MNW3QAs-.js";import"./sentry-CX5z418I.js";import"./index-BOUM9DJf.js";import"./index-DBlP99Qc.js";import"./index-DXN1oPWm.js";import"./_baseEach-Ab1i50PF.js";import"./_arrayEach-FC5DT91E.js";import"./toInteger-CM0MbwkG.js";import"./toNumber-iH9M7_fM.js";import"./tasks-DtSsBL6W.js";import"./useDistrictsListQuery-XZoLl8le.js";import"./orgs-C8TAQ0-m.js";import"./index-BktsoGN8.js";import"./index-DB9mnE3k.js";import"./upperFirst-CKgMld1W.js";(function(){try{var t=typeof window<"u"?window:typeof gn<"u"?gn:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},e=new t.Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="841f0efd-929a-4851-9b3c-704bb1749565",t._sentryDebugIdIdentifier="sentry-dbid-841f0efd-929a-4851-9b3c-704bb1749565")}catch{}})();const il=()=>{const t=En(),e=no();return Xo({mutationKey:yo,mutationFn:async n=>{await t.roarfirekit.upsertAdministration(n)},onSuccess:()=>{e.invalidateQueries({queryKey:[wo]}),e.invalidateQueries({queryKey:[xo]}),e.invalidateQueries({queryKey:[_o]})}})};var al=Co;function rl(t){return al(t).toLowerCase()}var dl=rl;const Ge=tl(dl);/**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Fn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,o)}return n}function Le(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Fn(Object(n),!0).forEach(function(o){ul(t,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Fn(Object(n)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(n,o))})}return t}function Mt(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Mt=function(e){return typeof e}:Mt=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mt(t)}function ul(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function He(){return He=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},He.apply(this,arguments)}function cl(t,e){if(t==null)return{};var n={},o=Object.keys(t),l,i;for(i=0;i<o.length;i++)l=o[i],!(e.indexOf(l)>=0)&&(n[l]=t[l]);return n}function fl(t,e){if(t==null)return{};var n=cl(t,e),o,l;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(l=0;l<i.length;l++)o=i[l],!(e.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(t,o)&&(n[o]=t[o])}return n}var pl="1.14.0";function Ye(t){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(t)}var ze=Ye(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),It=Ye(/Edge/i),Mn=Ye(/firefox/i),Et=Ye(/safari/i)&&!Ye(/chrome/i)&&!Ye(/android/i),lo=Ye(/iP(ad|od|hone)/i),ml=Ye(/chrome/i)&&Ye(/android/i),so={capture:!1,passive:!1};function W(t,e,n){t.addEventListener(e,n,!ze&&so)}function X(t,e,n){t.removeEventListener(e,n,!ze&&so)}function zt(t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch{return!1}return!1}}function gl(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function Ne(t,e,n,o){if(t){n=n||document;do{if(e!=null&&(e[0]===">"?t.parentNode===n&&zt(t,e):zt(t,e))||o&&t===n)return t;if(t===n)break}while(t=gl(t))}return null}var Un=/\s+/g;function _e(t,e,n){if(t&&e)if(t.classList)t.classList[n?"add":"remove"](e);else{var o=(" "+t.className+" ").replace(Un," ").replace(" "+e+" "," ");t.className=(o+(n?" "+e:"")).replace(Un," ")}}function L(t,e,n){var o=t&&t.style;if(o){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),e===void 0?n:n[e];!(e in o)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),o[e]=n+(typeof n=="string"?"":"px")}}function gt(t,e){var n="";if(typeof t=="string")n=t;else do{var o=L(t,"transform");o&&o!=="none"&&(n=o+" "+n)}while(!e&&(t=t.parentNode));var l=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return l&&new l(n)}function io(t,e,n){if(t){var o=t.getElementsByTagName(e),l=0,i=o.length;if(n)for(;l<i;l++)n(o[l],l);return o}return[]}function Pe(){var t=document.scrollingElement;return t||document.documentElement}function fe(t,e,n,o,l){if(!(!t.getBoundingClientRect&&t!==window)){var i,d,m,f,g,v,b;if(t!==window&&t.parentNode&&t!==Pe()?(i=t.getBoundingClientRect(),d=i.top,m=i.left,f=i.bottom,g=i.right,v=i.height,b=i.width):(d=0,m=0,f=window.innerHeight,g=window.innerWidth,v=window.innerHeight,b=window.innerWidth),(e||n)&&t!==window&&(l=l||t.parentNode,!ze))do if(l&&l.getBoundingClientRect&&(L(l,"transform")!=="none"||n&&L(l,"position")!=="static")){var I=l.getBoundingClientRect();d-=I.top+parseInt(L(l,"border-top-width")),m-=I.left+parseInt(L(l,"border-left-width")),f=d+i.height,g=m+i.width;break}while(l=l.parentNode);if(o&&t!==window){var P=gt(l||t),O=P&&P.a,N=P&&P.d;P&&(d/=N,m/=O,b/=O,v/=N,f=d+v,g=m+b)}return{top:d,left:m,bottom:f,right:g,width:b,height:v}}}function jn(t,e,n){for(var o=We(t,!0),l=fe(t)[e];o;){var i=fe(o)[n],d=void 0;if(d=l>=i,!d)return o;if(o===Pe())break;o=We(o,!1)}return!1}function ht(t,e,n,o){for(var l=0,i=0,d=t.children;i<d.length;){if(d[i].style.display!=="none"&&d[i]!==R.ghost&&(o||d[i]!==R.dragged)&&Ne(d[i],n.draggable,t,!1)){if(l===e)return d[i];l++}i++}return null}function Dn(t,e){for(var n=t.lastElementChild;n&&(n===R.ghost||L(n,"display")==="none"||e&&!zt(n,e));)n=n.previousElementSibling;return n||null}function Oe(t,e){var n=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)t.nodeName.toUpperCase()!=="TEMPLATE"&&t!==R.clone&&(!e||zt(t,e))&&n++;return n}function qn(t){var e=0,n=0,o=Pe();if(t)do{var l=gt(t),i=l.a,d=l.d;e+=t.scrollLeft*i,n+=t.scrollTop*d}while(t!==o&&(t=t.parentNode));return[e,n]}function hl(t,e){for(var n in t)if(t.hasOwnProperty(n)){for(var o in e)if(e.hasOwnProperty(o)&&e[o]===t[n][o])return Number(n)}return-1}function We(t,e){if(!t||!t.getBoundingClientRect)return Pe();var n=t,o=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var l=L(n);if(n.clientWidth<n.scrollWidth&&(l.overflowX=="auto"||l.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(l.overflowY=="auto"||l.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return Pe();if(o||e)return n;o=!0}}while(n=n.parentNode);return Pe()}function vl(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function tn(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}var St;function ao(t,e){return function(){if(!St){var n=arguments,o=this;n.length===1?t.call(o,n[0]):t.apply(o,n),St=setTimeout(function(){St=void 0},e)}}}function bl(){clearTimeout(St),St=void 0}function ro(t,e,n){t.scrollLeft+=e,t.scrollTop+=n}function uo(t){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):n?n(t).clone(!0)[0]:t.cloneNode(!0)}var Se="Sortable"+new Date().getTime();function yl(){var t=[],e;return{captureAnimationState:function(){if(t=[],!!this.options.animation){var o=[].slice.call(this.el.children);o.forEach(function(l){if(!(L(l,"display")==="none"||l===R.ghost)){t.push({target:l,rect:fe(l)});var i=Le({},t[t.length-1].rect);if(l.thisAnimationDuration){var d=gt(l,!0);d&&(i.top-=d.f,i.left-=d.e)}l.fromRect=i}})}},addAnimationState:function(o){t.push(o)},removeAnimationState:function(o){t.splice(hl(t,{target:o}),1)},animateAll:function(o){var l=this;if(!this.options.animation){clearTimeout(e),typeof o=="function"&&o();return}var i=!1,d=0;t.forEach(function(m){var f=0,g=m.target,v=g.fromRect,b=fe(g),I=g.prevFromRect,P=g.prevToRect,O=m.rect,N=gt(g,!0);N&&(b.top-=N.f,b.left-=N.e),g.toRect=b,g.thisAnimationDuration&&tn(I,b)&&!tn(v,b)&&(O.top-b.top)/(O.left-b.left)===(v.top-b.top)/(v.left-b.left)&&(f=xl(O,I,P,l.options)),tn(b,v)||(g.prevFromRect=v,g.prevToRect=b,f||(f=l.options.animation),l.animate(g,O,b,f)),f&&(i=!0,d=Math.max(d,f),clearTimeout(g.animationResetTimer),g.animationResetTimer=setTimeout(function(){g.animationTime=0,g.prevFromRect=null,g.fromRect=null,g.prevToRect=null,g.thisAnimationDuration=null},f),g.thisAnimationDuration=f)}),clearTimeout(e),i?e=setTimeout(function(){typeof o=="function"&&o()},d):typeof o=="function"&&o(),t=[]},animate:function(o,l,i,d){if(d){L(o,"transition",""),L(o,"transform","");var m=gt(this.el),f=m&&m.a,g=m&&m.d,v=(l.left-i.left)/(f||1),b=(l.top-i.top)/(g||1);o.animatingX=!!v,o.animatingY=!!b,L(o,"transform","translate3d("+v+"px,"+b+"px,0)"),this.forRepaintDummy=wl(o),L(o,"transition","transform "+d+"ms"+(this.options.easing?" "+this.options.easing:"")),L(o,"transform","translate3d(0,0,0)"),typeof o.animated=="number"&&clearTimeout(o.animated),o.animated=setTimeout(function(){L(o,"transition",""),L(o,"transform",""),o.animated=!1,o.animatingX=!1,o.animatingY=!1},d)}}}}function wl(t){return t.offsetWidth}function xl(t,e,n,o){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))*o.animation}var rt=[],nn={initializeByDefault:!0},$t={mount:function(e){for(var n in nn)nn.hasOwnProperty(n)&&!(n in e)&&(e[n]=nn[n]);rt.forEach(function(o){if(o.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),rt.push(e)},pluginEvent:function(e,n,o){var l=this;this.eventCanceled=!1,o.cancel=function(){l.eventCanceled=!0};var i=e+"Global";rt.forEach(function(d){n[d.pluginName]&&(n[d.pluginName][i]&&n[d.pluginName][i](Le({sortable:n},o)),n.options[d.pluginName]&&n[d.pluginName][e]&&n[d.pluginName][e](Le({sortable:n},o)))})},initializePlugins:function(e,n,o,l){rt.forEach(function(m){var f=m.pluginName;if(!(!e.options[f]&&!m.initializeByDefault)){var g=new m(e,n,e.options);g.sortable=e,g.options=e.options,e[f]=g,He(o,g.defaults)}});for(var i in e.options)if(e.options.hasOwnProperty(i)){var d=this.modifyOption(e,i,e.options[i]);typeof d<"u"&&(e.options[i]=d)}},getEventProperties:function(e,n){var o={};return rt.forEach(function(l){typeof l.eventProperties=="function"&&He(o,l.eventProperties.call(n[l.pluginName],e))}),o},modifyOption:function(e,n,o){var l;return rt.forEach(function(i){e[i.pluginName]&&i.optionListeners&&typeof i.optionListeners[n]=="function"&&(l=i.optionListeners[n].call(e[i.pluginName],o))}),l}};function _l(t){var e=t.sortable,n=t.rootEl,o=t.name,l=t.targetEl,i=t.cloneEl,d=t.toEl,m=t.fromEl,f=t.oldIndex,g=t.newIndex,v=t.oldDraggableIndex,b=t.newDraggableIndex,I=t.originalEvent,P=t.putSortable,O=t.extraEventProperties;if(e=e||n&&n[Se],!!e){var N,V=e.options,J="on"+o.charAt(0).toUpperCase()+o.substr(1);window.CustomEvent&&!ze&&!It?N=new CustomEvent(o,{bubbles:!0,cancelable:!0}):(N=document.createEvent("Event"),N.initEvent(o,!0,!0)),N.to=d||n,N.from=m||n,N.item=l||n,N.clone=i,N.oldIndex=f,N.newIndex=g,N.oldDraggableIndex=v,N.newDraggableIndex=b,N.originalEvent=I,N.pullMode=P?P.lastPutMode:void 0;var E=Le(Le({},O),$t.getEventProperties(o,e));for(var x in E)N[x]=E[x];n&&n.dispatchEvent(N),V[J]&&V[J].call(e,N)}}var Cl=["evt"],we=function(e,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},l=o.evt,i=fl(o,Cl);$t.pluginEvent.bind(R)(e,n,Le({dragEl:w,parentEl:ie,ghostEl:M,rootEl:oe,nextEl:ot,lastDownEl:Ut,cloneEl:ae,cloneHidden:Qe,dragStarted:xt,putSortable:he,activeSortable:R.active,originalEvent:l,oldIndex:pt,oldDraggableIndex:kt,newIndex:Ce,newDraggableIndex:Xe,hideGhostForTarget:mo,unhideGhostForTarget:go,cloneNowHidden:function(){Qe=!0},cloneNowShown:function(){Qe=!1},dispatchSortableEvent:function(m){ye({sortable:n,name:m,originalEvent:l})}},i))};function ye(t){_l(Le({putSortable:he,cloneEl:ae,targetEl:w,rootEl:oe,oldIndex:pt,oldDraggableIndex:kt,newIndex:Ce,newDraggableIndex:Xe},t))}var w,ie,M,oe,ot,Ut,ae,Qe,pt,Ce,kt,Xe,Pt,he,ct=!1,Gt=!1,Xt=[],et,$e,on,ln,Bn,Yn,xt,dt,Tt,Dt=!1,Lt=!1,jt,be,sn=[],vn=!1,Qt=[],Kt=typeof document<"u",Rt=lo,Hn=It||ze?"cssFloat":"float",El=Kt&&!ml&&!lo&&"draggable"in document.createElement("div"),co=function(){if(Kt){if(ze)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto",t.style.pointerEvents==="auto"}}(),fo=function(e,n){var o=L(e),l=parseInt(o.width)-parseInt(o.paddingLeft)-parseInt(o.paddingRight)-parseInt(o.borderLeftWidth)-parseInt(o.borderRightWidth),i=ht(e,0,n),d=ht(e,1,n),m=i&&L(i),f=d&&L(d),g=m&&parseInt(m.marginLeft)+parseInt(m.marginRight)+fe(i).width,v=f&&parseInt(f.marginLeft)+parseInt(f.marginRight)+fe(d).width;if(o.display==="flex")return o.flexDirection==="column"||o.flexDirection==="column-reverse"?"vertical":"horizontal";if(o.display==="grid")return o.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&m.float&&m.float!=="none"){var b=m.float==="left"?"left":"right";return d&&(f.clear==="both"||f.clear===b)?"vertical":"horizontal"}return i&&(m.display==="block"||m.display==="flex"||m.display==="table"||m.display==="grid"||g>=l&&o[Hn]==="none"||d&&o[Hn]==="none"&&g+v>l)?"vertical":"horizontal"},Sl=function(e,n,o){var l=o?e.left:e.top,i=o?e.right:e.bottom,d=o?e.width:e.height,m=o?n.left:n.top,f=o?n.right:n.bottom,g=o?n.width:n.height;return l===m||i===f||l+d/2===m+g/2},kl=function(e,n){var o;return Xt.some(function(l){var i=l[Se].options.emptyInsertThreshold;if(!(!i||Dn(l))){var d=fe(l),m=e>=d.left-i&&e<=d.right+i,f=n>=d.top-i&&n<=d.bottom+i;if(m&&f)return o=l}}),o},po=function(e){function n(i,d){return function(m,f,g,v){var b=m.options.group.name&&f.options.group.name&&m.options.group.name===f.options.group.name;if(i==null&&(d||b))return!0;if(i==null||i===!1)return!1;if(d&&i==="clone")return i;if(typeof i=="function")return n(i(m,f,g,v),d)(m,f,g,v);var I=(d?m:f).options.group.name;return i===!0||typeof i=="string"&&i===I||i.join&&i.indexOf(I)>-1}}var o={},l=e.group;(!l||Mt(l)!="object")&&(l={name:l}),o.name=l.name,o.checkPull=n(l.pull,!0),o.checkPut=n(l.put),o.revertClone=l.revertClone,e.group=o},mo=function(){!co&&M&&L(M,"display","none")},go=function(){!co&&M&&L(M,"display","")};Kt&&document.addEventListener("click",function(t){if(Gt)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),Gt=!1,!1},!0);var tt=function(e){if(w){e=e.touches?e.touches[0]:e;var n=kl(e.clientX,e.clientY);if(n){var o={};for(var l in e)e.hasOwnProperty(l)&&(o[l]=e[l]);o.target=o.rootEl=n,o.preventDefault=void 0,o.stopPropagation=void 0,n[Se]._onDragOver(o)}}},Tl=function(e){w&&w.parentNode[Se]._isOutsideThisEl(e.target)};function R(t,e){if(!(t&&t.nodeType&&t.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=He({},e),t[Se]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return fo(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(d,m){d.setData("Text",m.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:R.supportPointer!==!1&&"PointerEvent"in window&&!Et,emptyInsertThreshold:5};$t.initializePlugins(this,t,n);for(var o in n)!(o in e)&&(e[o]=n[o]);po(e);for(var l in this)l.charAt(0)==="_"&&typeof this[l]=="function"&&(this[l]=this[l].bind(this));this.nativeDraggable=e.forceFallback?!1:El,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?W(t,"pointerdown",this._onTapStart):(W(t,"mousedown",this._onTapStart),W(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(W(t,"dragover",this),W(t,"dragenter",this)),Xt.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),He(this,yl())}R.prototype={constructor:R,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(dt=null)},_getDirection:function(e,n){return typeof this.options.direction=="function"?this.options.direction.call(this,e,n,w):this.options.direction},_onTapStart:function(e){if(e.cancelable){var n=this,o=this.el,l=this.options,i=l.preventOnFilter,d=e.type,m=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,f=(m||e).target,g=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||f,v=l.filter;if(Pl(o),!w&&!(/mousedown|pointerdown/.test(d)&&e.button!==0||l.disabled)&&!g.isContentEditable&&!(!this.nativeDraggable&&Et&&f&&f.tagName.toUpperCase()==="SELECT")&&(f=Ne(f,l.draggable,o,!1),!(f&&f.animated)&&Ut!==f)){if(pt=Oe(f),kt=Oe(f,l.draggable),typeof v=="function"){if(v.call(this,e,f,this)){ye({sortable:n,rootEl:g,name:"filter",targetEl:f,toEl:o,fromEl:o}),we("filter",n,{evt:e}),i&&e.cancelable&&e.preventDefault();return}}else if(v&&(v=v.split(",").some(function(b){if(b=Ne(g,b.trim(),o,!1),b)return ye({sortable:n,rootEl:b,name:"filter",targetEl:f,fromEl:o,toEl:o}),we("filter",n,{evt:e}),!0}),v)){i&&e.cancelable&&e.preventDefault();return}l.handle&&!Ne(g,l.handle,o,!1)||this._prepareDragStart(e,m,f)}}},_prepareDragStart:function(e,n,o){var l=this,i=l.el,d=l.options,m=i.ownerDocument,f;if(o&&!w&&o.parentNode===i){var g=fe(o);if(oe=i,w=o,ie=w.parentNode,ot=w.nextSibling,Ut=o,Pt=d.group,R.dragged=w,et={target:w,clientX:(n||e).clientX,clientY:(n||e).clientY},Bn=et.clientX-g.left,Yn=et.clientY-g.top,this._lastX=(n||e).clientX,this._lastY=(n||e).clientY,w.style["will-change"]="all",f=function(){if(we("delayEnded",l,{evt:e}),R.eventCanceled){l._onDrop();return}l._disableDelayedDragEvents(),!Mn&&l.nativeDraggable&&(w.draggable=!0),l._triggerDragStart(e,n),ye({sortable:l,name:"choose",originalEvent:e}),_e(w,d.chosenClass,!0)},d.ignore.split(",").forEach(function(v){io(w,v.trim(),an)}),W(m,"dragover",tt),W(m,"mousemove",tt),W(m,"touchmove",tt),W(m,"mouseup",l._onDrop),W(m,"touchend",l._onDrop),W(m,"touchcancel",l._onDrop),Mn&&this.nativeDraggable&&(this.options.touchStartThreshold=4,w.draggable=!0),we("delayStart",this,{evt:e}),d.delay&&(!d.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(It||ze))){if(R.eventCanceled){this._onDrop();return}W(m,"mouseup",l._disableDelayedDrag),W(m,"touchend",l._disableDelayedDrag),W(m,"touchcancel",l._disableDelayedDrag),W(m,"mousemove",l._delayedDragTouchMoveHandler),W(m,"touchmove",l._delayedDragTouchMoveHandler),d.supportPointer&&W(m,"pointermove",l._delayedDragTouchMoveHandler),l._dragStartTimer=setTimeout(f,d.delay)}else f()}},_delayedDragTouchMoveHandler:function(e){var n=e.touches?e.touches[0]:e;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){w&&an(w),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;X(e,"mouseup",this._disableDelayedDrag),X(e,"touchend",this._disableDelayedDrag),X(e,"touchcancel",this._disableDelayedDrag),X(e,"mousemove",this._delayedDragTouchMoveHandler),X(e,"touchmove",this._delayedDragTouchMoveHandler),X(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,n){n=n||e.pointerType=="touch"&&e,!this.nativeDraggable||n?this.options.supportPointer?W(document,"pointermove",this._onTouchMove):n?W(document,"touchmove",this._onTouchMove):W(document,"mousemove",this._onTouchMove):(W(w,"dragend",this),W(oe,"dragstart",this._onDragStart));try{document.selection?qt(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,n){if(ct=!1,oe&&w){we("dragStarted",this,{evt:n}),this.nativeDraggable&&W(document,"dragover",Tl);var o=this.options;!e&&_e(w,o.dragClass,!1),_e(w,o.ghostClass,!0),R.active=this,e&&this._appendGhost(),ye({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if($e){this._lastX=$e.clientX,this._lastY=$e.clientY,mo();for(var e=document.elementFromPoint($e.clientX,$e.clientY),n=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint($e.clientX,$e.clientY),e!==n);)n=e;if(w.parentNode[Se]._isOutsideThisEl(e),n)do{if(n[Se]){var o=void 0;if(o=n[Se]._onDragOver({clientX:$e.clientX,clientY:$e.clientY,target:e,rootEl:n}),o&&!this.options.dragoverBubble)break}e=n}while(n=n.parentNode);go()}},_onTouchMove:function(e){if(et){var n=this.options,o=n.fallbackTolerance,l=n.fallbackOffset,i=e.touches?e.touches[0]:e,d=M&&gt(M,!0),m=M&&d&&d.a,f=M&&d&&d.d,g=Rt&&be&&qn(be),v=(i.clientX-et.clientX+l.x)/(m||1)+(g?g[0]-sn[0]:0)/(m||1),b=(i.clientY-et.clientY+l.y)/(f||1)+(g?g[1]-sn[1]:0)/(f||1);if(!R.active&&!ct){if(o&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<o)return;this._onDragStart(e,!0)}if(M){d?(d.e+=v-(on||0),d.f+=b-(ln||0)):d={a:1,b:0,c:0,d:1,e:v,f:b};var I="matrix(".concat(d.a,",").concat(d.b,",").concat(d.c,",").concat(d.d,",").concat(d.e,",").concat(d.f,")");L(M,"webkitTransform",I),L(M,"mozTransform",I),L(M,"msTransform",I),L(M,"transform",I),on=v,ln=b,$e=i}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!M){var e=this.options.fallbackOnBody?document.body:oe,n=fe(w,!0,Rt,!0,e),o=this.options;if(Rt){for(be=e;L(be,"position")==="static"&&L(be,"transform")==="none"&&be!==document;)be=be.parentNode;be!==document.body&&be!==document.documentElement?(be===document&&(be=Pe()),n.top+=be.scrollTop,n.left+=be.scrollLeft):be=Pe(),sn=qn(be)}M=w.cloneNode(!0),_e(M,o.ghostClass,!1),_e(M,o.fallbackClass,!0),_e(M,o.dragClass,!0),L(M,"transition",""),L(M,"transform",""),L(M,"box-sizing","border-box"),L(M,"margin",0),L(M,"top",n.top),L(M,"left",n.left),L(M,"width",n.width),L(M,"height",n.height),L(M,"opacity","0.8"),L(M,"position",Rt?"absolute":"fixed"),L(M,"zIndex","100000"),L(M,"pointerEvents","none"),R.ghost=M,e.appendChild(M),L(M,"transform-origin",Bn/parseInt(M.style.width)*100+"% "+Yn/parseInt(M.style.height)*100+"%")}},_onDragStart:function(e,n){var o=this,l=e.dataTransfer,i=o.options;if(we("dragStart",this,{evt:e}),R.eventCanceled){this._onDrop();return}we("setupClone",this),R.eventCanceled||(ae=uo(w),ae.draggable=!1,ae.style["will-change"]="",this._hideClone(),_e(ae,this.options.chosenClass,!1),R.clone=ae),o.cloneId=qt(function(){we("clone",o),!R.eventCanceled&&(o.options.removeCloneOnHide||oe.insertBefore(ae,w),o._hideClone(),ye({sortable:o,name:"clone"}))}),!n&&_e(w,i.dragClass,!0),n?(Gt=!0,o._loopId=setInterval(o._emulateDragOver,50)):(X(document,"mouseup",o._onDrop),X(document,"touchend",o._onDrop),X(document,"touchcancel",o._onDrop),l&&(l.effectAllowed="move",i.setData&&i.setData.call(o,l,w)),W(document,"drop",o),L(w,"transform","translateZ(0)")),ct=!0,o._dragStartId=qt(o._dragStarted.bind(o,n,e)),W(document,"selectstart",o),xt=!0,Et&&L(document.body,"user-select","none")},_onDragOver:function(e){var n=this.el,o=e.target,l,i,d,m=this.options,f=m.group,g=R.active,v=Pt===f,b=m.sort,I=he||g,P,O=this,N=!1;if(vn)return;function V(se,Ve){we(se,O,Le({evt:e,isOwner:v,axis:P?"vertical":"horizontal",revert:d,dragRect:l,targetRect:i,canSort:b,fromSortable:I,target:o,completed:E,onMove:function(a,U){return Ft(oe,n,w,l,a,fe(a),e,U)},changed:x},Ve))}function J(){V("dragOverAnimationCapture"),O.captureAnimationState(),O!==I&&I.captureAnimationState()}function E(se){return V("dragOverCompleted",{insertion:se}),se&&(v?g._hideClone():g._showClone(O),O!==I&&(_e(w,he?he.options.ghostClass:g.options.ghostClass,!1),_e(w,m.ghostClass,!0)),he!==O&&O!==R.active?he=O:O===R.active&&he&&(he=null),I===O&&(O._ignoreWhileAnimating=o),O.animateAll(function(){V("dragOverAnimationComplete"),O._ignoreWhileAnimating=null}),O!==I&&(I.animateAll(),I._ignoreWhileAnimating=null)),(o===w&&!w.animated||o===n&&!o.animated)&&(dt=null),!m.dragoverBubble&&!e.rootEl&&o!==document&&(w.parentNode[Se]._isOutsideThisEl(e.target),!se&&tt(e)),!m.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),N=!0}function x(){Ce=Oe(w),Xe=Oe(w,m.draggable),ye({sortable:O,name:"change",toEl:n,newIndex:Ce,newDraggableIndex:Xe,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),o=Ne(o,m.draggable,n,!0),V("dragOver"),R.eventCanceled)return N;if(w.contains(e.target)||o.animated&&o.animatingX&&o.animatingY||O._ignoreWhileAnimating===o)return E(!1);if(Gt=!1,g&&!m.disabled&&(v?b||(d=ie!==oe):he===this||(this.lastPutMode=Pt.checkPull(this,g,w,e))&&f.checkPut(this,g,w,e))){if(P=this._getDirection(e,o)==="vertical",l=fe(w),V("dragOverValid"),R.eventCanceled)return N;if(d)return ie=oe,J(),this._hideClone(),V("revert"),R.eventCanceled||(ot?oe.insertBefore(w,ot):oe.appendChild(w)),E(!0);var K=Dn(n,m.draggable);if(!K||Il(e,P,this)&&!K.animated){if(K===w)return E(!1);if(K&&n===e.target&&(o=K),o&&(i=fe(o)),Ft(oe,n,w,l,o,i,e,!!o)!==!1)return J(),n.appendChild(w),ie=n,x(),E(!0)}else if(K&&Al(e,P,this)){var A=ht(n,0,m,!0);if(A===w)return E(!1);if(o=A,i=fe(o),Ft(oe,n,w,l,o,i,e,!1)!==!1)return J(),n.insertBefore(w,A),ie=n,x(),E(!0)}else if(o.parentNode===n){i=fe(o);var ne=0,Z,te=w.parentNode!==n,z=!Sl(w.animated&&w.toRect||l,o.animated&&o.toRect||i,P),T=P?"top":"left",r=jn(o,"top","top")||jn(w,"top","top"),p=r?r.scrollTop:void 0;dt!==o&&(Z=i[T],Dt=!1,Lt=!z&&m.invertSwap||te),ne=$l(e,o,i,P,z?1:m.swapThreshold,m.invertedSwapThreshold==null?m.swapThreshold:m.invertedSwapThreshold,Lt,dt===o);var u;if(ne!==0){var y=Oe(w);do y-=ne,u=ie.children[y];while(u&&(L(u,"display")==="none"||u===M))}if(ne===0||u===o)return E(!1);dt=o,Tt=ne;var q=o.nextElementSibling,Y=!1;Y=ne===1;var ce=Ft(oe,n,w,l,o,i,e,Y);if(ce!==!1)return(ce===1||ce===-1)&&(Y=ce===1),vn=!0,setTimeout(Ol,30),J(),Y&&!q?n.appendChild(w):o.parentNode.insertBefore(w,Y?q:o),r&&ro(r,0,p-r.scrollTop),ie=w.parentNode,Z!==void 0&&!Lt&&(jt=Math.abs(Z-fe(o)[T])),x(),E(!0)}if(n.contains(w))return E(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){X(document,"mousemove",this._onTouchMove),X(document,"touchmove",this._onTouchMove),X(document,"pointermove",this._onTouchMove),X(document,"dragover",tt),X(document,"mousemove",tt),X(document,"touchmove",tt)},_offUpEvents:function(){var e=this.el.ownerDocument;X(e,"mouseup",this._onDrop),X(e,"touchend",this._onDrop),X(e,"pointerup",this._onDrop),X(e,"touchcancel",this._onDrop),X(document,"selectstart",this)},_onDrop:function(e){var n=this.el,o=this.options;if(Ce=Oe(w),Xe=Oe(w,o.draggable),we("drop",this,{evt:e}),ie=w&&w.parentNode,Ce=Oe(w),Xe=Oe(w,o.draggable),R.eventCanceled){this._nulling();return}ct=!1,Lt=!1,Dt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),bn(this.cloneId),bn(this._dragStartId),this.nativeDraggable&&(X(document,"drop",this),X(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Et&&L(document.body,"user-select",""),L(w,"transform",""),e&&(xt&&(e.cancelable&&e.preventDefault(),!o.dropBubble&&e.stopPropagation()),M&&M.parentNode&&M.parentNode.removeChild(M),(oe===ie||he&&he.lastPutMode!=="clone")&&ae&&ae.parentNode&&ae.parentNode.removeChild(ae),w&&(this.nativeDraggable&&X(w,"dragend",this),an(w),w.style["will-change"]="",xt&&!ct&&_e(w,he?he.options.ghostClass:this.options.ghostClass,!1),_e(w,this.options.chosenClass,!1),ye({sortable:this,name:"unchoose",toEl:ie,newIndex:null,newDraggableIndex:null,originalEvent:e}),oe!==ie?(Ce>=0&&(ye({rootEl:ie,name:"add",toEl:ie,fromEl:oe,originalEvent:e}),ye({sortable:this,name:"remove",toEl:ie,originalEvent:e}),ye({rootEl:ie,name:"sort",toEl:ie,fromEl:oe,originalEvent:e}),ye({sortable:this,name:"sort",toEl:ie,originalEvent:e})),he&&he.save()):Ce!==pt&&Ce>=0&&(ye({sortable:this,name:"update",toEl:ie,originalEvent:e}),ye({sortable:this,name:"sort",toEl:ie,originalEvent:e})),R.active&&((Ce==null||Ce===-1)&&(Ce=pt,Xe=kt),ye({sortable:this,name:"end",toEl:ie,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){we("nulling",this),oe=w=ie=M=ot=ae=Ut=Qe=et=$e=xt=Ce=Xe=pt=kt=dt=Tt=he=Pt=R.dragged=R.ghost=R.clone=R.active=null,Qt.forEach(function(e){e.checked=!0}),Qt.length=on=ln=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":w&&(this._onDragOver(e),Dl(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],n,o=this.el.children,l=0,i=o.length,d=this.options;l<i;l++)n=o[l],Ne(n,d.draggable,this.el,!1)&&e.push(n.getAttribute(d.dataIdAttr)||Nl(n));return e},sort:function(e,n){var o={},l=this.el;this.toArray().forEach(function(i,d){var m=l.children[d];Ne(m,this.options.draggable,l,!1)&&(o[i]=m)},this),n&&this.captureAnimationState(),e.forEach(function(i){o[i]&&(l.removeChild(o[i]),l.appendChild(o[i]))}),n&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,n){return Ne(e,n||this.options.draggable,this.el,!1)},option:function(e,n){var o=this.options;if(n===void 0)return o[e];var l=$t.modifyOption(this,e,n);typeof l<"u"?o[e]=l:o[e]=n,e==="group"&&po(o)},destroy:function(){we("destroy",this);var e=this.el;e[Se]=null,X(e,"mousedown",this._onTapStart),X(e,"touchstart",this._onTapStart),X(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(X(e,"dragover",this),X(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Xt.splice(Xt.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Qe){if(we("hideClone",this),R.eventCanceled)return;L(ae,"display","none"),this.options.removeCloneOnHide&&ae.parentNode&&ae.parentNode.removeChild(ae),Qe=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Qe){if(we("showClone",this),R.eventCanceled)return;w.parentNode==oe&&!this.options.group.revertClone?oe.insertBefore(ae,w):ot?oe.insertBefore(ae,ot):oe.appendChild(ae),this.options.group.revertClone&&this.animate(w,ae),L(ae,"display",""),Qe=!1}}};function Dl(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function Ft(t,e,n,o,l,i,d,m){var f,g=t[Se],v=g.options.onMove,b;return window.CustomEvent&&!ze&&!It?f=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(f=document.createEvent("Event"),f.initEvent("move",!0,!0)),f.to=e,f.from=t,f.dragged=n,f.draggedRect=o,f.related=l||e,f.relatedRect=i||fe(e),f.willInsertAfter=m,f.originalEvent=d,t.dispatchEvent(f),v&&(b=v.call(g,f,d)),b}function an(t){t.draggable=!1}function Ol(){vn=!1}function Al(t,e,n){var o=fe(ht(n.el,0,n.options,!0)),l=10;return e?t.clientX<o.left-l||t.clientY<o.top&&t.clientX<o.right:t.clientY<o.top-l||t.clientY<o.bottom&&t.clientX<o.left}function Il(t,e,n){var o=fe(Dn(n.el,n.options.draggable)),l=10;return e?t.clientX>o.right+l||t.clientX<=o.right&&t.clientY>o.bottom&&t.clientX>=o.left:t.clientX>o.right&&t.clientY>o.top||t.clientX<=o.right&&t.clientY>o.bottom+l}function $l(t,e,n,o,l,i,d,m){var f=o?t.clientY:t.clientX,g=o?n.height:n.width,v=o?n.top:n.left,b=o?n.bottom:n.right,I=!1;if(!d){if(m&&jt<g*l){if(!Dt&&(Tt===1?f>v+g*i/2:f<b-g*i/2)&&(Dt=!0),Dt)I=!0;else if(Tt===1?f<v+jt:f>b-jt)return-Tt}else if(f>v+g*(1-l)/2&&f<b-g*(1-l)/2)return Vl(e)}return I=I||d,I&&(f<v+g*i/2||f>b-g*i/2)?f>v+g/2?1:-1:0}function Vl(t){return Oe(w)<Oe(t)?1:-1}function Nl(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,o=0;n--;)o+=e.charCodeAt(n);return o.toString(36)}function Pl(t){Qt.length=0;for(var e=t.getElementsByTagName("input"),n=e.length;n--;){var o=e[n];o.checked&&Qt.push(o)}}function qt(t){return setTimeout(t,0)}function bn(t){return clearTimeout(t)}Kt&&W(document,"touchmove",function(t){(R.active||ct)&&t.cancelable&&t.preventDefault()});R.utils={on:W,off:X,css:L,find:io,is:function(e,n){return!!Ne(e,n,e,!1)},extend:vl,throttle:ao,closest:Ne,toggleClass:_e,clone:uo,index:Oe,nextTick:qt,cancelNextTick:bn,detectDirection:fo,getChild:ht};R.get=function(t){return t[Se]};R.mount=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e[0].constructor===Array&&(e=e[0]),e.forEach(function(o){if(!o.prototype||!o.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(o));o.utils&&(R.utils=Le(Le({},R.utils),o.utils)),$t.mount(o)})};R.create=function(t,e){return new R(t,e)};R.version=pl;var re=[],_t,yn,wn=!1,rn,dn,Wt,Ct;function Ll(){function t(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return t.prototype={dragStarted:function(n){var o=n.originalEvent;this.sortable.nativeDraggable?W(document,"dragover",this._handleAutoScroll):this.options.supportPointer?W(document,"pointermove",this._handleFallbackAutoScroll):o.touches?W(document,"touchmove",this._handleFallbackAutoScroll):W(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var o=n.originalEvent;!this.options.dragOverBubble&&!o.rootEl&&this._handleAutoScroll(o)},drop:function(){this.sortable.nativeDraggable?X(document,"dragover",this._handleAutoScroll):(X(document,"pointermove",this._handleFallbackAutoScroll),X(document,"touchmove",this._handleFallbackAutoScroll),X(document,"mousemove",this._handleFallbackAutoScroll)),zn(),Bt(),bl()},nulling:function(){Wt=yn=_t=wn=Ct=rn=dn=null,re.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,o){var l=this,i=(n.touches?n.touches[0]:n).clientX,d=(n.touches?n.touches[0]:n).clientY,m=document.elementFromPoint(i,d);if(Wt=n,o||this.options.forceAutoScrollFallback||It||ze||Et){un(n,this.options,m,o);var f=We(m,!0);wn&&(!Ct||i!==rn||d!==dn)&&(Ct&&zn(),Ct=setInterval(function(){var g=We(document.elementFromPoint(i,d),!0);g!==f&&(f=g,Bt()),un(n,l.options,g,o)},10),rn=i,dn=d)}else{if(!this.options.bubbleScroll||We(m,!0)===Pe()){Bt();return}un(n,this.options,We(m,!1),!1)}}},He(t,{pluginName:"scroll",initializeByDefault:!0})}function Bt(){re.forEach(function(t){clearInterval(t.pid)}),re=[]}function zn(){clearInterval(Ct)}var un=ao(function(t,e,n,o){if(e.scroll){var l=(t.touches?t.touches[0]:t).clientX,i=(t.touches?t.touches[0]:t).clientY,d=e.scrollSensitivity,m=e.scrollSpeed,f=Pe(),g=!1,v;yn!==n&&(yn=n,Bt(),_t=e.scroll,v=e.scrollFn,_t===!0&&(_t=We(n,!0)));var b=0,I=_t;do{var P=I,O=fe(P),N=O.top,V=O.bottom,J=O.left,E=O.right,x=O.width,K=O.height,A=void 0,ne=void 0,Z=P.scrollWidth,te=P.scrollHeight,z=L(P),T=P.scrollLeft,r=P.scrollTop;P===f?(A=x<Z&&(z.overflowX==="auto"||z.overflowX==="scroll"||z.overflowX==="visible"),ne=K<te&&(z.overflowY==="auto"||z.overflowY==="scroll"||z.overflowY==="visible")):(A=x<Z&&(z.overflowX==="auto"||z.overflowX==="scroll"),ne=K<te&&(z.overflowY==="auto"||z.overflowY==="scroll"));var p=A&&(Math.abs(E-l)<=d&&T+x<Z)-(Math.abs(J-l)<=d&&!!T),u=ne&&(Math.abs(V-i)<=d&&r+K<te)-(Math.abs(N-i)<=d&&!!r);if(!re[b])for(var y=0;y<=b;y++)re[y]||(re[y]={});(re[b].vx!=p||re[b].vy!=u||re[b].el!==P)&&(re[b].el=P,re[b].vx=p,re[b].vy=u,clearInterval(re[b].pid),(p!=0||u!=0)&&(g=!0,re[b].pid=setInterval((function(){o&&this.layer===0&&R.active._onTouchMove(Wt);var q=re[this.layer].vy?re[this.layer].vy*m:0,Y=re[this.layer].vx?re[this.layer].vx*m:0;typeof v=="function"&&v.call(R.dragged.parentNode[Se],Y,q,t,Wt,re[this.layer].el)!=="continue"||ro(re[this.layer].el,Y,q)}).bind({layer:b}),24))),b++}while(e.bubbleScroll&&I!==f&&(I=We(I,!1)));wn=g}},30),ho=function(e){var n=e.originalEvent,o=e.putSortable,l=e.dragEl,i=e.activeSortable,d=e.dispatchSortableEvent,m=e.hideGhostForTarget,f=e.unhideGhostForTarget;if(n){var g=o||i;m();var v=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,b=document.elementFromPoint(v.clientX,v.clientY);f(),g&&!g.el.contains(b)&&(d("spill"),this.onSpill({dragEl:l,putSortable:o}))}};function On(){}On.prototype={startIndex:null,dragStart:function(e){var n=e.oldDraggableIndex;this.startIndex=n},onSpill:function(e){var n=e.dragEl,o=e.putSortable;this.sortable.captureAnimationState(),o&&o.captureAnimationState();var l=ht(this.sortable.el,this.startIndex,this.options);l?this.sortable.el.insertBefore(n,l):this.sortable.el.appendChild(n),this.sortable.animateAll(),o&&o.animateAll()},drop:ho};He(On,{pluginName:"revertOnSpill"});function An(){}An.prototype={onSpill:function(e){var n=e.dragEl,o=e.putSortable,l=o||this.sortable;l.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),l.animateAll()},drop:ho};He(An,{pluginName:"removeOnSpill"});R.mount(new Ll);R.mount(An,On);function Rl(){return typeof window<"u"?window.console:gn.console}const Fl=Rl();function Ml(t){const e=Object.create(null);return function(o){return e[o]||(e[o]=t(o))}}const Ul=/-(\w)/g,Gn=Ml(t=>t.replace(Ul,(e,n)=>n?n.toUpperCase():""));function cn(t){t.parentElement!==null&&t.parentElement.removeChild(t)}function Xn(t,e,n){const o=n===0?t.children[0]:t.children[n-1].nextSibling;t.insertBefore(e,o)}function jl(t,e){return Object.values(t).indexOf(e)}function ql(t,e,n,o){if(!t)return[];const l=Object.values(t),i=e.length-o;return[...e].map((m,f)=>f>=i?l.length:l.indexOf(m))}function vo(t,e){this.$nextTick(()=>this.$emit(t.toLowerCase(),e))}function Bl(t){return e=>{this.realList!==null&&this["onDrag"+t](e),vo.call(this,t,e)}}function Yl(t){return["transition-group","TransitionGroup"].includes(t)}function Hl(t){if(!t||t.length!==1)return!1;const[{type:e}]=t;return e?Yl(e.name):!1}function zl(t,e){return e?{...e.props,...e.attrs}:t}const xn=["Start","Add","Remove","Update","End"],_n=["Choose","Unchoose","Sort","Filter","Clone"],Gl=["Move",...xn,..._n].map(t=>"on"+t);let fn=null;const Xl={options:Object,list:{type:Array,required:!1,default:null},noTransitionOnDrag:{type:Boolean,default:!1},clone:{type:Function,default:t=>t},tag:{type:String,default:"div"},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null},component:{type:String,default:null},modelValue:{type:Array,required:!1,default:null}},pn=At({name:"VueDraggableNext",inheritAttrs:!1,emits:["update:modelValue","move","change",...xn.map(t=>t.toLowerCase()),..._n.map(t=>t.toLowerCase())],props:Xl,data(){return{transitionMode:!1,noneFunctionalComponentMode:!1,headerOffset:0,footerOffset:0,_sortable:{},visibleIndexes:[],context:{}}},render(){const t=this.$slots.default?this.$slots.default():null,e=zl(this.$attrs,this.componentData);return t?(this.transitionMode=Hl(t),Vn(this.getTag(),e,t)):Vn(this.getTag(),e,[])},created(){this.list!==null&&this.modelValue!==null&&Fl.error("list props are mutually exclusive! Please set one.")},mounted(){const t={};xn.forEach(l=>{t["on"+l]=Bl.call(this,l)}),_n.forEach(l=>{t["on"+l]=vo.bind(this,l)});const e=Object.keys(this.$attrs).reduce((l,i)=>(l[Gn(i)]=this.$attrs[i],l),{}),n=Object.assign({},e,t,{onMove:(l,i)=>this.onDragMove(l,i)});!("draggable"in n)&&(n.draggable=">*");const o=this.$el.nodeType===1?this.$el:this.$el.parentElement;this._sortable=new R(o,n),o.__draggable_component__=this,this.computeIndexes()},beforeUnmount(){try{this._sortable!==void 0&&this._sortable.destroy()}catch{}},computed:{realList(){return this.list?this.list:this.modelValue}},watch:{$attrs:{handler(t){this.updateOptions(t)},deep:!0},realList(){this.computeIndexes()}},methods:{getTag(){return this.component?Qo(this.component):this.tag},updateOptions(t){for(var e in t){const n=Gn(e);Gl.indexOf(n)===-1&&this._sortable.option(n,t[e])}},getChildrenNodes(){return this.$el.children},computeIndexes(){this.$nextTick(()=>{this.visibleIndexes=ql(this.getChildrenNodes(),this.$el.children,this.transitionMode,this.footerOffset)})},getUnderlyingVm(t){const e=jl(this.getChildrenNodes()||[],t);if(e===-1)return null;const n=this.realList[e];return{index:e,element:n}},emitChanges(t){this.$nextTick(()=>{this.$emit("change",t)})},alterList(t){if(this.list){t(this.list);return}const e=[...this.modelValue];t(e),this.$emit("update:modelValue",e)},spliceList(){const t=e=>e.splice(...arguments);this.alterList(t)},updatePosition(t,e){const n=o=>o.splice(e,0,o.splice(t,1)[0]);this.alterList(n)},getVmIndex(t){const e=this.visibleIndexes,n=e.length;return t>n-1?n:e[t]},getComponent(){return this.$slots.default?this.$slots.default()[0].componentInstance:null},resetTransitionData(t){if(!this.noTransitionOnDrag||!this.transitionMode)return;var e=this.getChildrenNodes();e[t].data=null;const n=this.getComponent();n.children=[],n.kept=void 0},onDragStart(t){this.computeIndexes(),this.context=this.getUnderlyingVm(t.item),this.context&&(t.item._underlying_vm_=this.clone(this.context.element),fn=t.item)},onDragAdd(t){const e=t.item._underlying_vm_;if(e===void 0)return;cn(t.item);const n=this.getVmIndex(t.newIndex);this.spliceList(n,0,e),this.computeIndexes();const o={element:e,newIndex:n};this.emitChanges({added:o})},onDragRemove(t){if(Xn(this.$el,t.item,t.oldIndex),t.pullMode==="clone"){cn(t.clone);return}if(!this.context)return;const e=this.context.index;this.spliceList(e,1);const n={element:this.context.element,oldIndex:e};this.resetTransitionData(e),this.emitChanges({removed:n})},onDragUpdate(t){cn(t.item),Xn(t.from,t.item,t.oldIndex);const e=this.context.index,n=this.getVmIndex(t.newIndex);this.updatePosition(e,n);const o={element:this.context.element,oldIndex:e,newIndex:n};this.emitChanges({moved:o})},updateProperty(t,e){t.hasOwnProperty(e)&&(t[e]+=this.headerOffset)},onDragMove(t,e){const n=this.move;if(!n||!this.realList)return!0;const o=this.getRelatedContextFromMoveEvent(t),l=this.context,i=this.computeFutureIndex(o,t);Object.assign(l,{futureIndex:i});const d=Object.assign({},t,{relatedContext:o,draggedContext:l});return n(d,e)},onDragEnd(){this.computeIndexes(),fn=null},getTrargetedComponent(t){return t.__draggable_component__},getRelatedContextFromMoveEvent({to:t,related:e}){const n=this.getTrargetedComponent(t);if(!n)return{component:n};const o=n.realList,l={list:o,component:n};if(t!==e&&o&&n.getUnderlyingVm){const i=n.getUnderlyingVm(e);if(i)return Object.assign(i,l)}return l},computeFutureIndex(t,e){const n=[...e.to.children].filter(d=>d.style.display!=="none");if(n.length===0)return 0;const o=n.indexOf(e.related),l=t.component.getVmIndex(o);return n.indexOf(fn)!==-1||!e.willInsertAfter?l:l+1}}}),Ql={class:"flex w-full align-items-center justify-content-around"},Wl={class:"flex flex-column w-full my-3 gap-2"},Kl={class:"text-3xl font-bold uppercase"},Zl={key:0,class:"gap-2"},Jl={class:"text-xl"},es={class:"flex w-6 justify-content-end"},ts=["src"],ns={class:"flex flex-column w-full my-2 gap-2"},os={class:"card p-fluid bg-gray-100 p-3"},ls={key:0,class:"flex flex-row flex-wrap justify-content-around align-content-center w-full font-semibold uppercase pr-6"},ss={key:1,class:"flex flex-column align-items-center justify-content-center py-2 gap-2"},is={class:"text-sm uppercase text-gray-700"},as={class:"flex gap-2 align-content-start flex-grow-0 params-container mb-2"},rs={class:"flex flex-row flex-wrap justify-content-between align-content-center gap-2 w-full"},ds={class:"flex flex-row flex-wrap justify-content-between align-content-center gap-2 w-full"},us={class:"flex flex-row flex-wrap justify-content-between align-content-center gap-2 w-full"},cs={class:"flex flex-row-reverse justify-content-between align-items-center"},fs={class:"mt-2 flex"},ps={class:"mt-2 flex flex-column gap-2"},ms={class:"card p-fluid bg-gray-100 p-3"},gs={key:0,class:"flex flex-row flex-wrap justify-content-around align-content-center w-full font-semibold uppercase pr-6"},hs={key:1,class:"flex flex-column align-items-center justify-content-center py-2 gap-2"},vs={key:0,class:"text-sm uppercase text-gray-700"},bs={key:1,class:"text-sm uppercase text-gray-700"},ys={class:"flex gap-2 align-content-start flex-grow-0 params-container mb-2"},ws={class:"flex flex-row flex-wrap justify-content-between align-content-center gap-2 w-full"},xs={class:"flex flex-row flex-wrap justify-content-between align-content-center gap-2 w-full"},_s={class:"flex flex-row flex-wrap justify-content-between align-content-center gap-2 w-full"},Cs={class:"flex flex-row justify-content-between align-items-center"},Es={class:"flex flex-row justify-content-end align-items-center gap-2 mr-2"},Ss={class:"uppercase text-md font-bold text-gray-600"},ks={class:"mt-2 flex gap-2"},Ts={class:"flex flex-column align-items-center gap-1 mx-2"},Ds={key:0,class:"text-sm"},Os={key:1,class:"text-sm"},As={class:"flex justify-content-center gap-2"},Is=At({__name:"EditVariantDialog",props:{assessment:{},updateVariant:{},preExistingAssessmentInfo:{default:()=>[]}},setup(t){const e=t;Sn(()=>{g(e.assessment.task.id),e.assessment.task.id!=="survey"&&o.value.push({field:{label:"User Type",value:"userType",project:"LEVANTE"},op:{label:"Equal",value:"EQUAL"},value:{label:"Child",value:"student"}})});const n=B(!1),o=B([]),l=B([]),i=B([]),d=T=>{const r=pe(T);if(!r)return;const p=typeof r=="string"?r:r.label;if(p==="Age")return[{label:"3",value:"3"},{label:"4",value:"4"},{label:"5",value:"5"},{label:"6",value:"6"},{label:"7",value:"7"},{label:"8",value:"8"},{label:"9",value:"9"},{label:"10",value:"10"},{label:"11",value:"11"},{label:"12",value:"12"}];if(p==="User Type")return[{label:"Child",value:"student"},{label:"Caregiver",value:"parent"},{label:"Teacher",value:"teacher"}]},m=T=>{const r=pe(T);if(!r)return;const p=typeof r=="string"?r:r.label;if(p==="Age")return[{label:"Less Than",value:"LESS_THAN"},{label:"Greater Than",value:"GREATER_THAN"},{label:"Less Than or Equal",value:"LESS_THAN_OR_EQUAL"},{label:"Greater Than or Equal",value:"GREATER_THAN_OR_EQUAL"},{label:"Equal",value:"EQUAL"},{label:"Not Equal",value:"NOT_EQUAL"}];if(p==="User Type")return[{label:"Equal",value:"EQUAL"},{label:"Not Equal",value:"NOT_EQUAL"}]},f=(T,r)=>{T.splice(r,1)};function g(T){const r=v(T),p=b(T);I(r),P(p)}function v(T){var r,p,u;return(u=(p=(r=e.preExistingAssessmentInfo.find(y=>y.taskId===T))==null?void 0:r.conditions)==null?void 0:p.assigned)==null?void 0:u.conditions}function b(T){var u,y;const r=e.preExistingAssessmentInfo.find(q=>q.taskId===T),p=(u=r==null?void 0:r.conditions)==null?void 0:u.optional;return p&&typeof p=="object"&&"conditions"in p?(V.value=!1,p.conditions):(V.value=!!((y=r==null?void 0:r.conditions)!=null&&y.optional),[])}function I(T){if(T)for(const r of T)o.value=[r,...o.value]}function P(T){if(T)for(const r of T)l.value=[r,...l.value]}const O=()=>{l.value.push({field:"",op:"",value:""})},N=()=>{o.value.push({field:"",op:"",value:""})},V=B(!1),J=B(""),E=()=>{V.value===!0?(i.value=l.value,l.value=[]):l.value=i.value},x=de(()=>{var T;return V.value&&((T=pe(i.value))==null?void 0:T.length)>0}),K=()=>{J.value="",o.value=[],l.value=[],g(e.assessment.task.id)},A=()=>{let T=!1;for(const r of o.value)for(const[p,u]of Object.entries(r))u==""&&(J.value="Missing fields in Assigned Conditions",T=!0);for(const r of l.value)for(const[p,u]of Object.entries(r))u==""&&(J.value="Missing fields in Optional Conditions",T=!0);if(!T){J.value="";const[r,p]=ne(),u=Z(r,p);V.value===!0&&(u.optional=!0),e.updateVariant(e.assessment.id,u),n.value=!1}};function ne(){const T=hn(o.value),r=hn(l.value);return T.forEach(p=>{for(const[u,y]of Object.entries(p))typeof y=="object"&&y!==null&&"value"in y&&(p[u]=y.value)}),r.forEach(p=>{for(const[u,y]of Object.entries(p))typeof y=="object"&&y!==null&&"value"in y&&(p[u]=y.value)}),[T,r]}const Z=(T,r)=>{const p={};return st(r)||(p.optional={op:"AND",conditions:r}),st(T)||(p.assigned={op:"AND",conditions:T}),p},te=[{label:"User Type",value:"userType",project:"LEVANTE"},{label:"Age",value:"age",project:"LEVANTE"}],z=de(()=>"selected group");return(T,r)=>(_(),k(Be,null,[h(c(ue),{class:"surface-hover border-1 border-300 border-circle hover:bg-primary p-0 m-2","data-cy":"button-edit-variant",onClick:r[0]||(r[0]=p=>n.value=!0)},{default:$(()=>r[3]||(r[3]=[s("i",{class:"pi pi-pencil text-primary hover:text-white-alpha-90 p-2",style:{"font-size":"1rem"}},null,-1)])),_:1,__:[3]}),h(c(Tn),{visible:n.value,"onUpdate:visible":r[2]||(r[2]=p=>n.value=p),draggable:!1,modal:"",header:"Edit Conditions","close-on-escape":!1,style:{width:"65vw"},breakpoints:{"1199px":"85vw","575px":"95vw"}},{default:$(()=>{var p,u;return[s("div",Ql,[s("div",Wl,[s("div",null,[r[4]||(r[4]=s("div",{class:"text-sm font-light uppercase text-gray-400"},"Task Name",-1)),s("div",Kl,G(T.assessment.task.name),1)]),(p=T.assessment.variant)!=null&&p.name?(_(),k("div",Zl,[r[5]||(r[5]=s("div",{class:"text-sm font-light uppercase text-gray-500"},"Variant Name",-1)),s("div",Jl,G((u=T.assessment.variant)==null?void 0:u.name),1)])):j("",!0)]),s("div",es,[s("img",{src:T.assessment.task.image,class:"w-5"},null,8,ts)])]),s("div",ns,[s("div",os,[r[10]||(r[10]=s("div",{class:"text-lg font-normal text-gray-500 uppercase mb-2"},"Assigned Conditions",-1)),o.value.length>0?(_(),k("div",ls,r[6]||(r[6]=[s("p",null,"Field",-1),s("p",null,"Condition",-1),s("p",null,"Value",-1)]))):j("",!0),o.value.length==0?(_(),k("div",ss,[r[9]||(r[9]=s("div",{class:"text-xl uppercase font-bold"},"No Conditions Added",-1)),s("div",is,[r[8]||(r[8]=H(" Assignment will be ",-1)),h(c(lt),{severity:"warning",class:"mx-1"},{default:$(()=>r[7]||(r[7]=[H("ASSIGNED",-1)])),_:1,__:[7]}),H(" to all "+G(c(Ae)?"users":"participants")+" in the "+G(z.value),1)])])):j("",!0),(_(!0),k(Be,null,mt(o.value,(y,q)=>(_(),k("div",{key:q},[s("div",as,[s("div",rs,[h(c(Ue),{modelValue:y.field,"onUpdate:modelValue":Y=>y.field=Y,options:te,optionLabel:"label",class:"w-full",placeholder:"Select a Field",inputId:"Field"},null,8,["modelValue","onUpdate:modelValue"])]),s("div",ds,[h(c(Ue),{modelValue:y.op,"onUpdate:modelValue":Y=>y.op=Y,options:m(y.field),optionLabel:"label",class:"w-full",placeholder:"Condition",inputId:"Condition"},null,8,["modelValue","onUpdate:modelValue","options"])]),s("div",us,[h(c(Ue),{modelValue:y.value,"onUpdate:modelValue":Y=>y.value=Y,options:d(y.field),optionLabel:"label",class:"w-full",placeholder:"Value"},null,8,["modelValue","onUpdate:modelValue","options"])]),h(c(ue),{icon:"pi pi-trash",text:"",class:"bg-primary text-white w-2 border-round border-none hover:bg-red-900",onClick:Y=>f(o.value,q)},null,8,["onClick"])])]))),128)),s("div",cs,[s("div",fs,[h(c(ue),{label:"Add Condition",icon:"pi pi-plus mr-2",class:"bg-primary text-white border-none border-round p-2 hover:bg-red-900","data-cy":"button-assigned-condition",onClick:N})])])]),s("div",null,[s("div",ps,[s("div",ms,[r[17]||(r[17]=s("div",{class:"text-lg font-normal text-gray-500 uppercase mb-2"},"Optional Conditions",-1)),l.value.length>0?(_(),k("div",gs,r[11]||(r[11]=[s("p",null,"Field",-1),s("p",null,"Condition",-1),s("p",null,"Value",-1)]))):j("",!0),l.value.length==0?(_(),k("div",hs,[r[16]||(r[16]=s("div",{class:"text-xl uppercase font-bold"},"No Conditions Added",-1)),V.value?(_(),k("div",vs,[r[13]||(r[13]=H(" Assignment will be ",-1)),h(c(lt),{severity:"success",class:"mx-1"},{default:$(()=>r[12]||(r[12]=[H("OPTIONAL",-1)])),_:1,__:[12]}),H(" for all "+G(c(Ae)?"users":"participants")+" in the "+G(z.value),1)])):(_(),k("div",bs,[r[15]||(r[15]=H(" Assignment will ",-1)),h(c(lt),{severity:"danger",class:"mx-1"},{default:$(()=>r[14]||(r[14]=[H("NOT BE OPTIONAL",-1)])),_:1,__:[14]}),H(" for any "+G(c(Ae)?"users":"participants")+" in the "+G(z.value),1)]))])):j("",!0),(_(!0),k(Be,null,mt(l.value,(y,q)=>(_(),k("div",{key:q},[s("div",ys,[s("div",ws,[h(c(Ue),{modelValue:y.field,"onUpdate:modelValue":Y=>y.field=Y,options:te,optionLabel:"label",class:"w-full",placeholder:"Select a Field",inputId:"Field"},null,8,["modelValue","onUpdate:modelValue"])]),s("div",xs,[h(c(Ue),{modelValue:y.op,"onUpdate:modelValue":Y=>y.op=Y,options:m(y.field),optionLabel:"label",class:"w-full",placeholder:"Condition",inputId:"Condition"},null,8,["modelValue","onUpdate:modelValue","options"])]),s("div",_s,[h(c(Ue),{modelValue:y.value,"onUpdate:modelValue":Y=>y.value=Y,options:d(y.field),optionLabel:"label",class:"w-full",placeholder:"Value"},null,8,["modelValue","onUpdate:modelValue","options"])]),h(c(ue),{icon:"pi pi-trash",text:"",class:"bg-primary text-white w-2 border-round border-none hover:bg-red-900",onClick:Y=>f(l.value,q)},null,8,["onClick"])])]))),128)),s("div",Cs,[s("div",Es,[s("div",Ss," Make Assessment Optional For All "+G(c(Ae)?"Users":"Participants"),1),h(c(Fo),{modelValue:V.value,"onUpdate:modelValue":[r[1]||(r[1]=y=>V.value=y),E],"data-cy":"switch-optional-for-everyone"},null,8,["modelValue"])]),s("div",ks,[h(c(ue),{label:"AddCondition",icon:"pi pi-plus mr-2",class:"bg-primary text-white border-none border-round p-2 hover:bg-red-900",disabled:V.value===!0,"data-cy":"button-optional-condition",onClick:O},null,8,["disabled"])])])])])]),h(c(to)),s("div",Ts,[x.value?(_(),k("div",Ds,[h(c(lt),{icon:"pi pi-info-circle",severity:"info"},{default:$(()=>r[18]||(r[18]=[H(" Making the assessment optional for all will override any optional conditions you have added. ",-1)])),_:1,__:[18]})])):j("",!0),J.value.length>0?(_(),k("div",Os,[h(c(lt),{icon:"pi pi-exclamation-triangle",severity:"error",class:"bg-transparent text-red-600"},{default:$(()=>[H(G(J.value),1)]),_:1})])):j("",!0)]),s("div",As,[h(c(ue),{type:"button",class:"bg-primary text-white border-none border-round p-2 hover:bg-red-900",label:"Reset",text:"",severity:"error",onClick:K}),h(c(ue),{type:"button",class:"bg-primary text-white border-none border-round p-2 hover:bg-red-900",label:"Save","data-cy":"button-save-conditions",onClick:A})])])]}),_:1},8,["visible"])],64))}}),$s={key:0,class:"flex-1 flex h-6rem flex-row gap-2 border-1 border-round surface-border bg-white-alpha-90 mb-2 hover:surface-hover"},Vs={class:"w-11 mt-3 flex flex-row p-0 mb-2"},Ns=["src","alt"],Ps={class:"flex align-items-center flex-row"},Ls={class:"font-bold text-lg pl-2"},Rs={class:"pi pi-info-circle text-primary p-1 border-circle hover:text-100"},Fs={key:0,class:"flex ml-2"},Ms={class:"pl-2 w-full"},Us={class:"m-0"},js={class:"flex justify-content-end mt-0 mb-2"},qs={class:"pi pi-arrows-h border-circle p-2 text-primary hover:text-100"},Bs={class:"flex gap-2 flex-column w-full pr-3"},Ys={class:"mr-0 pl-0 flex flex-column"},Hs=["id"],zs={class:"ml-0 pl-0 flex flex-column"},Gs={class:"w-11 mt-3 flex flex-row p-0"},Xs=["src","alt"],Qs={class:"flex align-items-center flex-row"},Ws={class:"font-bold",style:{"margin-left":"0.625rem"}},Ks={class:"pi pi-info-circle text-primary p-1 border-circle hover:text-100"},Zs={key:0,class:"flex ml-2"},Js={class:"flex align-items-center gap-2"},ei={class:"m-0 mt-1 ml-2"},ti={key:0},ni={class:"flex justify-content-end mt-0 mb-2"},oi={class:"pi pi-arrows-h border-circle p-2 text-primary hover:text-100"},li={class:"flex gap-2 flex-column w-full pr-3"},si={class:"mr-0 pl-0 flex flex-column"},ii={key:2,class:"flex-1 flex flex-column border-1 border-round surface-border surface-hover mb-2 hover:surface-ground mr-2 ml-2 pb-2",style:{"margin-top":"-25px"}},ai={key:0,class:"flex gap-2 mt-2 flex-column w-full pr-3"},ri={key:1,class:"flex mt-3 flex-column w-full ml-3 pr-5"},di={key:2,class:"flex mt-2 flex-column w-full pr-3"},ui={key:3,class:"flex mt-2 flex-column w-full px-3 ml-3"},ci={class:"flex gap-2 flex-column w-full pr-3"},Qn="/src/assets/roar-logo.png",mn=At({__name:"VariantCard",props:{variant:{},hasControls:{type:Boolean,default:!1},updateVariant:{},preExistingAssessmentInfo:{default:()=>[]}},emits:["remove","select","moveUp","moveDown"],setup(t,{emit:e}){const n=t,o=e,l=B(!1),i=B(null),d=B(!1),m=de(()=>{var K,A,ne;const E=(ne=(A=(K=n.variant.variant)==null?void 0:K.conditions)==null?void 0:A.assigned)==null?void 0:ne.conditions;if(!E||!Array.isArray(E)||E.length===0)return"";const x=E.filter(Z=>Z.field!=="age").map(Z=>{const te=String(Z.value??"");if(!te)return"";let z=te;Z.field==="userType"&&te.toLowerCase()==="student"&&(z="child");const T=z.charAt(0).toUpperCase()+z.slice(1);return Z.field==="userType"&&z.toLowerCase()==="child"?Z.op==="EQUAL"?"Children":"Not Children":Z.op==="EQUAL"?`${T}s`:`Not ${T}s`}).filter(Z=>Z!=="");return x.length===0?"":x.join(", ")}),f=()=>{o("remove",n.variant)},g=()=>{o("select",n.variant)},v=()=>{o("moveUp",n.variant)},b=()=>{o("moveDown",n.variant)};function I(){l.value=!l.value}function P(){return l.value?"pi pi-chevron-up text-primary hover:text-white-alpha-90 p-2":"pi pi-chevron-down text-primary hover:text-white-alpha-90 p-2"}const O=E=>E==null?void 0:E.conditions,N=()=>l.value?"flex-1 flex flex-row gap-2 border-1 border-round surface-border bg-white-alpha-90 mb-2 hover:surface-hover z-1 relative shadow-2":"flex-1 flex flex-row gap-2 border-1 border-round surface-border bg-white-alpha-90 mb-2 hover:surface-hover z-1 relative",V=E=>Zn(E).map(([x,K])=>({key:x,value:K})),J=E=>{i.value.toggle(E)};return(E,x)=>{var A,ne,Z,te,z,T,r,p,u,y,q,Y,ce,se,Ve,D,a,U,le,ve,me,ge,F,xe,ke,Te,Ie,S;const K=kn("tooltip");return _(),k(Be,null,[E.hasControls?(_(),k("div",{key:1,id:E.variant.id,class:Ee(["h-6rem",N()])},[s("div",zs,[h(c(ue),{class:"surface-hover border-y-1 border-200 border-noround m-0 hover:bg-primary p-0",onClick:f},{default:$(()=>x[8]||(x[8]=[s("i",{class:"pi pi-times text-primary hover:text-white-alpha-90 p-2",style:{"font-size":"1rem"}},null,-1)])),_:1,__:[8]}),h(c(ue),{class:"surface-hover border-y-1 border-200 border-noround m-0 hover:bg-primary p-0",onClick:v},{default:$(()=>x[9]||(x[9]=[s("i",{class:"pi pi-sort-up text-primary hover:text-white-alpha-90 p-2",style:{"font-size":"1rem"}},null,-1)])),_:1,__:[9]}),h(c(ue),{class:"surface-hover border-y-1 border-200 border-noround m-0 hover:bg-primary p-0",onClick:b},{default:$(()=>x[10]||(x[10]=[s("i",{class:"pi pi-sort-down text-primary hover:text-white-alpha-90 p-2",style:{"font-size":"1rem"}},null,-1)])),_:1,__:[10]})]),s("div",Gs,[s("div",null,[s("img",{class:"w-4rem shadow-2 border-round",src:E.variant.task.image||Qn,alt:E.variant.task.name},null,8,Xs)]),s("div",null,[s("div",Qs,[s("span",Ws,G(E.variant.task.name),1),h(c(ue),{class:"p-0 surface-hover border-none border-circle hover:text-100 hover:bg-primary",onClick:x[2]||(x[2]=C=>J(C))},{default:$(()=>[qe(s("i",Ks,null,512),[[K,"View parameters",void 0,{top:!0}]])]),_:1}),(T=(z=(te=E.variant)==null?void 0:te.variant)==null?void 0:z.params)!=null&&T.cat?(_(),k("div",Zs,[h(c(Ln),{class:"bg-primary text-white h-2rem",label:"CAT"})])):j("",!0)]),s("div",Js,[s("p",ei,[x[13]||(x[13]=s("span",{class:"font-bold"},"Variant name:",-1)),H(" "+G(E.variant.variant.name)+" ",1),x[14]||(x[14]=s("br",null,null,-1)),m.value?(_(),k("span",ti,[x[11]||(x[11]=s("span",{class:"font-bold"},"Assigned to:",-1)),H(" "+G(m.value),1),x[12]||(x[12]=s("br",null,null,-1))])):j("",!0)])])]),h(c(Rn),{ref_key:"op",ref:i,"append-to":"body",class:"border-1 surface-border",style:{width:"40vh"}},{default:$(()=>[s("div",ni,[h(c(ue),{class:"p-0 surface-hover border-none border-circle -rotate-45 hover:text-100 hover:bg-primary",onClick:x[3]||(x[3]=C=>d.value=!0)},{default:$(()=>[qe(s("i",oi,null,512),[[K,"Click to expand",void 0,{top:!0}]])]),_:1})]),s("div",li,[h(c(wt),{class:"p-datatable-small ml-3 border-1 surface-border text-sm p-0","header-style":"font-size: 20px;",value:V(E.variant.variant.params),scrollable:"","scroll-height":"300px"},{default:$(()=>[h(c(De),{field:"key",header:"Parameter",style:{width:"50%","text-align":"left","padding-left":"1vh","padding-top":"0.15vh","padding-bottom":"0.1vh"}}),h(c(De),{field:"value",header:"Value",style:{width:"50%","text-align":"left","padding-left":"1vh","padding-top":"0.15vh","padding-bottom":"0.1vh"}})]),_:1},8,["value"])])]),_:1},512)]),s("div",si,[h(Is,{assessment:E.variant,"update-variant":E.updateVariant,"pre-existing-assessment-info":E.preExistingAssessmentInfo},null,8,["assessment","update-variant","pre-existing-assessment-info"]),(p=(r=E.variant.variant)==null?void 0:r.conditions)!=null&&p.assigned||(y=(u=E.variant.variant)==null?void 0:u.conditions)!=null&&y.optional?(_(),Ke(c(ue),{key:0,class:"surface-hover border-1 border-300 border-circle m-0 hover:bg-primary p-0 m-2",onClick:x[4]||(x[4]=C=>I())},{default:$(()=>[s("i",{class:Ee(P()),style:{"font-size":"1rem"}},null,2)]),_:1})):j("",!0)])],10,Hs)):(_(),k("div",$s,[s("div",Vs,[s("div",null,[s("img",{class:"w-4rem shadow-2 border-round ml-2",src:E.variant.task.image||Qn,alt:E.variant.task.name},null,8,Ns)]),s("div",null,[s("div",Ps,[s("span",Ls,G(E.variant.task.name),1),h(c(ue),{class:"p-0 surface-hover border-none border-circle hover:text-100 hover:bg-primary ml-2",onClick:x[0]||(x[0]=C=>J(C))},{default:$(()=>[qe(s("i",Rs,null,512),[[K,"View parameters",void 0,{top:!0}]])]),_:1}),(Z=(ne=(A=E.variant)==null?void 0:A.variant)==null?void 0:ne.params)!=null&&Z.cat?(_(),k("div",Fs,[h(c(Ln),{class:"bg-primary text-white h-2rem",label:"CAT"})])):j("",!0)]),s("div",Ms,[s("p",Us,[x[6]||(x[6]=s("span",{class:"font-semibold"},"Variant name:",-1)),H(" "+G(E.variant.variant.name),1)])]),h(c(Rn),{ref_key:"op",ref:i,"append-to":"body",style:{width:"40vh"}},{default:$(()=>[s("div",js,[h(c(ue),{class:"p-0 surface-hover border-none border-circle -rotate-45 hover:text-100 hover:bg-primary",onClick:x[1]||(x[1]=C=>d.value=!0)},{default:$(()=>[qe(s("i",qs,null,512),[[K,"Click to expand",void 0,{top:!0}]])]),_:1})]),s("div",Bs,[h(c(wt),{class:"p-datatable-small ml-3 border-1 surface-border text-sm","header-style":"font-size: 20px;",value:V(E.variant.variant.params),scrollable:"","scroll-height":"300px"},{default:$(()=>[h(c(De),{field:"key",header:"Parameter",style:{width:"50%","text-align":"left","padding-left":"1vh","padding-top":"0.15vh","padding-bottom":"0.1vh"}}),h(c(De),{field:"value",header:"Value",style:{width:"50%","text-align":"left","padding-left":"1vh","padding-top":"0.15vh","padding-bottom":"0.1vh"}})]),_:1},8,["value"])])]),_:1},512)])]),s("div",Ys,[E.hasControls?j("",!0):(_(),Ke(c(ue),{key:0,class:"surface-hover border-1 border-300 border-circle m-0 hover:bg-primary p-0 m-2","data-cy":"selected-variant",onClick:g},{default:$(()=>x[7]||(x[7]=[s("i",{class:"pi pi-chevron-right text-primary hover:text-white-alpha-90 p-2",style:{"font-size":"1rem"}},null,-1)])),_:1,__:[7]}))])])),l.value?(_(),k("div",ii,[((se=(ce=(Y=(q=E.variant.variant)==null?void 0:q.conditions)==null?void 0:Y.assigned)==null?void 0:ce.conditions)==null?void 0:se.length)>0?(_(),k("div",ai,[x[15]||(x[15]=s("p",{class:"font-bold mt-3 mb-1 ml-3"},"Assigned Conditions:",-1)),h(c(wt),{class:"p-datatable-small ml-3 border-1 surface-border","table-style":"min-width:50vh",value:O((D=(Ve=E.variant.variant)==null?void 0:Ve.conditions)==null?void 0:D.assigned),scrollable:"","scroll-height":"300px"},{default:$(()=>[h(c(De),{field:"field",header:"Field",style:{width:"33%","text-align":"left","padding-left":"1vh",padding:"0.8vh",margin:"0.3vh"}}),h(c(De),{field:"op",header:"Operation",style:{width:"33%","text-align":"left","padding-left":"1vh",padding:"0.8vh"}}),h(c(De),{field:"value",header:"Value",style:{width:"33%","text-align":"left","padding-left":"1vh",padding:"0.8vh"}})]),_:1},8,["value"])])):j("",!0),((U=(a=E.variant.variant)==null?void 0:a.conditions)==null?void 0:U.optional)===!0?(_(),k("div",ri,[h(c(lt),{severity:"success"},{default:$(()=>x[16]||(x[16]=[H(" Assignment optional for all participants ",-1)])),_:1,__:[16]})])):((ge=(me=(ve=(le=E.variant.variant)==null?void 0:le.conditions)==null?void 0:ve.optional)==null?void 0:me.conditions)==null?void 0:ge.length)>0?(_(),k("div",di,[x[17]||(x[17]=s("p",{class:"font-bold mt-3 mb-1 ml-3"},"Optional Conditions:",-1)),h(c(wt),{class:"p-datatable-small ml-3 border-1 surface-border","table-style":"min-width:50vh",value:O((xe=(F=E.variant.variant)==null?void 0:F.conditions)==null?void 0:xe.optional),scrollable:"","scroll-height":"300px"},{default:$(()=>[h(c(De),{field:"field",header:"Field",style:{width:"33%","text-align":"left","padding-left":"1vh",padding:"0.8vh"}}),h(c(De),{field:"op",header:"Operation",style:{width:"33%","text-align":"left","padding-left":"1vh",padding:"0.8vh"}}),h(c(De),{field:"value",header:"Value",style:{width:"33%","text-align":"left","padding-left":"1vh",padding:"0.8vh"}})]),_:1},8,["value"])])):j("",!0),!((Te=(ke=E.variant.variant)==null?void 0:ke.conditions)!=null&&Te.assigned)&&!((S=(Ie=E.variant.variant)==null?void 0:Ie.conditions)!=null&&S.optional)?(_(),k("div",ui,[h(c(lt),{severity:"danger"},{default:$(()=>x[18]||(x[18]=[H(" Assignment required for all participants ",-1)])),_:1,__:[18]})])):j("",!0)])):j("",!0),h(c(Tn),{visible:d.value,"onUpdate:visible":x[5]||(x[5]=C=>d.value=C),modal:"",header:"Parameters",style:{width:"50rem"}},{default:$(()=>[s("div",ci,[h(c(wt),{class:"p-datatable-small ml-3 border-1 surface-border text-xl","header-style":"font-size: 20px;",value:V(E.variant.variant.params),scrollable:"","scroll-height":"300px"},{default:$(()=>[h(c(De),{field:"key",header:"Parameter",style:{width:"50%","text-align":"left","padding-left":"1vh","padding-top":"0.15vh","padding-bottom":"0.1vh"}}),h(c(De),{field:"value",header:"Value",style:{width:"50%","text-align":"left","padding-left":"1vh","padding-top":"0.15vh","padding-bottom":"0.1vh"}})]),_:1},8,["value"])])]),_:1},8,["visible"])],64)}}}),fi={class:"w-full flex flex-column lg:flex-row gap-2"},pi={key:0,class:"w-full lg:w-6"},mi={class:"flex flex-row mb-2"},gi={class:"flex flex-column flex-grow-1 p-input-icon-left"},hi={key:0},vi={key:0},bi={key:1},yi=["id","data-task-id"],wi={key:1},xi={class:"flex items-center"},_i={className:"select-group-name"},Ci={key:0},Ei={key:1},Si=["id","data-task-id"],ki={key:1,class:"w-1 bg-gray-400"},Ti={class:"w-full lg:w-6","data-cy":"panel-droppable-zone"},Di=["id","data-task-id"],Oi=At({__name:"TaskPicker",props:{allVariants:{},inputVariants:{default:()=>[]},preExistingAssessmentInfo:{default:()=>[]}},emits:["variants-changed"],setup(t,{emit:e}){const n=Jn(),o=t,l=e,i={Introduction:["Instructions"],"Language and Literacy":["Vocabulary","Sentence Understanding","Language Sounds","Word Reading","Sentence Reading"],"Executive Function":["Hearts & Flowers","Same & Different","Memory"],Math:["Math"],Reasoning:["Pattern Matching"],"Spatial Cognition":["Shape Rotation"],"Social Cognition":["Stories"],Attitudes:["Survey"]},d=de(()=>{let r=new Set(Object.keys(o.allVariants)),p=Object.entries(i).map(([y,q])=>{let Y=[];return q.forEach(ce=>{const se=Object.keys(o.allVariants).find(Ve=>{var a,U;const D=o.allVariants[Ve];return D&&D.length>0&&((U=(a=D[0])==null?void 0:a.task)==null?void 0:U.name)===ce});se&&(Y.push({label:ce,value:se}),r.delete(se))}),Y.sort((ce,se)=>ce.label.localeCompare(se.label)),Y.length>0?{label:y,items:Y}:null}),u=Array.from(r).map(y=>{var ce,se;const q=o.allVariants[y];return{label:(q&&q.length>0?(se=(ce=q[0])==null?void 0:ce.task)==null?void 0:se.name:void 0)??y,value:y}});return u.length>0&&(u.sort((y,q)=>y.label.localeCompare(q.label)),p.push({label:"Other",items:u})),p.filter(y=>y!==null)});je(()=>o.inputVariants,r=>{r&&(f.value=eo(f.value,r),f.value=f.value.map(p=>{const u=o.preExistingAssessmentInfo.find(y=>(y==null?void 0:y.variantId)===(p==null?void 0:p.id));return u?{...p,variant:{...p==null?void 0:p.variant,conditions:u.conditions}}:p}))});const m=(r,p)=>{const u=f.value.map(y=>y.id===r?{...y,variant:{...y.variant,conditions:p}}:y);f.value=u},f=B([]),g=B(!0),v=B(Object.keys(o.allVariants)[0]||""),b=de(()=>!v.value||!o.allVariants[v.value]?[]:g.value?Ht(o.allVariants[v.value],r=>r.variant.name):o.allVariants[v.value]),I=B(!0),P=B(""),O=B([]),N=B(!1),V=r=>{N.value=!0,O.value=[],Object.values(o.allVariants).forEach(p=>{const u=Ht(p,y=>!!(Ge(y.variant.name).includes(Ge(r))||Ge(y.id).includes(Ge(r))||Ge(y.task.id).includes(Ge(r))||Ge(y.task.studentFacingName||"").includes(Ge(r))));O.value.push(...u)}),N.value=!1};function J(){P.value="",O.value=[]}const E=Pn(V,250);je(P,r=>{r.length>=3?E(r):O.value=[]});const x=Pn(()=>{n.add({severity:"error",summary:"Duplicate",detail:"That variant is already selected.",life:3e3})},3e3,{leading:!0}),K=r=>{const p=f.value.map(y=>y.task.id),u=r.item.dataset.taskId;u&&p.includes(u)&&(f.value.pop(),n.add({severity:"warn",summary:"Task Selected",detail:"There is a task with that Task ID already selected.",life:3e3}))},A=r=>{const p=r.dragged.id;return Vt(f.value,y=>y.id===p)!==-1&&r.from!==r.to?(x(),!1):!0};je(f,r=>{l("variants-changed",r)},{deep:!0});const ne=r=>{f.value=f.value.filter(p=>p.id!==r.id)},Z=r=>{const p=r.id,u=Vt(f.value,q=>q.id===p),y=f.value.map(q=>q.task.id);if(u===-1){if(y.includes(r.task.id)){n.add({severity:"warn",summary:"Task Selected",detail:"There is a task with that Task ID already selected.",life:3e3});return}const q=T(r);f.value.push(q)}else x()},te=r=>{const p=Vt(f.value,y=>y.id===r.id);if(p<=0)return;const u=f.value[p];u&&(f.value.splice(p,1),f.value.splice(p-1,0,u))},z=r=>{const p=Vt(f.value,y=>y.id===r.id);if(p===-1||p>=f.value.length-1)return;const u=f.value[p];u&&(f.value.splice(p,1),f.value.splice(p+1,0,u))};function T(r){if(r.task.id==="survey")return r;const p=hn(r);return p.variant.conditions={},p.variant.conditions.assigned={op:"AND",conditions:[{field:"userType",op:"EQUAL",value:"student"}]},p}return(r,p)=>(_(),Ke(c(oo),null,{header:$(()=>p[6]||(p[6]=[s("div",{class:"flex align-items-center font-bold"},[H(" Select Tasks "),s("span",{class:"required-asterisk text-red-500 ml-1"},"*")],-1)])),default:$(()=>[s("div",fi,[I.value?(_(),k("div",pi,[s("div",mi,[s("div",gi,[h(c(Eo),{class:"w-full"},{default:$(()=>[h(c(So),{class:"pi pi-search"}),h(c(ft),{modelValue:P.value,"onUpdate:modelValue":p[0]||(p[0]=u=>P.value=u),class:"w-full",placeholder:"Variant name, ID, or Task ID","data-cy":"input-variant-name"},null,8,["modelValue"])]),_:1})]),P.value?(_(),Ke(c(ue),{key:0,class:"bg-primary text-white border-none border-round pl-3 pr-3 hover:bg-red-900",style:{"margin-right":"0"},onClick:J},{default:$(()=>p[7]||(p[7]=[s("i",{class:"pi pi-times"},null,-1)])),_:1,__:[7]})):j("",!0)]),P.value.length>=3?(_(),k("div",hi,[N.value?(_(),k("div",vi,p[8]||(p[8]=[s("span",null,"Searching...",-1)]))):c(st)(O.value)?(_(),k("div",bi,[s("span",null,"No search results for "+G(P.value),1)])):j("",!0),h(c(en),{style:{height:"31rem",width:"100%","overflow-y":"auto"}},{default:$(()=>[h(c(pn),{modelValue:O.value,"onUpdate:modelValue":p[1]||(p[1]=u=>O.value=u),"reorderable-columns":!0,group:{name:"variants",pull:"clone",put:!1},sort:!1,move:A},{default:$(()=>[h(Zt,null,{default:$(()=>[(_(!0),k(Be,null,mt(O.value,u=>(_(),k("div",{id:u.id,key:u.id,"data-task-id":u.task.id,style:{cursor:"grab"}},[h(mn,{variant:u,onSelect:Z},null,8,["variant"])],8,yi))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1})])):j("",!0),P.value.length<3?(_(),k("div",wi,[h(c(Ue),{modelValue:v.value,"onUpdate:modelValue":p[2]||(p[2]=u=>v.value=u),options:d.value,optionGroupLabel:"label",optionGroupChildren:"items","option-label":"label","option-value":"value",class:"w-full mb-2",placeholder:"Select TaskID"},{optiongroup:$(u=>[s("div",xi,[s("div",_i,G(u.option.label),1)])]),_:1},8,["modelValue","options"]),h(c(en),{style:{height:"27.75rem",width:"100%","overflow-y":"auto"}},{default:$(()=>[v.value?b.value.length?j("",!0):(_(),k("div",Ei,[p[9]||(p[9]=H(" No variants to show. Make sure 'Show only named variants' is unchecked to view all. ",-1)),s("span",{class:"text-link",onClick:p[3]||(p[3]=u=>g.value=!1)},"View all")])):(_(),k("div",Ci,"Select a TaskID to display a list of variants.")),h(c(pn),{modelValue:b.value,"onUpdate:modelValue":p[4]||(p[4]=u=>b.value=u),"reorderable-columns":!0,group:{name:"variants",pull:"clone",put:!1},sort:!1,move:A},{default:$(()=>[h(Zt,null,{default:$(()=>[(_(!0),k(Be,null,mt(b.value,u=>(_(),k("div",{id:u.id,key:u.id,"data-task-id":u.task.id,style:{cursor:"grab"}},[h(mn,{variant:u,"update-variant":m,onSelect:Z},null,8,["variant"])],8,Si))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1})])):j("",!0)])):(_(),k("div",ki,p[10]||(p[10]=[s("i",{class:"pi pi-angle-double-right"},null,-1)]))),p[12]||(p[12]=s("div",{class:"divider"},null,-1)),s("div",Ti,[p[11]||(p[11]=s("div",{class:"panel-title mb-2 text-base"},[H(" Selected Tasks "),s("span",{class:"required-asterisk text-red-500 ml-1"},"*")],-1)),h(c(en),{style:{height:"32rem",width:"100%","overflow-y":"auto"}},{default:$(()=>[h(c(pn),{modelValue:f.value,"onUpdate:modelValue":p[5]||(p[5]=u=>f.value=u),move:A,group:{name:"variants",pull:!0,put:!0,animation:100},sort:!0,class:"w-full h-full overflow-auto",onAdd:K},{default:$(()=>[h(Zt,null,{default:$(()=>[(_(!0),k(Be,null,mt(f.value,u=>(_(),k("div",{id:u.id,key:u.id,"data-task-id":u.task.id,style:{cursor:"grab"}},[h(mn,{variant:u,"has-controls":"","update-variant":m,"pre-existing-assessment-info":r.preExistingAssessmentInfo,onRemove:ne,onMoveUp:te,onMoveDown:z},null,8,["variant","pre-existing-assessment-info"])],8,Di))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),_:1}))}});var Ai=`
    .p-fieldset {
        background: dt('fieldset.background');
        border: 1px solid dt('fieldset.border.color');
        border-radius: dt('fieldset.border.radius');
        color: dt('fieldset.color');
        padding: dt('fieldset.padding');
        margin: 0;
    }

    .p-fieldset-legend {
        background: dt('fieldset.legend.background');
        border-radius: dt('fieldset.legend.border.radius');
        border-width: dt('fieldset.legend.border.width');
        border-style: solid;
        border-color: dt('fieldset.legend.border.color');
        padding: dt('fieldset.legend.padding');
        transition:
            background dt('fieldset.transition.duration'),
            color dt('fieldset.transition.duration'),
            outline-color dt('fieldset.transition.duration'),
            box-shadow dt('fieldset.transition.duration');
    }

    .p-fieldset-toggleable > .p-fieldset-legend {
        padding: 0;
    }

    .p-fieldset-toggle-button {
        cursor: pointer;
        user-select: none;
        overflow: hidden;
        position: relative;
        text-decoration: none;
        display: flex;
        gap: dt('fieldset.legend.gap');
        align-items: center;
        justify-content: center;
        padding: dt('fieldset.legend.padding');
        background: transparent;
        border: 0 none;
        border-radius: dt('fieldset.legend.border.radius');
        transition:
            background dt('fieldset.transition.duration'),
            color dt('fieldset.transition.duration'),
            outline-color dt('fieldset.transition.duration'),
            box-shadow dt('fieldset.transition.duration');
        outline-color: transparent;
    }

    .p-fieldset-legend-label {
        font-weight: dt('fieldset.legend.font.weight');
    }

    .p-fieldset-toggle-button:focus-visible {
        box-shadow: dt('fieldset.legend.focus.ring.shadow');
        outline: dt('fieldset.legend.focus.ring.width') dt('fieldset.legend.focus.ring.style') dt('fieldset.legend.focus.ring.color');
        outline-offset: dt('fieldset.legend.focus.ring.offset');
    }

    .p-fieldset-toggleable > .p-fieldset-legend:hover {
        color: dt('fieldset.legend.hover.color');
        background: dt('fieldset.legend.hover.background');
    }

    .p-fieldset-toggle-icon {
        color: dt('fieldset.toggle.icon.color');
        transition: color dt('fieldset.transition.duration');
    }

    .p-fieldset-toggleable > .p-fieldset-legend:hover .p-fieldset-toggle-icon {
        color: dt('fieldset.toggle.icon.hover.color');
    }

    .p-fieldset .p-fieldset-content {
        padding: dt('fieldset.content.padding');
    }
`,Ii={root:function(e){var n=e.props;return["p-fieldset p-component",{"p-fieldset-toggleable":n.toggleable}]},legend:"p-fieldset-legend",legendLabel:"p-fieldset-legend-label",toggleButton:"p-fieldset-toggle-button",toggleIcon:"p-fieldset-toggle-icon",contentContainer:"p-fieldset-content-container",content:"p-fieldset-content"},$i=ko.extend({name:"fieldset",style:Ai,classes:Ii}),Vi={name:"BaseFieldset",extends:Do,props:{legend:String,toggleable:Boolean,collapsed:Boolean,toggleButtonProps:{type:null,default:null}},style:$i,provide:function(){return{$pcFieldset:this,$parentInstance:this}}},Cn={name:"Fieldset",extends:Vi,inheritAttrs:!1,emits:["update:collapsed","toggle"],data:function(){return{d_collapsed:this.collapsed}},watch:{collapsed:function(e){this.d_collapsed=e}},methods:{toggle:function(e){this.d_collapsed=!this.d_collapsed,this.$emit("update:collapsed",this.d_collapsed),this.$emit("toggle",{originalEvent:e,value:this.d_collapsed})},onKeyDown:function(e){(e.code==="Enter"||e.code==="NumpadEnter"||e.code==="Space")&&(this.toggle(e),e.preventDefault())}},computed:{buttonAriaLabel:function(){return this.toggleButtonProps&&this.toggleButtonProps.ariaLabel?this.toggleButtonProps.ariaLabel:this.legend},dataP:function(){return Oo({toggleable:this.toggleable})}},directives:{ripple:To},components:{PlusIcon:ll,MinusIcon:Ro}};function Ot(t){"@babel/helpers - typeof";return Ot=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ot(t)}function Wn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,o)}return n}function Kn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Wn(Object(n),!0).forEach(function(o){Ni(t,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Wn(Object(n)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(n,o))})}return t}function Ni(t,e,n){return(e=Pi(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pi(t){var e=Li(t,"string");return Ot(e)=="symbol"?e:e+""}function Li(t,e){if(Ot(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var o=n.call(t,e);if(Ot(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ri=["data-p"],Fi=["data-p"],Mi=["id"],Ui=["id","aria-controls","aria-expanded","aria-label"],ji=["id","aria-labelledby"];function qi(t,e,n,o,l,i){var d=kn("ripple");return _(),k("fieldset",Me({class:t.cx("root"),"data-p":i.dataP},t.ptmi("root")),[s("legend",Me({class:t.cx("legend"),"data-p":i.dataP},t.ptm("legend")),[Jt(t.$slots,"legend",{toggleCallback:i.toggle},function(){return[t.toggleable?j("",!0):(_(),k("span",Me({key:0,id:t.$id+"_header",class:t.cx("legendLabel")},t.ptm("legendLabel")),G(t.legend),17,Mi)),t.toggleable?qe((_(),k("button",Me({key:1,id:t.$id+"_header",type:"button","aria-controls":t.$id+"_content","aria-expanded":!l.d_collapsed,"aria-label":i.buttonAriaLabel,class:t.cx("toggleButton"),onClick:e[0]||(e[0]=function(){return i.toggle&&i.toggle.apply(i,arguments)}),onKeydown:e[1]||(e[1]=function(){return i.onKeyDown&&i.onKeyDown.apply(i,arguments)})},Kn(Kn({},t.toggleButtonProps),t.ptm("toggleButton"))),[Jt(t.$slots,t.$slots.toggleicon?"toggleicon":"togglericon",{collapsed:l.d_collapsed,class:Ee(t.cx("toggleIcon"))},function(){return[(_(),Ke(Wo(l.d_collapsed?"PlusIcon":"MinusIcon"),Me({class:t.cx("toggleIcon")},t.ptm("toggleIcon")),null,16,["class"]))]}),s("span",Me({class:t.cx("legendLabel")},t.ptm("legendLabel")),G(t.legend),17)],16,Ui)),[[d]]):j("",!0)]})],16,Fi),h(Zo,Me({name:"p-toggleable-content"},t.ptm("transition")),{default:$(function(){return[qe(s("div",Me({id:t.$id+"_content",class:t.cx("contentContainer"),role:"region","aria-labelledby":t.$id+"_header"},t.ptm("contentContainer")),[s("div",Me({class:t.cx("content")},t.ptm("content")),[Jt(t.$slots,"default")],16)],16,ji),[[Ko,!l.d_collapsed]])]}),_:3},16)],16,Ri)}Cn.render=qi;const Bi=()=>Ao("admin").get("/legal").then(({data:e})=>e.documents.map(o=>{const l=sl(o.name.split("/").pop()),i=new Date(o.createTime);return{type:l,fileName:yt(o.fields.fileName),gitHubOrg:yt(o.fields.gitHubOrg),gitHubRepository:yt(o.fields.gitHubRepository),currentCommit:yt(o.fields.currentCommit),lastUpdated:i.toLocaleString(),params:yt(o.fields.params)}})),Yi=t=>Jo({queryKey:[Io],queryFn:()=>Bi(),...t}),Hi={class:"card flex justify-content-center"},zi={key:0,class:"flex flex-wrap gap-3"},Gi={class:"flex align-items-center"},Xi={class:"flex align-items-center"},Qi={class:"flex justify-content-center mt-2"},Wi={class:"ml-2 flex text-center",for:"no-consent"},Ki={class:"flex flex-row"},Zi={key:0,class:"align-content-center",style:{width:"50%"}},Ji={class:"border-solid border-round border-1 border-black-alpha-30",style:{width:"70%"}},ea={style:{width:"70%",cursor:"pointer"}},ta={class:"mt-1 mb-1 ml-2 text-center flex cursor-pointer",style:{width:"100%"}},na={class:"flex flex-row w-full cursor-pointer mt-1"},oa={class:"ml-5",style:{width:"70%"}},la={class:"mr-3 ml-0 p-0 flex",style:{width:"80%"}},sa={class:"mt-1 mb-1 ml-2 text-center flex cursor-pointer"},ia={class:"flex flex-row w-full cursor-pointer"},aa={class:"mt-1 mb-1 ml-2 text-center flex cursor-pointer"},ra={class:"flex flex-row w-full cursor-pointer"},da={class:"mt-1 mb-1 ml-2 text-center flex cursor-pointer"},ua={class:"flex flex-row w-full cursor-pointer"},ca={class:"hidden"},fa={class:"flex flex-row"},pa={class:"mr-1"},ma={class:"ml-3"},ga={key:1,class:"flex flex-column pl-3",style:{width:"50%"}},ha={key:0},va={class:"hidden"},ba={class:"flex flex-row"},ya={class:"mr-1"},wa={class:"ml-3"},xa={key:2,class:"flex-column",style:{width:"50%"}},_a={class:"w-full"},Ca={class:"flex flex-row w-full"},Ea={style:{width:"80%"}},Sa={class:"m-0"},ka={key:0},Ta={class:"flex align-items-center justify-content-center"},Da={key:1},Oa={class:"w-full mt-2"},Aa={key:0},Ia={class:"flex flex-row w-full"},$a={style:{width:"80%"}},Va={class:"m-0"},Na={class:"flex align-items-center justify-content-center"},Pa={key:1},La=["innerHTML"],Ra=At({__name:"ConsentPicker",props:{legal:{default:null}},emits:["consent-selected"],setup(t,{emit:e}){const n=t,o=[{name:"Mouse and click",icon:"pi pi-check"},{name:"Questionnaire responses",icon:"pi pi-list"},{name:"Scrolling behavior",icon:"pi pi-arrows-v"},{name:"Button presses",icon:"pi pi-plus-circle"}],l=[{name:"eye-tracking"},{name:"video recording"},{name:"audio recording"}],i=B(!1),d=B(!1),m=B(""),f=B(""),g=B(!1),v=B(!1),b=B(""),I=B(""),P=B(null),O=B(!1);let N=B(null),V=B(null);const J=B(!1),E=B(""),x=B(!1),K=B('Please check the "Default Data Collection Values" first');let A={consent:[],assent:[],amount:b.value,expectedTime:I.value};function ne(){E.value==="know"&&(J.value=!0,P.value=!1),E.value==="help"&&(J.value=!1,P.value=!0),v.value=!1,g.value=!1,N.value=null,V.value=null,b.value="",I.value="",A={consent:[],assent:[],amount:b.value,expectedTime:I.value}}const Z=En(),te=e;Sn(()=>{var D,a,U,le;i.value=!0,!n.legal||Object.keys(n.legal).length===0?(E.value="know",J.value=!0):((D=n.legal.consent)!=null&&D[0]&&(A.consent[0]=n.legal.consent[0]),(a=n.legal.assent)!=null&&a[0]&&(A.assent[0]=n.legal.assent[0]),A.amount=n.legal.amount||"",A.expectedTime=n.legal.expectedTime||"",N.value=((U=n.legal.consent)==null?void 0:U[0])||null,V.value=((le=n.legal.assent)==null?void 0:le[0])||null)}),je(()=>n.legal,D=>{var a,U,le,ve;D&&((a=D.consent)!=null&&a[0]&&(A.consent[0]=D.consent[0]),(U=D.assent)!=null&&U[0]&&(A.assent[0]=D.assent[0]),A.amount=D.amount||"",A.expectedTime=D.expectedTime||"",N.value=((le=D.consent)==null?void 0:le[0])||null,V.value=((ve=D.assent)==null?void 0:ve[0])||null)});function z(){A={consent:[],assent:[],amount:b.value,expectedTime:I.value};const D=Array.isArray(g.value)?g.value.includes("hasDefault"):!1,a=Array.isArray(v.value)?v.value.some(U=>["hasVideo","hasAudio","hasEyeTracking"].includes(U)):!1;D&&(!v.value||!a)?(x.value=!0,q()):D&&a?ce():(x.value=!1,v.value=!1)}const{data:T}=Yi({enabled:i}),r=de(()=>{let D=[],a=[];return nt(T.value,U=>{U.type.toLowerCase().includes("consent")?D.push(U):U.type.toLowerCase().includes("tos")||a.push(U)}),{consent:D,assent:a}});async function p(D){let a;(D==null?void 0:D.type)==="Assent-es"?a=await Z.getLegalDoc("assent-es"):a=await Z.getLegalDoc(D==null?void 0:D.type.toLowerCase()),m.value=a.version,f.value=ol(a.text),d.value=!0}function u(){N.value&&(A.consent[0]=N.value),V.value&&N.value&&te("consent-selected",A)}function y(){V.value&&(A.assent[0]=V.value),V.value&&N.value&&te("consent-selected",A)}function q(){if(T.value!==void 0)return nt(T.value,D=>{D.type.toLowerCase().includes("consent")&&!D.type.toLowerCase().includes("es")?Y(D,A.consent):D.type.toLowerCase().includes("assent")&&!D.type.toLowerCase().includes("es")&&Y(D,A.assent)}),te("consent-selected",A),A}function Y(D,a){if(D.params){const U=D.params;let le=!1;nt(U,ve=>{const me=ve;if(l.some(ge=>ge.name===me))return le=!0,!1}),le||nt(U,ve=>{const me=ve;if(o.some(ge=>ge.name===me)||me==="default")return a.push(D),!1})}}function ce(){let D=!1,a=!1;if(T.value!==void 0)return nt(T.value,U=>{U.type.toLowerCase().includes("consent")&&!D&&!U.type.toLowerCase().includes("es")?D=se(U,A.consent):U.type.toLowerCase().includes("assent")&&!a&&!U.type.toLowerCase().includes("es")&&(a=se(U,A.assent))}),te("consent-selected",A),A}function se(D,a){const U=D.params;if(!U)return!1;let le=!1;return nt(U,ve=>{const me=ve,ge=Array.isArray(v.value)?v.value:[];if(!ge.includes("hasAudio")&&!ge.includes("hasVideo")&&me==="eye-tracking"&&U.length===1)return a[0]=D,le=!0,!1;if(!ge.includes("hasEyeTracking")&&(me==="video recording"||me==="audio recording"))return a[0]=D,le=!0,!1;if(U.length===3){const F=["hasVideo","hasAudio","hasEyeTracking"];if(ge.filter(ke=>F.includes(ke)).length>=2)return a[0]=D,le=!0,!1}}),le}const Ve=de(()=>n.legal??{});return je(Ve,D=>{D.consent==="No Consent"?O.value=!0:O.value=!1}),je(b,D=>{A.amount=D,te("consent-selected",A)}),je(I,D=>{A.expectedTime=D,te("consent-selected",A)}),je(O,()=>{O.value?te("consent-selected","No Consent"):(te("consent-selected",""),O.value=!1)}),(D,a)=>{const U=kn("tooltip");return _(),k(Be,null,[h(c(oo),{class:"m-0 p-0 w-full",header:"Select Consent and Assent Forms"},{default:$(()=>{var le,ve,me,ge;return[s("div",Hi,[O.value?j("",!0):(_(),k("div",zi,[s("div",Gi,[h(c(Yt),{modelValue:E.value,"onUpdate:modelValue":a[0]||(a[0]=F=>E.value=F),"input-id":"helpChoose",name:"help",value:"help",onChange:ne},null,8,["modelValue"]),a[16]||(a[16]=s("label",{for:"helpChoose",class:"ml-2"},"Help me choose",-1))]),s("div",Xi,[h(c(Yt),{modelValue:E.value,"onUpdate:modelValue":a[1]||(a[1]=F=>E.value=F),"input-id":"iKnow",name:"know",value:"know",onChange:ne},null,8,["modelValue"]),a[17]||(a[17]=s("label",{for:"iKnow",class:"ml-2"},"I know what to select",-1))])]))]),s("div",Qi,[h(c(ut),{modelValue:O.value,"onUpdate:modelValue":a[2]||(a[2]=F=>O.value=F),binary:!0,"input-id":"no-consent",class:"flex",value:"noConsent"},null,8,["modelValue"]),s("label",Wi,"This administration does not require consent "+G(c(Ae)?"":"or assent")+" forms",1)]),s("div",Ki,[P.value&&!O.value?(_(),k("div",Zi,[a[27]||(a[27]=s("h3",null,"Default Data Collection",-1)),s("div",Ji,[s("div",ea,[s("div",ta,[s("div",na,[h(c(ut),{modelValue:g.value,"onUpdate:modelValue":a[3]||(a[3]=F=>g.value=F),"input-id":"default-params",value:"hasDefault",onChange:z},null,8,["modelValue"]),a[18]||(a[18]=s("i",{class:"pi pi-align-justify",style:{"font-size":"1rem",width:"8%"}},null,-1)),a[19]||(a[19]=s("label",{class:"mr-3 p-0 ml-1 flex cursor-pointer",style:{width:"80%"},for:"default-params"},"Default Data Collection Values",-1))])])]),a[20]||(a[20]=s("hr",null,null,-1)),s("div",oa,[(_(),k(Be,null,mt(o,F=>s("div",{key:F,class:"mt-1 mb-1 ml-3 mr-0 p-0 text-center flex"},[s("i",{class:Ee(F.icon),style:{"font-size":"1rem",width:"10%"}},null,2),s("div",la,G(F.name),1)])),64))])]),a[28]||(a[28]=s("h3",{class:"mt-5"},"Additional Data Collection",-1)),qe((_(),k("div",{class:Ee(["border-solid border-round border-1 border-black-alpha-30 mt-2",{"opacity-80 surface-200 mt-2":!x.value}]),style:{width:"70%",cursor:"pointer"}},[s("div",sa,[s("div",ia,[h(c(ut),{modelValue:v.value,"onUpdate:modelValue":a[4]||(a[4]=F=>v.value=F),"input-id":"video-recording",value:"hasVideo",class:Ee(["cursor-pointer",{"pointer-events-none":!x.value}]),onChange:z},null,8,["modelValue","class"]),a[21]||(a[21]=s("i",{class:"pi pi-video",style:{"font-size":"1rem",width:"8%"}},null,-1)),s("label",{class:Ee(["mr-3 p-0 flex cursor-pointer",{"pointer-events-none":!x.value}]),style:{width:"80%"},for:"video-recording"},"Video Recording",2)])])],2)),[[U,x.value?"":K.value,void 0,{top:!0}]]),qe((_(),k("div",{class:Ee(["border-solid border-round border-1 border-black-alpha-30 mt-2",{"opacity-80 surface-200 mt-2":!x.value}]),style:{width:"70%",cursor:"pointer"}},[s("div",aa,[s("div",ra,[h(c(ut),{modelValue:v.value,"onUpdate:modelValue":a[5]||(a[5]=F=>v.value=F),"input-id":"audio-recording",value:"hasAudio",class:Ee(["cursor-pointer",{"pointer-events-none":!x.value}]),onChange:z},null,8,["modelValue","class"]),a[22]||(a[22]=s("i",{class:"pi pi-phone",style:{"font-size":"1rem",width:"8%"}},null,-1)),s("label",{class:Ee(["mr-3 p-0 flex cursor-pointer",{"pointer-events-none":!x.value}]),style:{width:"80%"},for:"audio-recording"},"Audio Recording",2)])])],2)),[[U,x.value?"":K.value,void 0,{top:!0}]]),qe((_(),k("div",{class:Ee(["border-solid border-round border-1 border-black-alpha-30 mt-2",{"opacity-80 surface-200 mt-2":!x.value}]),style:{width:"70%",cursor:"pointer"}},[s("div",da,[s("div",ua,[h(c(ut),{modelValue:v.value,"onUpdate:modelValue":a[6]||(a[6]=F=>v.value=F),"input-id":"eye-tracking",value:"hasEyeTracking",class:Ee(["cursor-pointer",{"pointer-events-none":!x.value}]),onChange:z},null,8,["modelValue","class"]),a[23]||(a[23]=s("i",{class:"pi pi-eye",style:{"font-size":"1rem",width:"8%"}},null,-1)),s("label",{class:Ee(["mr-3 p-0 flex cursor-pointer",{"pointer-events-none":!x.value}]),style:{width:"80%"},for:"eye-tracking"},"Eye - Tracking",2)])])],2)),[[U,x.value?"":K.value,void 0,{top:!0}]]),s("div",ca,[a[26]||(a[26]=s("h3",{class:"mb-4 mt-4"},"Compensation Amount and Expected Time",-1)),s("div",fa,[s("div",pa,[h(c(it),null,{default:$(()=>[h(c(ft),{id:"consent-amount",modelValue:b.value,"onUpdate:modelValue":a[7]||(a[7]=F=>b.value=F),class:"w-full",disabled:"true"},null,8,["modelValue"]),a[24]||(a[24]=s("label",{for:"consent-amount",class:"text-sm w-full"},"Payment Amount $$",-1))]),_:1,__:[24]})]),s("div",ma,[h(c(it),null,{default:$(()=>[h(c(ft),{id:"consent-time",modelValue:I.value,"onUpdate:modelValue":a[8]||(a[8]=F=>I.value=F),class:"w-full",disabled:"true"},null,8,["modelValue"]),a[25]||(a[25]=s("label",{for:"consent-time",class:"text-sm w-full"},"Expected Time Amount",-1))]),_:1,__:[25]})])])])])):j("",!0),J.value&&!O.value?(_(),k("div",ga,[a[33]||(a[33]=s("h3",null,"Select a Consent Form",-1)),h(c(Ue),{modelValue:c(N),"onUpdate:modelValue":a[9]||(a[9]=F=>Nn(N)?N.value=F:N=F),options:r.value.consent,"option-label":"fileName",style:{width:"70%"},placeholder:((ve=(le=n.legal)==null?void 0:le.consent[0])==null?void 0:ve.fileName)||"Select a Consent Form",onChange:u},null,8,["modelValue","options","placeholder"]),c(Ae)?j("",!0):(_(),k("div",ha,[a[29]||(a[29]=s("h3",{class:"pt-3"},"Select an Assent Form",-1)),h(c(Ue),{modelValue:c(V),"onUpdate:modelValue":a[10]||(a[10]=F=>Nn(V)?V.value=F:V=F),options:r.value.assent,"option-label":"fileName",style:{width:"70%"},placeholder:((ge=(me=n.legal)==null?void 0:me.assent[0])==null?void 0:ge.fileName)||"Select an Assent Form",onChange:y},null,8,["modelValue","options","placeholder"])])),s("div",va,[a[32]||(a[32]=s("h3",{class:"mb-4 mt-5"},"Consent Amount and Expected Time",-1)),s("div",ba,[s("div",ya,[h(c(it),null,{default:$(()=>[h(c(ft),{id:"consent-amount",modelValue:b.value,"onUpdate:modelValue":a[11]||(a[11]=F=>b.value=F),class:"w-full",disabled:"true"},null,8,["modelValue"]),a[30]||(a[30]=s("label",{for:"consent-amount",class:"text-sm w-full"},"Payment Amount $$",-1))]),_:1,__:[30]})]),s("div",wa,[h(c(it),null,{default:$(()=>[h(c(ft),{id:"consent-time",modelValue:I.value,"onUpdate:modelValue":a[12]||(a[12]=F=>I.value=F),class:"w-full",disabled:"true"},null,8,["modelValue"]),a[31]||(a[31]=s("label",{for:"consent-time",class:"text-sm w-full"},"Expected Time Amount",-1))]),_:1,__:[31]})])])])])):j("",!0),(J.value||P.value)&&!O.value?(_(),k("div",xa,[a[56]||(a[56]=s("h3",{class:"font-bold text-center text-xl"},"Suggested Forms",-1)),s("div",_a,[c(T)&&c(T).length>0?(_(),Ke(c(Cn),{key:0,legend:"Consent"},{default:$(()=>{var F,xe,ke,Te,Ie;return[s("div",Ca,[s("div",Ea,[s("p",Sa,[a[42]||(a[42]=s("span",{class:"font-bold"},"Name: ",-1)),H(G((F=c(A).consent[0])==null?void 0:F.fileName)+" ",1),a[43]||(a[43]=s("br",null,null,-1)),c(Ae)?j("",!0):(_(),k("span",ka,[a[34]||(a[34]=s("span",{class:"font-bold"},"Current Commit: ",-1)),H(G((xe=c(A).consent[0])==null?void 0:xe.currentCommit)+" ",1),a[35]||(a[35]=s("br",null,null,-1)),a[36]||(a[36]=s("span",{class:"font-bold"},"GitHub Org: ",-1)),H(G((ke=c(A).consent[0])==null?void 0:ke.gitHubOrg)+" ",1),a[37]||(a[37]=s("br",null,null,-1)),a[38]||(a[38]=s("span",{class:"font-bold"},"GitHub Repository: ",-1)),H(G((Te=c(A).consent[0])==null?void 0:Te.gitHubRepository)+" ",1),a[39]||(a[39]=s("br",null,null,-1)),a[40]||(a[40]=s("span",{class:"font-bold"},"Last Updated: ",-1)),H(G((Ie=c(A).consent[0])==null?void 0:Ie.lastUpdated)+" ",1),a[41]||(a[41]=s("br",null,null,-1))]))])]),s("div",Ta,[h(c(ue),{class:"border-circle w-6rem h-6rem m-2 surface-hover text-primary border-none font-bold flex align-items-center justify-content-center hover:text-100 hover:bg-primary",label:"Show Consent",onClick:a[13]||(a[13]=S=>p(c(A).consent[0]))})])])]}),_:1})):(_(),k("div",Da,a[44]||(a[44]=[s("p",null,"No consent available.",-1)])))]),s("div",Oa,[c(Ae)?j("",!0):(_(),k("div",Aa,[c(T)&&c(T).length>0?(_(),Ke(c(Cn),{key:0,legend:"Assent"},{default:$(()=>{var F,xe,ke,Te,Ie;return[s("div",Ia,[s("div",$a,[s("p",Va,[a[45]||(a[45]=s("span",{class:"font-bold"},"Name: ",-1)),H(G((F=c(A).assent[0])==null?void 0:F.fileName)+" ",1),a[46]||(a[46]=s("br",null,null,-1)),a[47]||(a[47]=s("span",{class:"font-bold"},"Current Commit: ",-1)),H(G((xe=c(A).assent[0])==null?void 0:xe.currentCommit)+" ",1),a[48]||(a[48]=s("br",null,null,-1)),a[49]||(a[49]=s("span",{class:"font-bold"},"GitHub Org: ",-1)),H(G((ke=c(A).assent[0])==null?void 0:ke.gitHubOrg)+" ",1),a[50]||(a[50]=s("br",null,null,-1)),a[51]||(a[51]=s("span",{class:"font-bold"},"GitHub Repository: ",-1)),H(G((Te=c(A).assent[0])==null?void 0:Te.gitHubRepository)+" ",1),a[52]||(a[52]=s("br",null,null,-1)),a[53]||(a[53]=s("span",{class:"font-bold"},"Last Updated: ",-1)),H(G((Ie=c(A).assent[0])==null?void 0:Ie.lastUpdated)+" ",1),a[54]||(a[54]=s("br",null,null,-1))])]),s("div",Na,[h(c(ue),{class:"border-circle w-6rem h-6rem m-2 surface-hover text-primary border-none font-bold flex align-items-center justify-content-center hover:text-100 hover:bg-primary",label:"Show Assent",onClick:a[14]||(a[14]=S=>p(c(A).assent[0]))})])])]}),_:1})):(_(),k("div",Pa,a[55]||(a[55]=[s("p",null,"No assent available.",-1)])))]))])])):j("",!0)])]}),_:1}),d.value?(_(),Ke(c(Tn),{key:0,visible:d.value,"onUpdate:visible":a[15]||(a[15]=le=>d.value=le),draggable:!1,modal:"","close-on-escape":!1,style:{width:"65vw"},breakpoints:{"1199px":"85vw","575px":"95vw"}},{default:$(()=>[s("div",{innerHTML:f.value},null,8,La)]),_:1},8,["visible"])):j("",!0)],64)}}}),Fa=$o(Ra,[["__scopeId","data-v-5d43dcad"]]),Ma={class:"container main"},Ua={class:"main-body"},ja={class:"flex flex-column mb-5"},qa={class:"flex justify-content-between mb-2"},Ba={class:"flex align-items-center gap-3"},Ya={class:"admin-page-header"},Ha={class:"text-md text-gray-500"},za={class:"bg-gray-100 rounded p-5"},Ga={class:"formgrid grid mt-5"},Xa={class:"field col-12 xl:col-6 mb-5"},Qa={key:0,class:"p-error white-space-nowrap overflow-hidden text-overflow-ellipsis"},Wa={class:"formgrid grid"},Ka={class:"field col-12 md:col-6 mb-5"},Za={key:0,class:"p-error"},Ja={class:"field col-12 md:col-6"},er={key:0,class:"p-error"},tr={key:0,class:"p-error mb-8"},nr={key:1,class:"p-error mb-3"},or={key:2,class:"mt-2 flex w-full"},lr={key:0,class:"p-error mt-2"},sr={class:"flex flex-column justify-content-center mt-5"},ir={class:"flex flex-column mt-2 align-items-center justify-content-center"},ar={class:"flex"},rr={class:"flex gap-2"},dr={key:0,class:"p-error mt-2"},ur={key:1,class:"mt-2 mb-2"},cr={class:"mb-2 w-full flex justify-content-center"},fr={key:0,class:"pi pi-spinner pi-spin mr-2"},ed={__name:"CreateAssignment",props:{adminId:{type:String,required:!1,default:null}},setup(t){const e=B(!1),n=Vo(),o=Jn(),l=no(),{mutate:i,isPending:d}=il(),m=En(),{roarfirekit:f}=No(m),g=t,v=de(()=>g.adminId?"Edit an assignment":"Create Assignment"),b=de(()=>"An assignment is a collection of tasks assigned to users who are members of a group"),I=de(()=>g.adminId?"Update Assignment":"Create Assignment"),P=(S,C)=>Mo(S,Q=>{const Re=ge(Q.variant.params),Fe=ge(C);return Po(Fe,Re)}),{data:O}=Go(!0,{enabled:e}),N=de(()=>e.value&&!!g.adminId),{data:V}=Bo([g.adminId],{enabled:N,select:S=>S[0]}),J=de(()=>{var S;return((S=V==null?void 0:V.value)==null?void 0:S.assessments)??[]}),E=de(()=>{var S,C;return((C=(S=V==null?void 0:V.value)==null?void 0:S.minimalOrgs)==null?void 0:C.districts)??[]}),{data:x}=Uo(E,{enabled:e}),K=de(()=>{var S,C;return((C=(S=V.value)==null?void 0:S.minimalOrgs)==null?void 0:C.schools)??[]}),{data:A}=Yo(K,{enabled:e}),ne=de(()=>{var S,C;return((C=(S=V.value)==null?void 0:S.minimalOrgs)==null?void 0:C.classes)??[]}),{data:Z}=Ho(ne,{enabled:e}),te=de(()=>{var S,C;return((C=(S=V.value)==null?void 0:S.minimalOrgs)==null?void 0:C.groups)??[]}),{data:z}=zo(te,{enabled:e});let T=B("");const r=B(!1),p=B(!1),u=el({administrationName:"",administrationPublicName:"",dateStarted:null,dateClosed:null,sequential:null,legal:null,consent:null,assent:null,districts:[],schools:[],classes:[],groups:[],amount:"",expectedTime:""}),y={administrationName:{required:Nt},dateStarted:{required:Nt},dateClosed:{required:Nt},sequential:{required:Nt},consent:{requiredIf:$n(!Ae)},assent:{requiredIf:$n(!Ae)}},q=qo(y,u),Y=de(()=>{var S;return g.adminId&&((S=V.value)!=null&&S.dateOpened)?new Date(V.value.dateOpened):new Date}),ce=de(()=>u.dateStarted?new Date(u.dateStarted):new Date),se=de(()=>({districts:x.value,schools:A.value,classes:Z.value,groups:z.value})),Ve=S=>{for(const[C,Q]of Zn(S))u[C]=Q},D=B([]),a=B([]);B("");const U=de(()=>jo(O.value,"task.id")),le=S=>{D.value=S},ve=S=>{S!=="No Consent"?(T.value="",u.consent=S.consent,u.assent=S.assent,u.amount=S.amount,u.expectedTime=S.expectedTime):(T.value=S,u.consent=S,u.assent=S)},me=S=>!!Ht(S,Q=>!st(Q)).length,ge=S=>Object.fromEntries(Object.entries(S).filter(([C,Q])=>Q!==null)),F=S=>Object.fromEntries(Object.entries(S).filter(([C,Q])=>Q!==void 0)),xe=S=>{setTimeout(()=>{const C=document.getElementById(S);if(C){const Q=C.getBoundingClientRect(),Re=window.pageYOffset||document.documentElement.scrollTop,Fe=Q.top+Re-100;window.scrollTo({top:Fe,behavior:"smooth"}),C.classList.add("error-highlight"),setTimeout(()=>{C.classList.remove("error-highlight")},2e3)}},100)},ke=async()=>{if(console.log("Submit function called"),r.value=!0,u.administrationPublicName=u.administrationName,console.log("Set administrationPublicName:",u.administrationPublicName),!u.dateStarted||!u.dateClosed){u.dateStarted?(o.add({severity:Je.ERROR,summary:"Required Field Missing",detail:"Please select an end date",life:Ze}),xe("end-date")):(o.add({severity:Je.ERROR,summary:"Required Field Missing",detail:"Please select a start date",life:Ze}),xe("start-date"));return}const S={districts:pe(u.districts).map(ee=>ee.id),schools:pe(u.schools).map(ee=>ee.id),classes:pe(u.classes).map(ee=>ee.id),groups:pe(u.groups).map(ee=>ee.id)};console.log("Checking required orgs...",S);const C=me(S);if(console.log("Orgs valid result:",C),!C){console.log("Org check failed, showing toast."),o.add({severity:Je.ERROR,summary:"Missing Selection",detail:"Please select at least one Group (Site, School, Class, or Cohort).",life:Ze});const ee=document.querySelector(".group-picker-component");if(ee){const vt=ee.getBoundingClientRect(),bt=window.pageYOffset||document.documentElement.scrollTop,at=vt.top+bt-100;window.scrollTo({top:at,behavior:"smooth"}),ee.classList.add("error-highlight"),setTimeout(()=>{ee.classList.remove("error-highlight")},2e3)}return}const Q=D.value.map(ee=>F({variantId:ee.variant.id,variantName:ee.variant.name,taskId:ee.task.id,params:pe(ee.variant.params),...pe(ee.variant.conditions||void 0)&&{conditions:pe(ee.variant.conditions)}}));if(console.log("Checking task uniqueness...",Q),st(Q)){console.log("Task check failed (empty), showing toast."),o.add({severity:Je.ERROR,summary:"Task Selections",detail:"No variants selected. You must select at least one variant to be assigned.",life:Ze});const ee=document.querySelector(".task-picker-component");if(ee){const vt=ee.getBoundingClientRect(),bt=window.pageYOffset||document.documentElement.scrollTop,at=vt.top+bt-100;window.scrollTo({top:at,behavior:"smooth"}),ee.classList.add("error-highlight"),setTimeout(()=>{ee.classList.remove("error-highlight")},2e3)}return}if(q.value.sequential.$invalid){o.add({severity:Je.ERROR,summary:"Required Field Missing",detail:"Please specify whether tasks should be completed sequentially or not",life:Ze}),xe("radio-button-not-sequential");return}const Re=new Date(u.dateClosed);Re.setHours(23,59,59,999);const Fe={name:pe(u).administrationName,publicName:pe(u).administrationName,assessments:Q,dateOpen:pe(u).dateStarted,dateClose:Re,sequential:pe(u).sequential,orgs:S,isTestData:p.value,legal:{consent:pe(u).consent??null,assent:pe(u).assent??null,amount:pe(u).amount??"",expectedTime:pe(u).expectedTime??""}};g.adminId&&(Fe.administrationId=g.adminId),await i(Fe,{onSuccess:()=>{o.add({severity:Je.SUCCESS,summary:"Success",detail:g.adminId?"Assignment updated":"Assignment created",life:Ze}),l.invalidateQueries({queryKey:["administrations-list"]}),console.log("Invalidated administrations list query cache."),n.push({path:Lo.HOME})},onError:ee=>{o.add({severity:Je.ERROR,summary:"Error",detail:ee.message,life:Ze}),console.error("Error creating administration:",ee.message)}})};let Te;const Ie=()=>{Te&&Te(),e.value=!0};return Te=m.$subscribe(async(S,C)=>{C.roarfirekit.restConfig&&Ie()}),Sn(async()=>{f.value.restConfig&&Ie()}),je([V,O],([S,C])=>{var Q,Re;S&&!st(C)&&(u.administrationName=S.name,u.administrationPublicName=S.name,u.dateStarted=new Date(S.dateOpened),u.dateClosed=new Date(S.dateClosed),u.sequential=S.sequential,nt(S.assessments,Fe=>{const ee=Fe.params,vt=Fe.taskId,bt=Ht(C,bo=>bo.task.id===vt),at=P(bt,ee);at&&(a.value=eo(a.value,[at]))}),u.legal=S.legal,u.consent=((Q=S==null?void 0:S.legal)==null?void 0:Q.consent)??null,u.assent=((Re=S==null?void 0:S.legal)==null?void 0:Re.assent)??null,p.value=S.testData,u.consent==="No Consent"&&(T.value=u.consent))}),(S,C)=>(_(),k("main",Ma,[s("section",Ua,[s("div",ja,[s("div",qa,[s("div",Ba,[s("div",Ya,G(v.value),1)])]),s("div",Ha,G(b.value),1)]),h(c(to)),C[15]||(C[15]=s("div",{class:"text-sm text-gray-500 mt-3 mr-3 required"},[s("span",{class:"required-asterisk"},"*"),H(" Required")],-1)),s("div",za,[s("div",Ga,[s("div",Xa,[h(c(it),null,{default:$(()=>[h(c(ft),{id:"administration-name",modelValue:u.administrationName,"onUpdate:modelValue":C[0]||(C[0]=Q=>u.administrationName=Q),class:"w-full","data-cy":"input-administration-name"},null,8,["modelValue"]),C[7]||(C[7]=s("label",{for:"administration-name",class:"w-full"},[H("Assignment Name"),s("span",{class:"required-asterisk"},"*")],-1))]),_:1,__:[7]}),c(q).administrationName.$invalid&&r.value?(_(),k("small",Qa,"Please name your assignment")):j("",!0)])]),s("div",Wa,[s("div",Ka,[h(c(it),null,{default:$(()=>[h(c(In),{modelValue:u.dateStarted,"onUpdate:modelValue":C[1]||(C[1]=Q=>u.dateStarted=Q),class:"w-full","min-date":Y.value,"number-of-months":1,"manual-input":!1,icon:"pi pi-calendar text-white p-1","input-id":"start-date","show-button-bar":"","data-cy":"input-start-date"},null,8,["modelValue","min-date"]),C[8]||(C[8]=s("label",{for:"start-date"},[H("Start Date "),s("span",{class:"required-asterisk"},"*")],-1))]),_:1,__:[8]}),c(q).dateStarted.required.$invalid&&r.value?(_(),k("small",Za," Please select a start date. ")):j("",!0)]),s("div",Ja,[h(c(it),null,{default:$(()=>[h(c(In),{modelValue:u.dateClosed,"onUpdate:modelValue":C[2]||(C[2]=Q=>u.dateClosed=Q),class:"w-full","min-date":ce.value,"input-id":"end-date","number-of-months":1,"manual-input":!1,icon:"pi pi-calendar text-white p-1","show-button-bar":"","data-cy":"input-end-date"},null,8,["modelValue","min-date"]),C[9]||(C[9]=s("label",{for:"end-date"},[H("End Date "),s("span",{class:"required-asterisk"},"*")],-1))]),_:1,__:[9]}),c(q).dateClosed.required.$invalid&&r.value?(_(),k("small",er," Please select an end date. ")):j("",!0)])]),h(nl,{ref:"groupPicker",class:"group-picker-component",orgs:se.value,onSelection:C[3]||(C[3]=Q=>Ve(Q))},null,8,["orgs"]),r.value&&!me({districts:u.districts,schools:u.schools,classes:u.classes,groups:u.groups})?(_(),k("small",tr," Please select at least one Group (Site, School, Class, or Cohort). ")):j("",!0),h(Oi,{ref:"taskPicker",class:"task-picker-component mt-3","all-variants":U.value,"input-variants":a.value,"pre-existing-assessment-info":J.value,onVariantsChanged:le},null,8,["all-variants","input-variants","pre-existing-assessment-info"]),r.value&&c(st)(D.value)?(_(),k("small",nr," Please select at least one task variant. ")):j("",!0),c(Ae)?j("",!0):(_(),k("div",or,[h(Fa,{legal:u.legal,onConsentSelected:ve},null,8,["legal"]),r.value&&c(q).consent.$invalid&&c(q).consent.$invalid?(_(),k("small",lr,"Please select a consent/assent form.")):j("",!0)])),s("div",sr,[s("div",ir,[s("div",ar,[C[12]||(C[12]=s("label",{style:{"font-weight":"bold"},class:"mb-2 mx-2"},[H("Sequential Task Order"),s("span",{class:"required-asterisk"},"*")],-1)),s("span",rr,[h(c(Yt),{modelValue:u.sequential,"onUpdate:modelValue":C[4]||(C[4]=Q=>u.sequential=Q),"input-id":"Yes",value:!0},null,8,["modelValue"]),C[10]||(C[10]=s("label",{for:"Yes"},"Yes",-1)),h(c(Yt),{modelValue:u.sequential,"onUpdate:modelValue":C[5]||(C[5]=Q=>u.sequential=Q),"data-cy":"radio-button-not-sequential","input-id":"No",value:!1},null,8,["modelValue"]),C[11]||(C[11]=s("label",{for:"No"},"No",-1))])]),c(q).sequential.$invalid&&r.value?(_(),k("small",dr,"Please specify sequential behavior.")):j("",!0),c(Ae)?j("",!0):(_(),k("div",ur,[h(c(ut),{modelValue:p.value,"onUpdate:modelValue":C[6]||(C[6]=Q=>p.value=Q),binary:!0,"data-cy":"checkbutton-test-data","input-id":"isTestData"},null,8,["modelValue"]),C[13]||(C[13]=s("label",{for:"isTestData",class:"ml-2"},[H("Mark As "),s("b",null,"Test Administration")],-1))]))]),C[14]||(C[14]=s("div",{class:"divider mx-2 my-3"},null,-1)),s("div",cr,[h(c(ue),{label:I.value,class:"text-white bg-primary border-none border-round h-3rem p-3 hover:bg-red-900","data-cy":"button-create-administration",style:{margin:"0"},disabled:!u.administrationName||c(d),onClick:ke},{default:$(()=>[c(d)?(_(),k("i",fr)):j("",!0),H(" "+G(I.value),1)]),_:1},8,["label","disabled"])])])])])]))}};export{ed as default};
//# sourceMappingURL=CreateAssignment-CINJrQnd.js.map
