const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.c842e3be-DPF8OPpn.js","assets/tanstack-CsBZeLmk.js","assets/sentry-CX5z418I.js","assets/phoneme-MNW3QAs-.js","assets/lodash-DAY8-RAI.js"])))=>i.map(i=>d[i]);
import{e as E,d as M,g as R,s as k,_ as C,n as b,l as B}from"./index-kdKfEdeI.js";import{u as U,a as Y,p as j}from"./package-lock-D8MlMi_s.js";import{r as c,o as q,J as x,w as G,R as H,O as J}from"./tanstack-CsBZeLmk.js";import"./phoneme-MNW3QAs-.js";import"./sentry-CX5z418I.js";import"./lodash-DAY8-RAI.js";(function(){try{var a=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},r=new a.Error().stack;r&&(a._sentryDebugIds=a._sentryDebugIds||{},a._sentryDebugIds[r]="efd76148-22c3-4676-b7e9-1493c8972abc",a._sentryDebugIdIdentifier="sentry-dbid-efd76148-22c3-4676-b7e9-1493c8972abc")}catch{}})();const O={id:"jspsych-target",class:"game-target",translate:"no"},X={__name:"TaskLevante",props:{taskId:{type:String,default:"egma-math"}},setup(a){const r=a;let o;const u=r.taskId,{version:v}=j.packages["node_modules/@levante-framework/core-tasks"],l=E(),d=c(!1),y=c(!1),n=M(),m=R(),{isFirekitInit:_,roarfirekit:w}=k(n),{mutateAsync:I}=U(),f=c(!1);let i;const p=()=>{i&&i(),f.value=!0},h=()=>{l.go(0)};i=n.$subscribe(async(e,t)=>{t.roarfirekit.restConfig&&p()});const{isLoading:L,data:g}=Y({enabled:f});window.addEventListener("popstate",()=>{h()},{once:!0}),q(async()=>{try{o=(await C(()=>import("./index.c842e3be-DPF8OPpn.js"),__vite__mapDeps([0,1,2,3,4]))).TaskLauncher}catch(e){console.error("An error occurred while importing the game module.",e)}w.value.restConfig&&p()}),x(()=>{window.removeEventListener("popstate",h)}),G([_,L],async([e,t])=>{if(e&&!t&&!d.value){d.value=!0;const{selectedAdmin:s}=k(m);await S(s)}},{immediate:!0});async function S(e){try{let t=setInterval(function(){document.querySelector(".jspsych-content-wrapper")&&(y.value=!0,clearInterval(t))},100);const s=await n.roarfirekit.startAssessment(e.value.id,u,v),T=b(g.value,"birthMonth"),A=b(g.value,"birthYear"),D={birthMonth:T,birthYear:A},P={...s._taskInfo.variantParams};await new o(s,P,D,B).run().then(async()=>{await I({adminId:e.value.id,taskId:u}),m.requireHomeRefresh(),l.push({name:"Home"})})}catch(t){console.error("An error occurred while starting the task:",t),alert("An error occurred while starting the task. Please refresh the page and try again. If the error persists, please submit an issue report.")}}return(e,t)=>(J(),H("div",O))}};export{X as default};
//# sourceMappingURL=TaskLevante-JMOTknX_.js.map
