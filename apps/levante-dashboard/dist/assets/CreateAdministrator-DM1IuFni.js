import{e as P,z as Q,d as Z,s as q,D as _,k as G,aQ as A}from"./index-kdKfEdeI.js";import{s as J}from"./index-d6wokVQG.js";import{s as K}from"./index-BEZzqj1Q.js";import{_ as W}from"./cloneDeep-Y1f-YOpN.js";import{_ as X}from"./GroupPicker.vue_vue_type_style_index_0_lang-CQJrHQRv.js";import{s as g}from"./index-D6IoMtKH.js";import{T as Y}from"./toasts-BqURhU4z.js";import{r,o as ee,Z as se,R as m,O as u,S as a,ac as te,k as l,_ as y,z as i,a1 as ae}from"./tanstack-CsBZeLmk.js";import"./phoneme-MNW3QAs-.js";import"./sentry-CX5z418I.js";import"./lodash-DAY8-RAI.js";import"./_arrayEach-FC5DT91E.js";import"./capitalize-DtoFwN2t.js";import"./upperFirst-CKgMld1W.js";import"./useDistrictsListQuery-XZoLl8le.js";import"./orgs-C8TAQ0-m.js";import"./index-D4pzgRTJ.js";import"./index-DgqMGbNZ.js";import"./index-CmbHKKL9.js";import"./index-BktsoGN8.js";import"./index-DB9mnE3k.js";import"./index-BOUM9DJf.js";import"./index-DBlP99Qc.js";(function(){try{var n=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},c=new n.Error().stack;c&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[c]="743a8103-53de-4c0e-9678-8ce8e0537fdb",n._sentryDebugIdIdentifier="sentry-dbid-743a8103-53de-4c0e-9678-8ce8e0537fdb")}catch{}})();const le={class:"container main"},ie={class:"main-body"},oe={class:"flex flex-column"},re={key:0,class:"w-full"},ne={class:"grid"},de={class:"col-12 md:col-6 lg:col-3 my-3"},me={class:"col-12 md:col-6 lg:col-3 my-3"},ue={class:"col-12 md:col-6 lg:col-3 my-3"},ce={class:"col-12 md:col-6 lg:col-3 my-3"},fe={class:"flex flex-row align-items-center justify-content-center gap-2 flex-order-0 my-3"},pe={class:"flex flex-row align-items-center"},ve={class:"flex w-full align-items-center justify-content-center"},_e={key:1,class:"loading-container"},ge={key:0},ye={key:1},je={__name:"CreateAdministrator",setup(n){const c=P(),f=Q(),b=r(!1),E=r(!1),x=r(),w=r(),V=r(),d=r(),h=r(!1),I=Z(),{roarfirekit:k}=q(I);let T;const N=()=>{T&&T(),b.value=!0};T=I.$subscribe(async(p,e)=>{e.roarfirekit.restConfig&&N()}),ee(()=>{k.value.restConfig&&N()});const o=r(),j=p=>{o.value=p},H=async()=>{var D,S,C,U,$,z,O,R,B,F,L,M;if(!await k.value.isEmailAvailable(d.value)){f.add({severity:"error",summary:"Error",detail:`Email ${d.value} is already in use. Please enter a different email address.`,life:Y});return}E.value=!0;const e={first:x.value,middle:w.value,last:V.value},v={districts:((S=(D=o.value)==null?void 0:D.districts)==null?void 0:S.map(t=>t.id))??[],schools:((U=(C=o.value)==null?void 0:C.schools)==null?void 0:U.map(t=>t.id))??[],classes:((z=($=o.value)==null?void 0:$.classes)==null?void 0:z.map(t=>t.id))??[],groups:((R=(O=o.value)==null?void 0:O.groups)==null?void 0:R.map(t=>t.id))??[],families:((F=(B=o.value)==null?void 0:B.families)==null?void 0:F.map(t=>t.id))??[]},s=W(v);for(const t of((L=o.value)==null?void 0:L.schools)??[])s.districts=A(s.districts,[t.districtId]);for(const t of((M=o.value)==null?void 0:M.classes)??[])s.districts=A(s.districts,[t.districtId]),s.schools=A(s.schools,[t.schoolId]);await k.value.createAdministrator(d.value,e,s,v,h.value).then(()=>{f.add({severity:"success",summary:"Success",detail:"Administrator account created",life:5e3}),c.push({name:"Home"})}).catch(t=>{f.add({severity:"error",summary:"Error",detail:t.message,life:5e3}),console.error(t)})};return(p,e)=>{const v=se("AppSpinner");return u(),m("main",le,[a("section",ie,[a("div",oe,[e[11]||(e[11]=te('<div class="flex flex-column mb-5 gap-2"><div class="flex align-items-center flex-wrap gap-3 mb-2"><i class="pi pi-user-plus text-gray-400 rounded" style="font-size:1.6rem;"></i><div class="admin-page-header">Create a new administrator account</div></div><div class="text-md text-gray-500 ml-6"> Use this form to create a new user and give them administrator access to selected organizations. </div></div>',1)),b.value&&!E.value?(u(),m("div",re,[a("div",ne,[a("div",de,[l(i(g),null,{default:y(()=>[l(i(_),{id:"first-name",modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=s=>x.value=s),class:"w-full","data-cy":"input-administrator-first-name"},null,8,["modelValue"]),e[6]||(e[6]=a("label",{for:"first-name"},"First Name",-1))]),_:1,__:[6]})]),a("div",me,[l(i(g),null,{default:y(()=>[l(i(_),{id:"middle-name",modelValue:w.value,"onUpdate:modelValue":e[1]||(e[1]=s=>w.value=s),class:"w-full","data-cy":"input-administrator-middle-name"},null,8,["modelValue"]),e[7]||(e[7]=a("label",{for:"middle-name"},"Middle Name",-1))]),_:1,__:[7]})]),a("div",ue,[l(i(g),null,{default:y(()=>[l(i(_),{id:"last-name",modelValue:V.value,"onUpdate:modelValue":e[2]||(e[2]=s=>V.value=s),class:"w-full","data-cy":"input-administrator-last-name"},null,8,["modelValue"]),e[8]||(e[8]=a("label",{for:"last-name"},"Last Name",-1))]),_:1,__:[8]})]),a("div",ce,[l(i(g),null,{default:y(()=>[l(i(_),{id:"email",modelValue:d.value,"onUpdate:modelValue":e[3]||(e[3]=s=>d.value=s),class:"w-full","data-cy":"input-administrator-email"},null,8,["modelValue"]),e[9]||(e[9]=a("label",{for:"email"},"Email",-1))]),_:1,__:[9]})])]),l(X,{onSelection:e[4]||(e[4]=s=>j(s))}),a("div",fe,[a("div",pe,[l(i(J),{modelValue:h.value,"onUpdate:modelValue":e[5]||(e[5]=s=>h.value=s),"input-id":"chbx-externalTask",binary:!0},null,8,["modelValue"]),e[10]||(e[10]=a("label",{class:"ml-1 mr-3",for:"chbx-externalTask"},[ae("Mark as "),a("b",null,"Test Administrator")],-1))])]),l(i(K)),a("div",ve,[a("div",null,[l(i(G),{class:"bg-primary text-white border-none border-round p-2 h-3rem hover:bg-red-900",label:"Create Administrator","data-cy":"button-create-administrator",onClick:H})])])])):(u(),m("div",_e,[l(v,{style:{"margin-bottom":"1rem"}}),b.value?(u(),m("span",ge,"Registering new administrator...")):(u(),m("span",ye,"Initializing..."))]))])])])}}};export{je as default};
//# sourceMappingURL=CreateAdministrator-DM1IuFni.js.map
