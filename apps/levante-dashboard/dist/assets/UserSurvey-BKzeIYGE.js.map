{"version":3,"file":"UserSurvey-BKzeIYGE.js","sources":["../../src/pages/UserSurvey.vue"],"sourcesContent":["<script setup>\nimport 'survey-core/survey-core.css';\nimport { SurveyComponent } from 'survey-vue3-ui';\nimport { useAuthStore } from '@/store/auth';\nimport { useSurveyStore } from '@/store/survey';\nimport { useI18n } from 'vue-i18n';\nimport { AudioContext } from '@/helpers/audio';\nimport { getParsedLocale } from '@/helpers/survey';\nimport { onBeforeRouteLeave, useRouter } from 'vue-router';\nimport { isLevante } from '@/helpers';\nimport PvButton from 'primevue/button';\nimport LevanteSpinner from '@/components/LevanteSpinner.vue';\nimport { onMounted } from 'vue';\n\nconst authStore = useAuthStore();\nconst router = useRouter();\nconst surveyStore = useSurveyStore();\nconst { locale } = useI18n();\nconst context = new AudioContext();\n\nonMounted(() => {\n  if (!surveyStore.survey) {\n    router.push({ name: 'Home' });\n  }\n});\n\nonBeforeRouteLeave(() => {\n  const surveyStore = useSurveyStore();\n\n  if (isLevante && surveyStore.currentSurveyAudioSource) {\n    surveyStore.currentSurveyAudioSource.stop();\n  }\n});\n\nasync function playAudio(name) {\n  const currentLocale = getParsedLocale(locale.value);\n  if (surveyStore.currentSurveyAudioSource) {\n    await surveyStore.currentSurveyAudioSource.stop();\n  }\n  const source = context.createBufferSource();\n  surveyStore.currentSurveyAudioSource = source;\n  source.buffer = surveyStore.surveyAudioPlayerBuffers[currentLocale][name];\n  source.connect(context.destination);\n  source.start(0);\n}\n</script>\n\n<template>\n  <div\n    v-if=\"\n      surveyStore.survey &&\n      !surveyStore.isSavingSurveyResponses &&\n      (!surveyStore.surveyAudioLoading || authStore.userData.userType === 'student')\n    \"\n  >\n    <h1\n      v-if=\"authStore.userData.userType !== 'student' && surveyStore.isGeneralSurveyComplete\"\n      class=\"text-2xl font-bold text-black text-center\"\n    >\n      {{\n        authStore.userData.userType === 'parent'\n          ? `${$t('userSurvey.specificRelationDescriptionChildA')} ${\n              surveyStore.specificSurveyRelationData[surveyStore.specificSurveyRelationIndex].birthMonth\n            } ${$t('userSurvey.specificRelationDescriptionChildB')} ${\n              surveyStore.specificSurveyRelationData[surveyStore.specificSurveyRelationIndex].birthYear\n            }`\n          : `${$t('userSurvey.specificRelationDescriptionClass')} ${\n              surveyStore.specificSurveyRelationData[surveyStore.specificSurveyRelationIndex].name\n            }`\n      }}\n    </h1>\n\n    <SurveyComponent :model=\"surveyStore.survey\" />\n\n    <div v-if=\"authStore.userData.userType === 'student'\">\n      <div v-for=\"page in surveyStore.survey.pages\" :key=\"page.name\">\n        <div v-for=\"item in page.elements[0].elements || page.elements\" :key=\"item.name\">\n          <PvButton\n            :id=\"'audio-button-' + item.name\"\n            icon=\"pi pi-volume-up text-white\"\n            style=\"display: none\"\n            @click=\"playAudio(item.name)\"\n          />\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <LevanteSpinner\n    v-if=\"!surveyStore.survey || surveyStore.isSavingSurveyResponses || surveyStore.surveyAudioLoading\"\n    fullscreen\n  />\n</template>\n\n<style>\n.play-button-visible {\n  display: flex;\n  position: absolute;\n  right: 0;\n  left: 500px;\n  width: 40px;\n  height: 40px;\n  background-color: var(--primary-color);\n  border: none;\n  border-radius: 25%;\n}\n.play-button-visible:hover {\n  background-color: var(--primary-color-hover);\n}\n</style>\n"],"names":["authStore","useAuthStore","router","useRouter","surveyStore","useSurveyStore","locale","useI18n","context","AudioContext","onMounted","onBeforeRouteLeave","playAudio","name","currentLocale","getParsedLocale","source","_unref","_createElementBlock","_hoisted_1","_openBlock","_hoisted_2","_toDisplayString","$t","_createVNode","SurveyComponent","_hoisted_3","_Fragment","page","_renderList","item","PvButton","$event","_createBlock","LevanteSpinner"],"mappings":"4zBAcA,MAAMA,EAAYC,EAAY,EACxBC,EAASC,EAAS,EAClBC,EAAcC,EAAc,EAC5B,CAAE,OAAAC,CAAM,EAAKC,EAAO,EACpBC,EAAU,IAAIC,EAEpBC,EAAU,IAAM,CACTN,EAAY,QACfF,EAAO,KAAK,CAAE,KAAM,MAAM,CAAE,CAEhC,CAAC,EAEDS,EAAmB,IAAM,CACvB,MAAMP,EAAcC,EAAc,EAEjBD,EAAY,0BAC3BA,EAAY,yBAAyB,KAAI,CAE7C,CAAC,EAED,eAAeQ,EAAUC,EAAM,CAC7B,MAAMC,EAAgBC,EAAgBT,EAAO,KAAK,EAC9CF,EAAY,0BACd,MAAMA,EAAY,yBAAyB,KAAI,EAEjD,MAAMY,EAASR,EAAQ,mBAAkB,EACzCJ,EAAY,yBAA2BY,EACvCA,EAAO,OAASZ,EAAY,yBAAyBU,CAAa,EAAED,CAAI,EACxEG,EAAO,QAAQR,EAAQ,WAAW,EAClCQ,EAAO,MAAM,CAAC,CAChB,6BAKiBC,EAAAb,CAAA,EAAY,QAAiB,CAAAa,EAAAb,CAAA,EAAY,0BAAmC,CAAAa,EAAAb,CAAA,EAAY,oBAAsBa,KAAU,SAAS,WAAQ,gBADxJC,EAsCM,MAAAC,EAAA,CA9BIF,EAAAjB,CAAA,EAAU,SAAS,WAAQ,WAAkBiB,EAAAb,CAAA,EAAY,yBADjEgB,EAAA,EAAAF,EAeK,KAfLG,EAeKC,EAVDL,KAAU,SAAS,WAAQ,YAA6BM,EAAAA,GAAE,8CAAA,CAAA,IAAmEN,EAAAb,CAAA,EAAY,2BAA2Ba,KAAY,2BAA2B,EAAE,cAA2BM,EAAAA,GAAE,8CAAA,CAAA,IAAmEN,EAAAb,CAAA,EAAY,2BAA2Ba,KAAY,2BAA2B,EAAE,eAAwCM,EAAAA,GAAE,6CAAA,CAAA,IAAkEN,EAAAb,CAAA,EAAY,2BAA2Ba,KAAY,2BAA2B,EAAE,qBAY7jBO,EAA+CP,EAAAQ,CAAA,EAAA,CAA7B,MAAOR,EAAAb,CAAA,EAAY,0BAE1Ba,EAAAjB,CAAA,EAAU,SAAS,WAAQ,eAAtCkB,EAWM,MAAAQ,EAAA,EAVJN,EAAA,EAAA,EAAAF,EASMS,SATcV,EAAAb,CAAA,EAAY,OAAO,MAA3BwB,QAAZV,EASM,MAAA,CATyC,IAAKU,EAAK,cACvDV,EAOMS,EAAA,KAAAE,EAPcD,EAAK,SAAQ,CAAA,EAAI,UAAYA,EAAK,SAA1CE,QAAZZ,EAOM,MAAA,CAP2D,IAAKY,EAAK,OACzEN,EAKEP,EAAAc,CAAA,EAAA,CAJC,GAAE,gBAAoBD,EAAK,KAC5B,KAAK,6BACL,MAAA,CAAA,QAAA,MAAA,EACC,QAAKE,GAAEpB,EAAUkB,EAAK,IAAI,yEAQ5Bb,EAAAb,CAAA,EAAY,QAAUa,EAAAb,CAAA,EAAY,yBAA2Ba,EAAAb,CAAA,EAAY,wBADlF6B,EAGEC,EAAA,OADA,WAAA"}