{"version":3,"file":"utils-DSob1QZ1.js","sources":["../../../../node_modules/mime-db/index.js","../../../../node_modules/mime-types/index.js","../../../../node_modules/@bdelab/roar-utils/lib/utils.js","../../../../node_modules/jspsych/dist/index.js","../../../../node_modules/@jspsych/plugin-preload/dist/index.js"],"sourcesContent":["/*!\n * mime-db\n * Copyright(c) 2014 Jonathan Ong\n * Copyright(c) 2015-2022 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n/**\n * Module exports.\n */\n\nmodule.exports = require('./db.json')\n","/*!\n * mime-types\n * Copyright(c) 2014 Jonathan Ong\n * Copyright(c) 2015 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict'\n\n/**\n * Module dependencies.\n * @private\n */\n\nvar db = require('mime-db')\nvar extname = require('path').extname\n\n/**\n * Module variables.\n * @private\n */\n\nvar EXTRACT_TYPE_REGEXP = /^\\s*([^;\\s]*)(?:;|\\s|$)/\nvar TEXT_TYPE_REGEXP = /^text\\//i\n\n/**\n * Module exports.\n * @public\n */\n\nexports.charset = charset\nexports.charsets = { lookup: charset }\nexports.contentType = contentType\nexports.extension = extension\nexports.extensions = Object.create(null)\nexports.lookup = lookup\nexports.types = Object.create(null)\n\n// Populate the extensions/types maps\npopulateMaps(exports.extensions, exports.types)\n\n/**\n * Get the default charset for a MIME type.\n *\n * @param {string} type\n * @return {boolean|string}\n */\n\nfunction charset (type) {\n  if (!type || typeof type !== 'string') {\n    return false\n  }\n\n  // TODO: use media-typer\n  var match = EXTRACT_TYPE_REGEXP.exec(type)\n  var mime = match && db[match[1].toLowerCase()]\n\n  if (mime && mime.charset) {\n    return mime.charset\n  }\n\n  // default text/* to utf-8\n  if (match && TEXT_TYPE_REGEXP.test(match[1])) {\n    return 'UTF-8'\n  }\n\n  return false\n}\n\n/**\n * Create a full Content-Type header given a MIME type or extension.\n *\n * @param {string} str\n * @return {boolean|string}\n */\n\nfunction contentType (str) {\n  // TODO: should this even be in this module?\n  if (!str || typeof str !== 'string') {\n    return false\n  }\n\n  var mime = str.indexOf('/') === -1\n    ? exports.lookup(str)\n    : str\n\n  if (!mime) {\n    return false\n  }\n\n  // TODO: use content-type or other module\n  if (mime.indexOf('charset') === -1) {\n    var charset = exports.charset(mime)\n    if (charset) mime += '; charset=' + charset.toLowerCase()\n  }\n\n  return mime\n}\n\n/**\n * Get the default extension for a MIME type.\n *\n * @param {string} type\n * @return {boolean|string}\n */\n\nfunction extension (type) {\n  if (!type || typeof type !== 'string') {\n    return false\n  }\n\n  // TODO: use media-typer\n  var match = EXTRACT_TYPE_REGEXP.exec(type)\n\n  // get extensions\n  var exts = match && exports.extensions[match[1].toLowerCase()]\n\n  if (!exts || !exts.length) {\n    return false\n  }\n\n  return exts[0]\n}\n\n/**\n * Lookup the MIME type for a file path/extension.\n *\n * @param {string} path\n * @return {boolean|string}\n */\n\nfunction lookup (path) {\n  if (!path || typeof path !== 'string') {\n    return false\n  }\n\n  // get the extension (\"ext\" or \".ext\" or full path)\n  var extension = extname('x.' + path)\n    .toLowerCase()\n    .substr(1)\n\n  if (!extension) {\n    return false\n  }\n\n  return exports.types[extension] || false\n}\n\n/**\n * Populate the extensions and types maps.\n * @private\n */\n\nfunction populateMaps (extensions, types) {\n  // source preference (least -> most)\n  var preference = ['nginx', 'apache', undefined, 'iana']\n\n  Object.keys(db).forEach(function forEachMimeType (type) {\n    var mime = db[type]\n    var exts = mime.extensions\n\n    if (!exts || !exts.length) {\n      return\n    }\n\n    // mime -> extensions\n    extensions[type] = exts\n\n    // extension -> mime\n    for (var i = 0; i < exts.length; i++) {\n      var extension = exts[i]\n\n      if (types[extension]) {\n        var from = preference.indexOf(db[types[extension]].source)\n        var to = preference.indexOf(mime.source)\n\n        if (types[extension] !== 'application/octet-stream' &&\n          (from > to || (from === to && types[extension].substr(0, 12) === 'application/'))) {\n          // skip the remapping\n          continue\n        }\n      }\n\n      // set the extension -> mime\n      types[extension] = type\n    }\n  })\n}\n","function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n/* eslint-disable no-underscore-dangle */\nimport path from 'path-browserify';\nimport mime from 'mime-types';\nimport { deviceType, primaryInput } from 'detect-it';\n\n// converts a string to camel case\nexport function camelize(string) {\n  return string.replace(/^([A-Z])|[\\s-_](\\w)/g, function (_0, p1, p2, _1) {\n    if (p2) return p2.toUpperCase();\n    return p1.toLowerCase();\n  });\n}\n\n// get an object where the key is camelize(filename) and the value is the filename\nexport function camelizeFiles(files) {\n  var obj = {};\n  var _iterator = _createForOfIteratorHelper(files),\n    _step;\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var filePath = _step.value;\n      var fileName = path.parse(filePath).name;\n      obj[camelize(fileName)] = filePath;\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n  return obj;\n}\n\n/*\nPlays the correct audio based on user response.\nIf user response does not matter, it will play a neutral feedback audio.\nTakes in 3 parameters:\n- responseIsCorrect (boolean || null): if the user's response was correct/incorrect\nOR null if it does matter, ex. true OR null\n- correct/neutral audio (string): path to the audio file, ex. \"http://localhost:8080/audio/feedbackAudio.mp3\"\n- incorrect audio (string): path to the audio file\n*/\n\n/*\nExamples of the function can be called\n\nplayFeedbackAudio(true, 'correct.mp3', 'incorrect.mp3')\nplayFeedbackAudio(null, 'neutral.mp3',)\n*/\n\nexport function playFeedbackAudio(responseIsCorrect, audio1, audio2) {\n  var audioToPlay;\n  if (responseIsCorrect || responseIsCorrect === null) {\n    audioToPlay = audio1;\n  } else {\n    audioToPlay = audio2;\n  }\n  new Audio(audioToPlay).play();\n}\n\n// Gets the app language based on the lng query string. Using this because ROAR apps use i18next.\nexport function getLanguage(setLanguage) {\n  if (setLanguage) return setLanguage;\n  var urlParams = new URLSearchParams(window.location.search);\n  return urlParams.get('lng') || 'en';\n}\n\n// Gets the device type based on the device inputs\nexport function getDevice() {\n  if (deviceType === 'touchOnly' || deviceType === 'hybrid' && primaryInput === 'touch') {\n    return 'mobile';\n  }\n  return 'desktop';\n}\n\n// Returns device-level information of user through the browser window object.\nexport function getDeviceInfo() {\n  var width = window.innerWidth;\n  var height = window.innerHeight;\n  var language = window.navigator.language;\n  var userAgent = window.navigator.userAgent;\n  var userAgentData = window.navigator.userAgentData;\n  return {\n    screen: {\n      width: width,\n      height: height\n    },\n    language: language,\n    userAgent: userAgent,\n    platform: userAgentData.platform,\n    mobile: userAgentData.mobile,\n    engine: userAgentData.brands[0].brand,\n    engineVersion: userAgentData.brands[0].version,\n    browser: userAgentData.brands[1].brand,\n    browserVersion: userAgentData.brands[1].version\n  };\n}\n\n/**\n * Returns the formatted URL based on different conditions for asset type,\n * nesting and default values.\n *\n * @param {string} bucketURI - The bucket URI where the assets are stored.\n * Ex. 'https://storage.googleapis.com/${bucketName}\n * @param {string} filePath - The file path of the asset.\n * @param {string} lng - The language identifier as a ISO 639-1 code. Ex. 'en' for English\n * @param {string} device - The device identifier.\n * @param {string} type - The type of asset category. Can be one of the following:\n * 'device', 'shared', 'shared/device', 'languageSpecific', 'default'.\n * @param {boolean} nested - Indicates if the asset is nested in language specific data.\n *  Default is false.\n * @param {boolean} isDefault - Indicates if the asset is from default data. Default is false.\n * @returns {string} The formatted URL based on the given conditions.\n * Ex. 'https://storage.googleapis.com/${bucketName}/${lng}/${device}/${file}'\n */\n\nexport function getFormattedURL(bucketURI, filePath, lng, device, type, nested, isDefault) {\n  if (isDefault && nested && type === 'device' || nested && type === 'device') {\n    return \"\".concat(bucketURI, \"/\").concat(lng, \"/\").concat(device, \"/\").concat(filePath);\n  }\n  if (isDefault && nested && type === 'shared' || nested && type === 'shared') {\n    return \"\".concat(bucketURI, \"/\").concat(lng, \"/shared/\").concat(filePath);\n  }\n  if (type === 'device') {\n    return \"\".concat(bucketURI, \"/\").concat(device, \"/\").concat(filePath);\n  }\n  if (type === 'shared/device') {\n    return \"\".concat(bucketURI, \"/shared/\").concat(device, \"/\").concat(filePath);\n  }\n  if (type === 'languageSpecific') {\n    return \"\".concat(bucketURI, \"/\").concat(lng, \"/\").concat(filePath);\n  }\n  if (type === 'default') {\n    return \"\".concat(bucketURI, \"/\").concat(filePath);\n  }\n  return \"\".concat(bucketURI, \"/shared/\").concat(filePath);\n}\nexport function getAssetType(asset) {\n  var mimeType = mime.lookup(asset);\n  if (!mimeType) {\n    throw new Error(\"Unrecognized file extension in path: \".concat(asset));\n  }\n  if (mimeType.startsWith('image/')) return 'images';\n  if (mimeType.startsWith('audio/')) return 'audio';\n  if (mimeType.startsWith('video/')) return 'video';\n  throw new Error(\"Unsupported MIME type for file: \".concat(asset, \". Only image, audio, and video files are supported.\"));\n}\n\n/**\n * Calculates and returns age data based on the provided birth month, birth year,\n * age, and age in months.\n *\n * @function getAgeData\n *\n * @param {string|number|null} birthMonth - The month of birth (1-12).\n * If not provided, it will be calculated based on other parameters.\n * @param {string|number|null} birthYear - The year of birth.\n * If not provided, it will be calculated based on other parameters.\n * @param {string|number|null} age - The age in years.\n * If not provided, it will be calculated based on other parameters.\n * @param {string|number|null} ageMonths - The age in months.\n * If not provided, it will be calculated based on other parameters.\n *\n * @returns {Object} ageData - The calculated age data.\n * @returns {number|null} ageData.age - The calculated age in years.\n * @returns {number|null} ageData.ageMonths - The calculated age in months.\n * @returns {number|null} ageData.birthMonth - The calculated or provided month of birth.\n * @returns {number|null} ageData.birthYear - The calculated or provided year of birth.\n */\n\nexport var getAgeData = function getAgeData(birthMonth, birthYear, age, ageMonths) {\n  // milliseconds per year (accounting for leap years)\n  var msPerYear = 1000 * 60 * 60 * 24 * 365.25;\n  var currDate = new Date();\n  var safeNumber = function safeNumber(value) {\n    var numValue = Number(value);\n    return Object.is(numValue, NaN) || numValue === 0 ? null : numValue;\n  };\n  var bm = safeNumber(birthMonth);\n  var by = safeNumber(birthYear);\n  var yearsOld = safeNumber(age);\n  var ageM = safeNumber(ageMonths);\n  var ageData = {\n    age: yearsOld,\n    ageMonths: ageM\n  };\n  if (bm && by) {\n    ageData.birthMonth = bm;\n    ageData.birthYear = by;\n    var birthDate = new Date(by, bm - 1, currDate.getDate());\n    var decimalYear = (currDate - birthDate) / msPerYear;\n    ageData.age = Math.floor(decimalYear);\n    ageData.ageMonths = ageM || Math.floor(decimalYear * 12);\n  } else if (by) {\n    ageData.birthYear = by;\n    ageData.birthMonth = currDate.getMonth() + 1;\n    var _birthDate = new Date(by, ageData.birthMonth - 1, currDate.getDate());\n    var _decimalYear = (currDate - _birthDate) / msPerYear;\n    ageData.age = Math.floor(_decimalYear);\n    ageData.ageMonths = ageM || Math.floor(_decimalYear * 12);\n  } else if (ageM) {\n    var _birthDate2 = new Date();\n    _birthDate2.setMonth(_birthDate2.getMonth() - ageM);\n    ageData.birthYear = _birthDate2.getFullYear();\n    ageData.birthMonth = _birthDate2.getMonth() + 1;\n    ageData.age = Math.floor((currDate - _birthDate2) / msPerYear);\n  } else if (yearsOld) {\n    ageData.birthYear = currDate.getFullYear() - yearsOld;\n    ageData.birthMonth = currDate.getMonth() + 1;\n    ageData.ageMonths = yearsOld * 12;\n  } else {\n    ageData.birthMonth = null;\n    ageData.birthYear = null;\n  }\n  return ageData;\n};\n\n/**\n * Return grade after min/max filtering and accounting for string values.\n *\n * @function getGrade\n *\n * @param {string|number|null} inputGrade - The input grade.\n * @param {number} gradeMin - The minimum grade. Default is 0 (for Kindergarten).\n * @param {number} gradeMax - The maximum grade. Default is 12.\n *\n * @returns {number} numeric grade\n */\nexport var getGrade = function getGrade(inputGrade) {\n  var gradeMin = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  var gradeMax = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 13;\n  var parsedGrade = Number(inputGrade);\n  var gradeStringMap = {\n    k: 0,\n    tk: 0,\n    pk: 0,\n    preschool: 0,\n    prekindergarten: 0,\n    transitionalkindergarten: 0,\n    kindergarten: 0,\n    infanttoddler: 0,\n    infant: 0,\n    toddler: 0,\n    first: 1,\n    firstgrade: 1,\n    second: 2,\n    secondgrade: 2,\n    third: 3,\n    thirdgrade: 3,\n    fourth: 4,\n    fourthgrade: 4,\n    fifth: 5,\n    fifthgrade: 5,\n    sixth: 6,\n    sixthgrade: 6,\n    seventh: 7,\n    seventhgrade: 7,\n    eighth: 8,\n    eighthgrade: 8,\n    ninth: 9,\n    ninthgrade: 9,\n    tenth: 10,\n    tenthgrade: 10,\n    eleventh: 11,\n    eleventhgrade: 11,\n    twelfth: 12,\n    twelfthgrade: 12,\n    freshman: 9,\n    sophomore: 10,\n    junior: 11,\n    senior: 12,\n    postgraduate: 13,\n    university: 13,\n    graduate: 13,\n    master: 13,\n    doctorate: 13,\n    masters: 13\n  };\n\n  // if inputGrade is null or undefined, return undefined to avoid an error with undefined.toLowerCase()\n  if (inputGrade === null || inputGrade === undefined) {\n    return undefined;\n  }\n  if (Number.isNaN(parsedGrade)) {\n    // Grade is a string. Remove any whitespace and hyphens. Make lowercase.\n    // And refer to the gradeStringMap for the mapping.\n    var spaceRegex = /\\s/g;\n    var hyphenRegex = /-/g;\n    var standardizedGradeString = inputGrade.toLowerCase().replace(spaceRegex, '').replace(hyphenRegex, '');\n    var grade = gradeStringMap[standardizedGradeString];\n    if (grade === undefined) return undefined;\n    if (grade < gradeMin) return gradeMin;\n    if (grade > gradeMax) return gradeMax;\n    return grade;\n  }\n  if (parsedGrade < gradeMin) {\n    return gradeMin;\n  }\n  if (parsedGrade > gradeMax) {\n    return gradeMax;\n  }\n\n  // grade is within range and is a number\n  return parsedGrade;\n};\n\n/**\n * Return grade after min/max filtering and accounting for string values.\n *\n * @const median\n *\n * @param {array} array - Array of response times.\n *\n * @returns {number} median of array of response times\n */\nexport var median = function median(array) {\n  array.sort(function (a, b) {\n    return b - a;\n  });\n  var length = array.length;\n  if (length % 2 === 0) {\n    return (array[length / 2] + array[length / 2 - 1]) / 2;\n  }\n  return array[Math.floor(length / 2)];\n};\n\n/**\n * Returns a function that evaluates the reliability of a run based on the following criteria:\n *\n * @param {number} responseTimeLowThreshold - The minimum acceptable response time threshold in MS.\n * @param {number} responseTimeHighThreshold - The maximum acceptable response time threshold in MS.\n * @param {number} accuracyThreshold - The minimum acceptable accuracy threshold.\n * @param {array} includedReliabilityFlags - An array of flags that should be included\n * when evaluating reliability.\n * @returns {function} baseValidityEvaluator - A function that evaluates the reliability of a run.\n */\nexport function createEvaluateValidity(_ref) {\n  var _ref$responseTimeLowT = _ref.responseTimeLowThreshold,\n    responseTimeLowThreshold = _ref$responseTimeLowT === void 0 ? 400 : _ref$responseTimeLowT,\n    _ref$responseTimeHigh = _ref.responseTimeHighThreshold,\n    responseTimeHighThreshold = _ref$responseTimeHigh === void 0 ? 10000 : _ref$responseTimeHigh,\n    _ref$accuracyThreshol = _ref.accuracyThreshold,\n    accuracyThreshold = _ref$accuracyThreshol === void 0 ? 0.2 : _ref$accuracyThreshol,\n    _ref$minResponsesRequ = _ref.minResponsesRequired,\n    minResponsesRequired = _ref$minResponsesRequ === void 0 ? 0 : _ref$minResponsesRequ,\n    _ref$includedReliabil = _ref.includedReliabilityFlags,\n    includedReliabilityFlags = _ref$includedReliabil === void 0 ? ['responseTimeTooFast'] : _ref$includedReliabil;\n  return function baseEvaluateValidity(_ref2) {\n    var responseTimes = _ref2.responseTimes,\n      responses = _ref2.responses,\n      correct = _ref2.correct,\n      completed = _ref2.completed;\n    var flags = [];\n    var isReliable = false;\n    if (responseTimes.length < minResponsesRequired) {\n      flags.push('notEnoughResponses');\n    } else {\n      var _correct$filter$lengt;\n      // verifies if responseTimes lie above or below a threshold\n      if (median(responseTimes) <= responseTimeLowThreshold) {\n        flags.push('responseTimeTooFast');\n      }\n      if (median(responseTimes) >= responseTimeHighThreshold) {\n        flags.push('responseTimeTooSlow');\n      }\n      if (completed === false && includedReliabilityFlags.includes('incomplete')) {\n        flags.push('incomplete');\n      }\n\n      // TODO: Calculate response similarity based on maxChainLength\n\n      // Calculate accuracy based on the number of correct responses\n      var numCorrect = (_correct$filter$lengt = correct === null || correct === void 0 ? void 0 : correct.filter(function (x) {\n        return x === 1;\n      }).length) !== null && _correct$filter$lengt !== void 0 ? _correct$filter$lengt : 0;\n      if (numCorrect / correct.length <= accuracyThreshold) {\n        flags.push('accuracyTooLow');\n      }\n      isReliable = flags.filter(function (x) {\n        return includedReliabilityFlags.includes(x);\n      }).length === 0;\n      flags = flags.filter(function (x) {\n        return includedReliabilityFlags.includes(x);\n      });\n    }\n    return {\n      flags: flags,\n      isReliable: isReliable\n    };\n  };\n}\n\n/**\n * Tracks response times and invokes callback function when response times\n * exceed specified thresholds.\n *\n * @class ResponseTimeTracker\n * @param {Function} evaluateValidity function to be called to generate an decision on the\n *    reliability of a run\n * @param {Function} addEngagementFlags function passed through to update the run's\n *  firekit object with flags tripped\n * @param {number} minResponsesRequired The minimum number of responses required before\n *   checking for threshold exceedance.\n * @property {Array<number>} _responseTimes An array to store the response times.\n * @property {Array<number>} _responses An array to store the responses\n * (keypresses or button choices).\n * @property {Array<number>} _correct An array to store the correctness of the responses.\n */\nexport var ValidityEvaluator = /*#__PURE__*/function () {\n  function ValidityEvaluator(_ref3) {\n    var _ref3$evaluateValidit = _ref3.evaluateValidity,\n      evaluateValidity = _ref3$evaluateValidit === void 0 ? createEvaluateValidity() : _ref3$evaluateValidit,\n      _ref3$handleEngagemen = _ref3.handleEngagementFlags,\n      handleEngagementFlags = _ref3$handleEngagemen === void 0 ? function () {} : _ref3$handleEngagemen;\n    _classCallCheck(this, ValidityEvaluator);\n    this.evaluateValidity = evaluateValidity;\n    this.handleEngagementFlags = handleEngagementFlags;\n    this._responseTimes = [];\n    this._responses = [];\n    this._correct = [];\n    this._preserveFlags = [];\n    this.currentBlock = undefined;\n    this.reliabilityByBlock = {};\n    this.completed = false;\n  }\n\n  /**\n   * Takes in array of flags and returns array of flags with current block appended to each flag\n   * @function appendCurrentBlockToFlags\n   * @param {Array<string>} flags\n   */\n  _createClass(ValidityEvaluator, [{\n    key: \"appendCurrentBlockToFlags\",\n    value: function appendCurrentBlockToFlags(flags) {\n      var _this = this;\n      if (this.currentBlock !== undefined) {\n        // We only want to append for block based flags, incomplete would be a global flag\n        return flags.map(function (flag) {\n          return flag !== 'incomplete' ? \"\".concat(flag, \"_\").concat(_this.currentBlock) : flag;\n        });\n      }\n      return flags;\n    }\n\n    /**\n     * Returns true if all blocks so far are reliable, false if not\n     * @function calculateReliabilityWithBlocks\n     */\n  }, {\n    key: \"calculateReliabilityWithBlocks\",\n    value: function calculateReliabilityWithBlocks() {\n      return Object.values(this.reliabilityByBlock).every(function (x) {\n        return x === true;\n      });\n    }\n\n    /**\n     *  @function startNewBlockValidation Called when a new block is started to reset the\n     * data arrays and update the evaluateValidity function if needed\n     * For block-scoped assessments, this function must be called with the first block name\n     * before beginning the first block\n     * @param {Function} evaluateValidity\n     * @param {String} currentBlock The name of the current block\n     */\n  }, {\n    key: \"startNewBlockValidation\",\n    value: function startNewBlockValidation(currentBlock) {\n      var evaluateValidity = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.evaluateValidity;\n      // Compute and store flags from the previous block\n      // The first conditional prevents a tooFewResponses flag from being\n      // stored erroneously before the initial block begins\n      if (this._responseTimes.length > 0 && currentBlock !== undefined) {\n        var flags = this.calculateAndUpdateFlags();\n        // Update new flags to preserveFlags array\n        this._preserveFlags = [].concat(_toConsumableArray(this._preserveFlags), _toConsumableArray(this.appendCurrentBlockToFlags(flags)));\n      }\n      this.currentBlock = currentBlock;\n      this.evaluateValidity = evaluateValidity;\n      this._responseTimes = [];\n      this._responses = [];\n      this._correct = [];\n      this.completed = false;\n    }\n\n    /**\n     *  @function markAsCompleted Called when a block or task is completed.\n     * For block-scoped assessments, this function must be called at the completion\n     * of each block\n     * */\n  }, {\n    key: \"markAsCompleted\",\n    value: function markAsCompleted() {\n      this.completed = true;\n      this.calculateAndUpdateFlags();\n    }\n\n    /**\n     *  @function calculateAndUpdateFlags Helper function to calculate flag and reliability\n     * and use the handleEngagementFlags function to update the run's firekit object\n     * @return {Array<string>} flags\n     * */\n  }, {\n    key: \"calculateAndUpdateFlags\",\n    value: function calculateAndUpdateFlags() {\n      var _this$evaluateValidit = this.evaluateValidity({\n          responseTimes: this._responseTimes,\n          responses: this._responses,\n          correct: this._correct,\n          completed: this.completed\n        }),\n        flags = _this$evaluateValidit.flags,\n        isReliable = _this$evaluateValidit.isReliable;\n\n      // Case for block based assessments\n      if (this.currentBlock !== undefined) {\n        this.reliabilityByBlock[this.currentBlock] = isReliable;\n\n        // Please note that calling this function with a new set of engagement flags\n        // will overwrite the previous set.\n        this.handleEngagementFlags([].concat(_toConsumableArray(this._preserveFlags), _toConsumableArray(this.appendCurrentBlockToFlags(flags))), this.calculateReliabilityWithBlocks(), this.reliabilityByBlock);\n      } else {\n        // Please note that calling this function with a new set of engagement flags\n        // will overwrite the previous set.\n        this.handleEngagementFlags(flags, isReliable);\n      }\n      return flags;\n    }\n\n    /**\n     * Updates ValidityEvaluator arrays (responseTimes, response, and accuracy) with\n     *\n     * @function addResponseData\n     * @param {number} responseTime Time it took for a user to respond to a stimulus\n     * @param {string} response  Choice that a user responded with\n     * ex: left_arrow, right_arrow, button_3\n     * @param {number} isCorrect 1 if a user answered correctly, 0 if answered incorrectly\n     */\n  }, {\n    key: \"addResponseData\",\n    value: function addResponseData(responseTime, response, isCorrect) {\n      this._responseTimes.push(responseTime);\n      this._responses.push(response);\n      this._correct.push(isCorrect);\n      this.calculateAndUpdateFlags();\n    }\n  }]);\n  return ValidityEvaluator;\n}();","/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise, SuppressedError, Symbol */\r\n\r\n\r\nfunction __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\ntypeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\n\nvar commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\nfunction getDefaultExportFromCjs (x) {\n\treturn x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x['default'] : x;\n}\n\n// Gets all non-builtin properties up the prototype chain\nconst getAllProperties = object => {\n\tconst properties = new Set();\n\n\tdo {\n\t\tfor (const key of Reflect.ownKeys(object)) {\n\t\t\tproperties.add([object, key]);\n\t\t}\n\t} while ((object = Reflect.getPrototypeOf(object)) && object !== Object.prototype);\n\n\treturn properties;\n};\n\nvar autoBind = (self, {include, exclude} = {}) => {\n\tconst filter = key => {\n\t\tconst match = pattern => typeof pattern === 'string' ? key === pattern : pattern.test(key);\n\n\t\tif (include) {\n\t\t\treturn include.some(match);\n\t\t}\n\n\t\tif (exclude) {\n\t\t\treturn !exclude.some(match);\n\t\t}\n\n\t\treturn true;\n\t};\n\n\tfor (const [object, key] of getAllProperties(self.constructor.prototype)) {\n\t\tif (key === 'constructor' || !filter(key)) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tconst descriptor = Reflect.getOwnPropertyDescriptor(object, key);\n\t\tif (descriptor && typeof descriptor.value === 'function') {\n\t\t\tself[key] = self[key].bind(self);\n\t\t}\n\t}\n\n\treturn self;\n};\n\nvar autoBind$1 = /*@__PURE__*/getDefaultExportFromCjs(autoBind);\n\nvar version = \"7.3.4\";\n\nclass MigrationError extends Error {\n    constructor(message = \"The global `jsPsych` variable is no longer available in jsPsych v7.\") {\n        super(`${message} Please follow the migration guide at https://www.jspsych.org/7.0/support/migration-v7/ to update your experiment.`);\n        this.name = \"MigrationError\";\n    }\n}\n// Define a global jsPsych object to handle invocations on it with migration errors\nwindow.jsPsych = {\n    get init() {\n        throw new MigrationError(\"`jsPsych.init()` was replaced by `initJsPsych()` in jsPsych v7.\");\n    },\n    get data() {\n        throw new MigrationError();\n    },\n    get randomization() {\n        throw new MigrationError();\n    },\n    get turk() {\n        throw new MigrationError();\n    },\n    get pluginAPI() {\n        throw new MigrationError();\n    },\n    get ALL_KEYS() {\n        throw new MigrationError('jsPsych.ALL_KEYS was replaced by the \"ALL_KEYS\" string in jsPsych v7.');\n    },\n    get NO_KEYS() {\n        throw new MigrationError('jsPsych.NO_KEYS was replaced by the \"NO_KEYS\" string in jsPsych v7.');\n    },\n};\n\n/**\n * Finds all of the unique items in an array.\n * @param arr The array to extract unique values from\n * @returns An array with one copy of each unique item in `arr`\n */\nfunction unique(arr) {\n    return [...new Set(arr)];\n}\nfunction deepCopy(obj) {\n    if (!obj)\n        return obj;\n    let out;\n    if (Array.isArray(obj)) {\n        out = [];\n        for (const x of obj) {\n            out.push(deepCopy(x));\n        }\n        return out;\n    }\n    else if (typeof obj === \"object\" && obj !== null) {\n        out = {};\n        for (const key in obj) {\n            if (obj.hasOwnProperty(key)) {\n                out[key] = deepCopy(obj[key]);\n            }\n        }\n        return out;\n    }\n    else {\n        return obj;\n    }\n}\n/**\n * Merges two objects, recursively.\n * @param obj1 Object to merge\n * @param obj2 Object to merge\n */\nfunction deepMerge(obj1, obj2) {\n    let merged = {};\n    for (const key in obj1) {\n        if (obj1.hasOwnProperty(key)) {\n            if (typeof obj1[key] === \"object\" && obj2.hasOwnProperty(key)) {\n                merged[key] = deepMerge(obj1[key], obj2[key]);\n            }\n            else {\n                merged[key] = obj1[key];\n            }\n        }\n    }\n    for (const key in obj2) {\n        if (obj2.hasOwnProperty(key)) {\n            if (!merged.hasOwnProperty(key)) {\n                merged[key] = obj2[key];\n            }\n            else if (typeof obj2[key] === \"object\") {\n                merged[key] = deepMerge(merged[key], obj2[key]);\n            }\n            else {\n                merged[key] = obj2[key];\n            }\n        }\n    }\n    return merged;\n}\n\nvar utils = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    deepCopy: deepCopy,\n    deepMerge: deepMerge,\n    unique: unique\n});\n\nclass DataColumn {\n    constructor(values = []) {\n        this.values = values;\n    }\n    sum() {\n        let s = 0;\n        for (const v of this.values) {\n            s += v;\n        }\n        return s;\n    }\n    mean() {\n        return this.sum() / this.count();\n    }\n    median() {\n        if (this.values.length === 0) {\n            return undefined;\n        }\n        const numbers = this.values.slice(0).sort(function (a, b) {\n            return a - b;\n        });\n        const middle = Math.floor(numbers.length / 2);\n        const isEven = numbers.length % 2 === 0;\n        return isEven ? (numbers[middle] + numbers[middle - 1]) / 2 : numbers[middle];\n    }\n    min() {\n        return Math.min.apply(null, this.values);\n    }\n    max() {\n        return Math.max.apply(null, this.values);\n    }\n    count() {\n        return this.values.length;\n    }\n    variance() {\n        const mean = this.mean();\n        let sum_square_error = 0;\n        for (const x of this.values) {\n            sum_square_error += Math.pow(x - mean, 2);\n        }\n        const mse = sum_square_error / (this.values.length - 1);\n        return mse;\n    }\n    sd() {\n        const mse = this.variance();\n        const rmse = Math.sqrt(mse);\n        return rmse;\n    }\n    frequencies() {\n        const unique = {};\n        for (const x of this.values) {\n            if (typeof unique[x] === \"undefined\") {\n                unique[x] = 1;\n            }\n            else {\n                unique[x]++;\n            }\n        }\n        return unique;\n    }\n    all(eval_fn) {\n        for (const x of this.values) {\n            if (!eval_fn(x)) {\n                return false;\n            }\n        }\n        return true;\n    }\n    subset(eval_fn) {\n        const out = [];\n        for (const x of this.values) {\n            if (eval_fn(x)) {\n                out.push(x);\n            }\n        }\n        return new DataColumn(out);\n    }\n}\n\n// private function to save text file on local drive\nfunction saveTextToFile(textstr, filename) {\n    const blobToSave = new Blob([textstr], {\n        type: \"text/plain\",\n    });\n    let blobURL = \"\";\n    if (typeof window.webkitURL !== \"undefined\") {\n        blobURL = window.webkitURL.createObjectURL(blobToSave);\n    }\n    else {\n        blobURL = window.URL.createObjectURL(blobToSave);\n    }\n    const link = document.createElement(\"a\");\n    link.id = \"jspsych-download-as-text-link\";\n    link.style.display = \"none\";\n    link.download = filename;\n    link.href = blobURL;\n    link.click();\n}\n// this function based on code suggested by StackOverflow users:\n// http://stackoverflow.com/users/64741/zachary\n// http://stackoverflow.com/users/317/joseph-sturtevant\nfunction JSON2CSV(objArray) {\n    const array = typeof objArray != \"object\" ? JSON.parse(objArray) : objArray;\n    let line = \"\";\n    let result = \"\";\n    const columns = [];\n    for (const row of array) {\n        for (const key in row) {\n            let keyString = key + \"\";\n            keyString = '\"' + keyString.replace(/\"/g, '\"\"') + '\",';\n            if (!columns.includes(key)) {\n                columns.push(key);\n                line += keyString;\n            }\n        }\n    }\n    line = line.slice(0, -1); // removes last comma\n    result += line + \"\\r\\n\";\n    for (const row of array) {\n        line = \"\";\n        for (const col of columns) {\n            let value = typeof row[col] === \"undefined\" ? \"\" : row[col];\n            if (typeof value == \"object\") {\n                value = JSON.stringify(value);\n            }\n            const valueString = value + \"\";\n            line += '\"' + valueString.replace(/\"/g, '\"\"') + '\",';\n        }\n        line = line.slice(0, -1);\n        result += line + \"\\r\\n\";\n    }\n    return result;\n}\n// this function is modified from StackOverflow:\n// http://stackoverflow.com/posts/3855394\nfunction getQueryString() {\n    const a = window.location.search.substr(1).split(\"&\");\n    const b = {};\n    for (let i = 0; i < a.length; ++i) {\n        const p = a[i].split(\"=\", 2);\n        if (p.length == 1)\n            b[p[0]] = \"\";\n        else\n            b[p[0]] = decodeURIComponent(p[1].replace(/\\+/g, \" \"));\n    }\n    return b;\n}\n\nclass DataCollection {\n    constructor(data = []) {\n        this.trials = data;\n    }\n    push(new_data) {\n        this.trials.push(new_data);\n        return this;\n    }\n    join(other_data_collection) {\n        this.trials = this.trials.concat(other_data_collection.values());\n        return this;\n    }\n    top() {\n        if (this.trials.length <= 1) {\n            return this;\n        }\n        else {\n            return new DataCollection([this.trials[this.trials.length - 1]]);\n        }\n    }\n    /**\n     * Queries the first n elements in a collection of trials.\n     *\n     * @param n A positive integer of elements to return. A value of\n     *          n that is less than 1 will throw an error.\n     *\n     * @return First n objects of a collection of trials. If fewer than\n     *         n trials are available, the trials.length elements will\n     *         be returned.\n     *\n     */\n    first(n = 1) {\n        if (n < 1) {\n            throw `You must query with a positive nonzero integer. Please use a\n               different value for n.`;\n        }\n        if (this.trials.length === 0)\n            return new DataCollection();\n        if (n > this.trials.length)\n            n = this.trials.length;\n        return new DataCollection(this.trials.slice(0, n));\n    }\n    /**\n     * Queries the last n elements in a collection of trials.\n     *\n     * @param n A positive integer of elements to return. A value of\n     *          n that is less than 1 will throw an error.\n     *\n     * @return Last n objects of a collection of trials. If fewer than\n     *         n trials are available, the trials.length elements will\n     *         be returned.\n     *\n     */\n    last(n = 1) {\n        if (n < 1) {\n            throw `You must query with a positive nonzero integer. Please use a\n               different value for n.`;\n        }\n        if (this.trials.length === 0)\n            return new DataCollection();\n        if (n > this.trials.length)\n            n = this.trials.length;\n        return new DataCollection(this.trials.slice(this.trials.length - n, this.trials.length));\n    }\n    values() {\n        return this.trials;\n    }\n    count() {\n        return this.trials.length;\n    }\n    readOnly() {\n        return new DataCollection(deepCopy(this.trials));\n    }\n    addToAll(properties) {\n        for (const trial of this.trials) {\n            Object.assign(trial, properties);\n        }\n        return this;\n    }\n    addToLast(properties) {\n        if (this.trials.length != 0) {\n            Object.assign(this.trials[this.trials.length - 1], properties);\n        }\n        return this;\n    }\n    filter(filters) {\n        // [{p1: v1, p2:v2}, {p1:v2}]\n        // {p1: v1}\n        let f;\n        if (!Array.isArray(filters)) {\n            f = deepCopy([filters]);\n        }\n        else {\n            f = deepCopy(filters);\n        }\n        const filtered_data = [];\n        for (const trial of this.trials) {\n            let keep = false;\n            for (const filter of f) {\n                let match = true;\n                for (const key of Object.keys(filter)) {\n                    if (typeof trial[key] !== \"undefined\" && trial[key] === filter[key]) ;\n                    else {\n                        match = false;\n                    }\n                }\n                if (match) {\n                    keep = true;\n                    break;\n                } // can break because each filter is OR.\n            }\n            if (keep) {\n                filtered_data.push(trial);\n            }\n        }\n        return new DataCollection(filtered_data);\n    }\n    filterCustom(fn) {\n        return new DataCollection(this.trials.filter(fn));\n    }\n    filterColumns(columns) {\n        return new DataCollection(this.trials.map((trial) => Object.fromEntries(columns.filter((key) => key in trial).map((key) => [key, trial[key]]))));\n    }\n    select(column) {\n        const values = [];\n        for (const trial of this.trials) {\n            if (typeof trial[column] !== \"undefined\") {\n                values.push(trial[column]);\n            }\n        }\n        return new DataColumn(values);\n    }\n    ignore(columns) {\n        if (!Array.isArray(columns)) {\n            columns = [columns];\n        }\n        const o = deepCopy(this.trials);\n        for (const trial of o) {\n            for (const delete_key of columns) {\n                delete trial[delete_key];\n            }\n        }\n        return new DataCollection(o);\n    }\n    uniqueNames() {\n        const names = [];\n        for (const trial of this.trials) {\n            for (const key of Object.keys(trial)) {\n                if (!names.includes(key)) {\n                    names.push(key);\n                }\n            }\n        }\n        return names;\n    }\n    csv() {\n        return JSON2CSV(this.trials);\n    }\n    json(pretty = false) {\n        if (pretty) {\n            return JSON.stringify(this.trials, null, \"\\t\");\n        }\n        return JSON.stringify(this.trials);\n    }\n    localSave(format, filename) {\n        format = format.toLowerCase();\n        let data_string;\n        if (format === \"json\") {\n            data_string = this.json();\n        }\n        else if (format === \"csv\") {\n            data_string = this.csv();\n        }\n        else {\n            throw new Error('Invalid format specified for localSave. Must be \"json\" or \"csv\".');\n        }\n        saveTextToFile(data_string, filename);\n    }\n}\n\nclass JsPsychData {\n    constructor(jsPsych) {\n        this.jsPsych = jsPsych;\n        // data properties for all trials\n        this.dataProperties = {};\n        this.reset();\n    }\n    reset() {\n        this.allData = new DataCollection();\n        this.interactionData = new DataCollection();\n    }\n    get() {\n        return this.allData;\n    }\n    getInteractionData() {\n        return this.interactionData;\n    }\n    write(data_object) {\n        const progress = this.jsPsych.getProgress();\n        const trial = this.jsPsych.getCurrentTrial();\n        //var trial_opt_data = typeof trial.data == 'function' ? trial.data() : trial.data;\n        const default_data = {\n            trial_type: trial.type.info.name,\n            trial_index: progress.current_trial_global,\n            time_elapsed: this.jsPsych.getTotalTime(),\n            internal_node_id: this.jsPsych.getCurrentTimelineNodeID(),\n        };\n        this.allData.push(Object.assign(Object.assign(Object.assign(Object.assign({}, data_object), trial.data), default_data), this.dataProperties));\n    }\n    addProperties(properties) {\n        // first, add the properties to all data that's already stored\n        this.allData.addToAll(properties);\n        // now add to list so that it gets appended to all future data\n        this.dataProperties = Object.assign({}, this.dataProperties, properties);\n    }\n    addDataToLastTrial(data) {\n        this.allData.addToLast(data);\n    }\n    getDataByTimelineNode(node_id) {\n        return this.allData.filterCustom((x) => x.internal_node_id.slice(0, node_id.length) === node_id);\n    }\n    getLastTrialData() {\n        return this.allData.top();\n    }\n    getLastTimelineData() {\n        const lasttrial = this.getLastTrialData();\n        const node_id = lasttrial.select(\"internal_node_id\").values[0];\n        if (typeof node_id === \"undefined\") {\n            return new DataCollection();\n        }\n        else {\n            const parent_node_id = node_id.substr(0, node_id.lastIndexOf(\"-\"));\n            const lastnodedata = this.getDataByTimelineNode(parent_node_id);\n            return lastnodedata;\n        }\n    }\n    displayData(format = \"json\") {\n        format = format.toLowerCase();\n        if (format != \"json\" && format != \"csv\") {\n            console.log(\"Invalid format declared for displayData function. Using json as default.\");\n            format = \"json\";\n        }\n        const data_string = format === \"json\" ? this.allData.json(true) : this.allData.csv();\n        const display_element = this.jsPsych.getDisplayElement();\n        display_element.innerHTML = '<pre id=\"jspsych-data-display\"></pre>';\n        document.getElementById(\"jspsych-data-display\").textContent = data_string;\n    }\n    urlVariables() {\n        if (typeof this.query_string == \"undefined\") {\n            this.query_string = getQueryString();\n        }\n        return this.query_string;\n    }\n    getURLVariable(whichvar) {\n        return this.urlVariables()[whichvar];\n    }\n    createInteractionListeners() {\n        // blur event capture\n        window.addEventListener(\"blur\", () => {\n            const data = {\n                event: \"blur\",\n                trial: this.jsPsych.getProgress().current_trial_global,\n                time: this.jsPsych.getTotalTime(),\n            };\n            this.interactionData.push(data);\n            this.jsPsych.getInitSettings().on_interaction_data_update(data);\n        });\n        // focus event capture\n        window.addEventListener(\"focus\", () => {\n            const data = {\n                event: \"focus\",\n                trial: this.jsPsych.getProgress().current_trial_global,\n                time: this.jsPsych.getTotalTime(),\n            };\n            this.interactionData.push(data);\n            this.jsPsych.getInitSettings().on_interaction_data_update(data);\n        });\n        // fullscreen change capture\n        const fullscreenchange = () => {\n            const data = {\n                event: \n                // @ts-expect-error\n                document.isFullScreen ||\n                    // @ts-expect-error\n                    document.webkitIsFullScreen ||\n                    // @ts-expect-error\n                    document.mozIsFullScreen ||\n                    document.fullscreenElement\n                    ? \"fullscreenenter\"\n                    : \"fullscreenexit\",\n                trial: this.jsPsych.getProgress().current_trial_global,\n                time: this.jsPsych.getTotalTime(),\n            };\n            this.interactionData.push(data);\n            this.jsPsych.getInitSettings().on_interaction_data_update(data);\n        };\n        document.addEventListener(\"fullscreenchange\", fullscreenchange);\n        document.addEventListener(\"mozfullscreenchange\", fullscreenchange);\n        document.addEventListener(\"webkitfullscreenchange\", fullscreenchange);\n    }\n    // public methods for testing purposes. not recommended for use.\n    _customInsert(data) {\n        this.allData = new DataCollection(data);\n    }\n    _fullreset() {\n        this.reset();\n        this.dataProperties = {};\n    }\n}\n\nclass HardwareAPI {\n    constructor() {\n        /**\n         * Indicates whether this instance of jspsych has opened a hardware connection through our browser\n         * extension\n         **/\n        this.hardwareConnected = false;\n        //it might be useful to open up a line of communication from the extension back to this page\n        //script, again, this will have to pass through DOM events. For now speed is of no concern so I\n        //will use jQuery\n        document.addEventListener(\"jspsych-activate\", (evt) => {\n            this.hardwareConnected = true;\n        });\n    }\n    /**\n     * Allows communication with user hardware through our custom Google Chrome extension + native C++ program\n     * @param\t\tmess\tThe message to be passed to our extension, see its documentation for the expected members of this object.\n     * @author\tDaniel Rivas\n     *\n     */\n    hardware(mess) {\n        //since Chrome extension content-scripts do not share the javascript environment with the page\n        //script that loaded jspsych, we will need to use hacky methods like communicating through DOM\n        //events.\n        const jspsychEvt = new CustomEvent(\"jspsych\", { detail: mess });\n        document.dispatchEvent(jspsychEvt);\n        //And voila! it will be the job of the content script injected by the extension to listen for\n        //the event and do the appropriate actions.\n    }\n}\n\nclass KeyboardListenerAPI {\n    constructor(getRootElement, areResponsesCaseSensitive = false, minimumValidRt = 0) {\n        this.getRootElement = getRootElement;\n        this.areResponsesCaseSensitive = areResponsesCaseSensitive;\n        this.minimumValidRt = minimumValidRt;\n        this.listeners = new Set();\n        this.heldKeys = new Set();\n        this.areRootListenersRegistered = false;\n        autoBind$1(this);\n        this.registerRootListeners();\n    }\n    /**\n     * If not previously done and `this.getRootElement()` returns an element, adds the root key\n     * listeners to that element.\n     */\n    registerRootListeners() {\n        if (!this.areRootListenersRegistered) {\n            const rootElement = this.getRootElement();\n            if (rootElement) {\n                rootElement.addEventListener(\"keydown\", this.rootKeydownListener);\n                rootElement.addEventListener(\"keyup\", this.rootKeyupListener);\n                this.areRootListenersRegistered = true;\n            }\n        }\n    }\n    rootKeydownListener(e) {\n        // Iterate over a static copy of the listeners set because listeners might add other listeners\n        // that we do not want to be included in the loop\n        for (const listener of Array.from(this.listeners)) {\n            listener(e);\n        }\n        this.heldKeys.add(this.toLowerCaseIfInsensitive(e.key));\n    }\n    toLowerCaseIfInsensitive(string) {\n        return this.areResponsesCaseSensitive ? string : string.toLowerCase();\n    }\n    rootKeyupListener(e) {\n        this.heldKeys.delete(this.toLowerCaseIfInsensitive(e.key));\n    }\n    isResponseValid(validResponses, allowHeldKey, key) {\n        // check if key was already held down\n        if (!allowHeldKey && this.heldKeys.has(key)) {\n            return false;\n        }\n        if (validResponses === \"ALL_KEYS\") {\n            return true;\n        }\n        if (validResponses === \"NO_KEYS\") {\n            return false;\n        }\n        return validResponses.includes(key);\n    }\n    getKeyboardResponse({ callback_function, valid_responses = \"ALL_KEYS\", rt_method = \"performance\", persist, audio_context, audio_context_start_time, allow_held_key = false, minimum_valid_rt = this.minimumValidRt, }) {\n        if (rt_method !== \"performance\" && rt_method !== \"audio\") {\n            console.log('Invalid RT method specified in getKeyboardResponse. Defaulting to \"performance\" method.');\n            rt_method = \"performance\";\n        }\n        const usePerformanceRt = rt_method === \"performance\";\n        const startTime = usePerformanceRt ? performance.now() : audio_context_start_time * 1000;\n        this.registerRootListeners();\n        if (!this.areResponsesCaseSensitive && typeof valid_responses !== \"string\") {\n            valid_responses = valid_responses.map((r) => r.toLowerCase());\n        }\n        const listener = (e) => {\n            const rt = Math.round((rt_method == \"performance\" ? performance.now() : audio_context.currentTime * 1000) -\n                startTime);\n            if (rt < minimum_valid_rt) {\n                return;\n            }\n            const key = this.toLowerCaseIfInsensitive(e.key);\n            if (this.isResponseValid(valid_responses, allow_held_key, key)) {\n                // if this is a valid response, then we don't want the key event to trigger other actions\n                // like scrolling via the spacebar.\n                e.preventDefault();\n                if (!persist) {\n                    // remove keyboard listener if it exists\n                    this.cancelKeyboardResponse(listener);\n                }\n                callback_function({ key, rt });\n            }\n        };\n        this.listeners.add(listener);\n        return listener;\n    }\n    cancelKeyboardResponse(listener) {\n        // remove the listener from the set of listeners if it is contained\n        this.listeners.delete(listener);\n    }\n    cancelAllKeyboardResponses() {\n        this.listeners.clear();\n    }\n    compareKeys(key1, key2) {\n        if ((typeof key1 !== \"string\" && key1 !== null) ||\n            (typeof key2 !== \"string\" && key2 !== null)) {\n            console.error(\"Error in jsPsych.pluginAPI.compareKeys: arguments must be key strings or null.\");\n            return undefined;\n        }\n        if (typeof key1 === \"string\" && typeof key2 === \"string\") {\n            // if both values are strings, then check whether or not letter case should be converted before comparing (case_sensitive_responses in initJsPsych)\n            return this.areResponsesCaseSensitive\n                ? key1 === key2\n                : key1.toLowerCase() === key2.toLowerCase();\n        }\n        return key1 === null && key2 === null;\n    }\n}\n\n/**\n * Parameter types for plugins\n */\nvar ParameterType;\n(function (ParameterType) {\n    ParameterType[ParameterType[\"BOOL\"] = 0] = \"BOOL\";\n    ParameterType[ParameterType[\"STRING\"] = 1] = \"STRING\";\n    ParameterType[ParameterType[\"INT\"] = 2] = \"INT\";\n    ParameterType[ParameterType[\"FLOAT\"] = 3] = \"FLOAT\";\n    ParameterType[ParameterType[\"FUNCTION\"] = 4] = \"FUNCTION\";\n    ParameterType[ParameterType[\"KEY\"] = 5] = \"KEY\";\n    ParameterType[ParameterType[\"KEYS\"] = 6] = \"KEYS\";\n    ParameterType[ParameterType[\"SELECT\"] = 7] = \"SELECT\";\n    ParameterType[ParameterType[\"HTML_STRING\"] = 8] = \"HTML_STRING\";\n    ParameterType[ParameterType[\"IMAGE\"] = 9] = \"IMAGE\";\n    ParameterType[ParameterType[\"AUDIO\"] = 10] = \"AUDIO\";\n    ParameterType[ParameterType[\"VIDEO\"] = 11] = \"VIDEO\";\n    ParameterType[ParameterType[\"OBJECT\"] = 12] = \"OBJECT\";\n    ParameterType[ParameterType[\"COMPLEX\"] = 13] = \"COMPLEX\";\n    ParameterType[ParameterType[\"TIMELINE\"] = 14] = \"TIMELINE\";\n})(ParameterType || (ParameterType = {}));\nconst universalPluginParameters = {\n    /**\n     * Data to add to this trial (key-value pairs)\n     */\n    data: {\n        type: ParameterType.OBJECT,\n        pretty_name: \"Data\",\n        default: {},\n    },\n    /**\n     * Function to execute when trial begins\n     */\n    on_start: {\n        type: ParameterType.FUNCTION,\n        pretty_name: \"On start\",\n        default: function () {\n            return;\n        },\n    },\n    /**\n     * Function to execute when trial is finished\n     */\n    on_finish: {\n        type: ParameterType.FUNCTION,\n        pretty_name: \"On finish\",\n        default: function () {\n            return;\n        },\n    },\n    /**\n     * Function to execute after the trial has loaded\n     */\n    on_load: {\n        type: ParameterType.FUNCTION,\n        pretty_name: \"On load\",\n        default: function () {\n            return;\n        },\n    },\n    /**\n     * Length of gap between the end of this trial and the start of the next trial\n     */\n    post_trial_gap: {\n        type: ParameterType.INT,\n        pretty_name: \"Post trial gap\",\n        default: null,\n    },\n    /**\n     * A list of CSS classes to add to the jsPsych display element for the duration of this trial\n     */\n    css_classes: {\n        type: ParameterType.STRING,\n        pretty_name: \"Custom CSS classes\",\n        default: null,\n    },\n    /**\n     * Options to control simulation mode for the trial.\n     */\n    simulation_options: {\n        type: ParameterType.COMPLEX,\n        default: null,\n    },\n};\n\nconst preloadParameterTypes = [\n    ParameterType.AUDIO,\n    ParameterType.IMAGE,\n    ParameterType.VIDEO,\n];\nclass MediaAPI {\n    constructor(useWebaudio, webaudioContext) {\n        this.useWebaudio = useWebaudio;\n        this.webaudioContext = webaudioContext;\n        // video //\n        this.video_buffers = {};\n        // audio //\n        this.context = null;\n        this.audio_buffers = [];\n        // preloading stimuli //\n        this.preload_requests = [];\n        this.img_cache = {};\n        this.preloadMap = new Map();\n        this.microphone_recorder = null;\n        this.camera_stream = null;\n        this.camera_recorder = null;\n    }\n    getVideoBuffer(videoID) {\n        if (videoID.startsWith(\"blob:\")) {\n            this.video_buffers[videoID] = videoID;\n        }\n        return this.video_buffers[videoID];\n    }\n    initAudio() {\n        this.context = this.useWebaudio ? this.webaudioContext : null;\n    }\n    audioContext() {\n        if (this.context !== null) {\n            if (this.context.state !== \"running\") {\n                this.context.resume();\n            }\n        }\n        return this.context;\n    }\n    getAudioBuffer(audioID) {\n        return new Promise((resolve, reject) => {\n            // check whether audio file already preloaded\n            if (typeof this.audio_buffers[audioID] == \"undefined\" ||\n                this.audio_buffers[audioID] == \"tmp\") {\n                // if audio is not already loaded, try to load it\n                this.preloadAudio([audioID], () => {\n                    resolve(this.audio_buffers[audioID]);\n                }, () => { }, (e) => {\n                    reject(e.error);\n                });\n            }\n            else {\n                // audio is already loaded\n                resolve(this.audio_buffers[audioID]);\n            }\n        });\n    }\n    preloadAudio(files, callback_complete = () => { }, callback_load = (filepath) => { }, callback_error = (error_msg) => { }) {\n        files = unique(files.flat());\n        let n_loaded = 0;\n        if (files.length == 0) {\n            callback_complete();\n            return;\n        }\n        const load_audio_file_webaudio = (source, count = 1) => {\n            const request = new XMLHttpRequest();\n            request.open(\"GET\", source, true);\n            request.responseType = \"arraybuffer\";\n            request.onload = () => {\n                this.context.decodeAudioData(request.response, (buffer) => {\n                    this.audio_buffers[source] = buffer;\n                    n_loaded++;\n                    callback_load(source);\n                    if (n_loaded == files.length) {\n                        callback_complete();\n                    }\n                }, (e) => {\n                    callback_error({ source: source, error: e });\n                });\n            };\n            request.onerror = (e) => {\n                let err = e;\n                if (request.status == 404) {\n                    err = \"404\";\n                }\n                callback_error({ source: source, error: err });\n            };\n            request.onloadend = (e) => {\n                if (request.status == 404) {\n                    callback_error({ source: source, error: \"404\" });\n                }\n            };\n            request.send();\n            this.preload_requests.push(request);\n        };\n        const load_audio_file_html5audio = (source, count = 1) => {\n            const audio = new Audio();\n            const handleCanPlayThrough = () => {\n                this.audio_buffers[source] = audio;\n                n_loaded++;\n                callback_load(source);\n                if (n_loaded == files.length) {\n                    callback_complete();\n                }\n                audio.removeEventListener(\"canplaythrough\", handleCanPlayThrough);\n            };\n            audio.addEventListener(\"canplaythrough\", handleCanPlayThrough);\n            audio.addEventListener(\"error\", function handleError(e) {\n                callback_error({ source: audio.src, error: e });\n                audio.removeEventListener(\"error\", handleError);\n            });\n            audio.addEventListener(\"abort\", function handleAbort(e) {\n                callback_error({ source: audio.src, error: e });\n                audio.removeEventListener(\"abort\", handleAbort);\n            });\n            audio.src = source;\n            this.preload_requests.push(audio);\n        };\n        for (const file of files) {\n            if (typeof this.audio_buffers[file] !== \"undefined\") {\n                n_loaded++;\n                callback_load(file);\n                if (n_loaded == files.length) {\n                    callback_complete();\n                }\n            }\n            else {\n                this.audio_buffers[file] = \"tmp\";\n                if (this.audioContext() !== null) {\n                    load_audio_file_webaudio(file);\n                }\n                else {\n                    load_audio_file_html5audio(file);\n                }\n            }\n        }\n    }\n    preloadImages(images, callback_complete = () => { }, callback_load = (filepath) => { }, callback_error = (error_msg) => { }) {\n        // flatten the images array\n        images = unique(images.flat());\n        var n_loaded = 0;\n        if (images.length === 0) {\n            callback_complete();\n            return;\n        }\n        for (let i = 0; i < images.length; i++) {\n            const img = new Image();\n            const src = images[i];\n            img.onload = () => {\n                n_loaded++;\n                callback_load(src);\n                if (n_loaded === images.length) {\n                    callback_complete();\n                }\n            };\n            img.onerror = (e) => {\n                callback_error({ source: src, error: e });\n            };\n            img.src = src;\n            this.img_cache[src] = img;\n            this.preload_requests.push(img);\n        }\n    }\n    preloadVideo(videos, callback_complete = () => { }, callback_load = (filepath) => { }, callback_error = (error_msg) => { }) {\n        // flatten the video array\n        videos = unique(videos.flat());\n        let n_loaded = 0;\n        if (videos.length === 0) {\n            callback_complete();\n            return;\n        }\n        for (const video of videos) {\n            const video_buffers = this.video_buffers;\n            //based on option 4 here: http://dinbror.dk/blog/how-to-preload-entire-html5-video-before-play-solved/\n            const request = new XMLHttpRequest();\n            request.open(\"GET\", video, true);\n            request.responseType = \"blob\";\n            request.onload = () => {\n                if (request.status === 200 || request.status === 0) {\n                    const videoBlob = request.response;\n                    video_buffers[video] = URL.createObjectURL(videoBlob); // IE10+\n                    n_loaded++;\n                    callback_load(video);\n                    if (n_loaded === videos.length) {\n                        callback_complete();\n                    }\n                }\n            };\n            request.onerror = (e) => {\n                let err = e;\n                if (request.status == 404) {\n                    err = \"404\";\n                }\n                callback_error({ source: video, error: err });\n            };\n            request.onloadend = (e) => {\n                if (request.status == 404) {\n                    callback_error({ source: video, error: \"404\" });\n                }\n            };\n            request.send();\n            this.preload_requests.push(request);\n        }\n    }\n    getAutoPreloadList(timeline_description) {\n        /** Map each preload parameter type to a set of paths to be preloaded */\n        const preloadPaths = Object.fromEntries(preloadParameterTypes.map((type) => [type, new Set()]));\n        const traverseTimeline = (node, inheritedTrialType) => {\n            var _a, _b, _c, _d;\n            const isTimeline = typeof node.timeline !== \"undefined\";\n            if (isTimeline) {\n                for (const childNode of node.timeline) {\n                    traverseTimeline(childNode, (_a = node.type) !== null && _a !== void 0 ? _a : inheritedTrialType);\n                }\n            }\n            else if ((_c = ((_b = node.type) !== null && _b !== void 0 ? _b : inheritedTrialType)) === null || _c === void 0 ? void 0 : _c.info) {\n                // node is a trial with type.info set\n                // Get the plugin name and parameters object from the info object\n                const { name: pluginName, parameters } = ((_d = node.type) !== null && _d !== void 0 ? _d : inheritedTrialType).info;\n                // Extract parameters to be preloaded and their types from parameter info if this has not\n                // yet been done for `pluginName`\n                if (!this.preloadMap.has(pluginName)) {\n                    this.preloadMap.set(pluginName, Object.fromEntries(Object.entries(parameters)\n                        // Filter out parameter entries with media types and a non-false `preload` option\n                        .filter(([_name, { type, preload }]) => preloadParameterTypes.includes(type) && (preload !== null && preload !== void 0 ? preload : true))\n                        // Map each entry's value to its parameter type\n                        .map(([name, { type }]) => [name, type])));\n                }\n                // Add preload paths from this trial\n                for (const [parameterName, parameterType] of Object.entries(this.preloadMap.get(pluginName))) {\n                    const parameterValue = node[parameterName];\n                    const elements = preloadPaths[parameterType];\n                    if (typeof parameterValue === \"string\") {\n                        elements.add(parameterValue);\n                    }\n                    else if (Array.isArray(parameterValue)) {\n                        for (const element of parameterValue.flat()) {\n                            if (typeof element === \"string\") {\n                                elements.add(element);\n                            }\n                        }\n                    }\n                }\n            }\n        };\n        traverseTimeline({ timeline: timeline_description });\n        return {\n            images: [...preloadPaths[ParameterType.IMAGE]],\n            audio: [...preloadPaths[ParameterType.AUDIO]],\n            video: [...preloadPaths[ParameterType.VIDEO]],\n        };\n    }\n    cancelPreloads() {\n        for (const request of this.preload_requests) {\n            request.onload = () => { };\n            request.onerror = () => { };\n            request.oncanplaythrough = () => { };\n            request.onabort = () => { };\n        }\n        this.preload_requests = [];\n    }\n    initializeMicrophoneRecorder(stream) {\n        const recorder = new MediaRecorder(stream);\n        this.microphone_recorder = recorder;\n    }\n    getMicrophoneRecorder() {\n        return this.microphone_recorder;\n    }\n    initializeCameraRecorder(stream, opts) {\n        this.camera_stream = stream;\n        const recorder = new MediaRecorder(stream, opts);\n        this.camera_recorder = recorder;\n    }\n    getCameraStream() {\n        return this.camera_stream;\n    }\n    getCameraRecorder() {\n        return this.camera_recorder;\n    }\n}\n\nclass SimulationAPI {\n    constructor(getDisplayContainerElement, setJsPsychTimeout) {\n        this.getDisplayContainerElement = getDisplayContainerElement;\n        this.setJsPsychTimeout = setJsPsychTimeout;\n    }\n    dispatchEvent(event) {\n        this.getDisplayContainerElement().dispatchEvent(event);\n    }\n    /**\n     * Dispatches a `keydown` event for the specified key\n     * @param key Character code (`.key` property) for the key to press.\n     */\n    keyDown(key) {\n        this.dispatchEvent(new KeyboardEvent(\"keydown\", { key }));\n    }\n    /**\n     * Dispatches a `keyup` event for the specified key\n     * @param key Character code (`.key` property) for the key to press.\n     */\n    keyUp(key) {\n        this.dispatchEvent(new KeyboardEvent(\"keyup\", { key }));\n    }\n    /**\n     * Dispatches a `keydown` and `keyup` event in sequence to simulate pressing a key.\n     * @param key Character code (`.key` property) for the key to press.\n     * @param delay Length of time to wait (ms) before executing action\n     */\n    pressKey(key, delay = 0) {\n        if (delay > 0) {\n            this.setJsPsychTimeout(() => {\n                this.keyDown(key);\n                this.keyUp(key);\n            }, delay);\n        }\n        else {\n            this.keyDown(key);\n            this.keyUp(key);\n        }\n    }\n    /**\n     * Dispatches `mousedown`, `mouseup`, and `click` events on the target element\n     * @param target The element to click\n     * @param delay Length of time to wait (ms) before executing action\n     */\n    clickTarget(target, delay = 0) {\n        if (delay > 0) {\n            this.setJsPsychTimeout(() => {\n                target.dispatchEvent(new MouseEvent(\"mousedown\", { bubbles: true }));\n                target.dispatchEvent(new MouseEvent(\"mouseup\", { bubbles: true }));\n                target.dispatchEvent(new MouseEvent(\"click\", { bubbles: true }));\n            }, delay);\n        }\n        else {\n            target.dispatchEvent(new MouseEvent(\"mousedown\", { bubbles: true }));\n            target.dispatchEvent(new MouseEvent(\"mouseup\", { bubbles: true }));\n            target.dispatchEvent(new MouseEvent(\"click\", { bubbles: true }));\n        }\n    }\n    /**\n     * Sets the value of a target text input\n     * @param target A text input element to fill in\n     * @param text Text to input\n     * @param delay Length of time to wait (ms) before executing action\n     */\n    fillTextInput(target, text, delay = 0) {\n        if (delay > 0) {\n            this.setJsPsychTimeout(() => {\n                target.value = text;\n            }, delay);\n        }\n        else {\n            target.value = text;\n        }\n    }\n    /**\n     * Picks a valid key from `choices`, taking into account jsPsych-specific\n     * identifiers like \"NO_KEYS\" and \"ALL_KEYS\".\n     * @param choices Which keys are valid.\n     * @returns A key selected at random from the valid keys.\n     */\n    getValidKey(choices) {\n        const possible_keys = [\n            \"a\",\n            \"b\",\n            \"c\",\n            \"d\",\n            \"e\",\n            \"f\",\n            \"g\",\n            \"h\",\n            \"i\",\n            \"j\",\n            \"k\",\n            \"l\",\n            \"m\",\n            \"n\",\n            \"o\",\n            \"p\",\n            \"q\",\n            \"r\",\n            \"s\",\n            \"t\",\n            \"u\",\n            \"v\",\n            \"w\",\n            \"x\",\n            \"y\",\n            \"z\",\n            \"0\",\n            \"1\",\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\",\n            \"6\",\n            \"7\",\n            \"8\",\n            \"9\",\n            \" \",\n        ];\n        let key;\n        if (choices == \"NO_KEYS\") {\n            key = null;\n        }\n        else if (choices == \"ALL_KEYS\") {\n            key = possible_keys[Math.floor(Math.random() * possible_keys.length)];\n        }\n        else {\n            const flat_choices = choices.flat();\n            key = flat_choices[Math.floor(Math.random() * flat_choices.length)];\n        }\n        return key;\n    }\n    mergeSimulationData(default_data, simulation_options) {\n        // override any data with data from simulation object\n        return Object.assign(Object.assign({}, default_data), simulation_options === null || simulation_options === void 0 ? void 0 : simulation_options.data);\n    }\n    ensureSimulationDataConsistency(trial, data) {\n        // All RTs must be rounded\n        if (data.rt) {\n            data.rt = Math.round(data.rt);\n        }\n        // If a trial_duration and rt exist, make sure that the RT is not longer than the trial.\n        if (trial.trial_duration && data.rt && data.rt > trial.trial_duration) {\n            data.rt = null;\n            if (data.response) {\n                data.response = null;\n            }\n            if (data.correct) {\n                data.correct = false;\n            }\n        }\n        // If trial.choices is NO_KEYS make sure that response and RT are null\n        if (trial.choices && trial.choices == \"NO_KEYS\") {\n            if (data.rt) {\n                data.rt = null;\n            }\n            if (data.response) {\n                data.response = null;\n            }\n        }\n        // If response is not allowed before stimulus display complete, ensure RT\n        // is longer than display time.\n        if (trial.allow_response_before_complete) {\n            if (trial.sequence_reps && trial.frame_time) {\n                const min_time = trial.sequence_reps * trial.frame_time * trial.stimuli.length;\n                if (data.rt < min_time) {\n                    data.rt = null;\n                    data.response = null;\n                }\n            }\n        }\n    }\n}\n\n/**\n * A class that provides a wrapper around the global setTimeout and clearTimeout functions.\n */\nclass TimeoutAPI {\n    constructor() {\n        this.timeout_handlers = [];\n    }\n    /**\n     * Calls a function after a specified delay, in milliseconds.\n     * @param callback The function to call after the delay.\n     * @param delay The number of milliseconds to wait before calling the function.\n     * @returns A handle that can be used to clear the timeout with clearTimeout.\n     */\n    setTimeout(callback, delay) {\n        const handle = window.setTimeout(callback, delay);\n        this.timeout_handlers.push(handle);\n        return handle;\n    }\n    /**\n     * Clears all timeouts that have been created with setTimeout.\n     */\n    clearAllTimeouts() {\n        for (const handler of this.timeout_handlers) {\n            clearTimeout(handler);\n        }\n        this.timeout_handlers = [];\n    }\n}\n\nfunction createJointPluginAPIObject(jsPsych) {\n    const settings = jsPsych.getInitSettings();\n    const keyboardListenerAPI = autoBind$1(new KeyboardListenerAPI(jsPsych.getDisplayContainerElement, settings.case_sensitive_responses, settings.minimum_valid_rt));\n    const timeoutAPI = autoBind$1(new TimeoutAPI());\n    const mediaAPI = autoBind$1(new MediaAPI(settings.use_webaudio, jsPsych.webaudio_context));\n    const hardwareAPI = autoBind$1(new HardwareAPI());\n    const simulationAPI = autoBind$1(new SimulationAPI(jsPsych.getDisplayContainerElement, timeoutAPI.setTimeout));\n    return Object.assign({}, ...[keyboardListenerAPI, timeoutAPI, mediaAPI, hardwareAPI, simulationAPI]);\n}\n\nvar alea$1 = {exports: {}};\n\nalea$1.exports;\n\n(function (module) {\n\t// A port of an algorithm by Johannes Baagøe <baagoe@baagoe.com>, 2010\n\t// http://baagoe.com/en/RandomMusings/javascript/\n\t// https://github.com/nquinlan/better-random-numbers-for-javascript-mirror\n\t// Original work is under MIT license -\n\n\t// Copyright (C) 2010 by Johannes Baagøe <baagoe@baagoe.org>\n\t//\n\t// Permission is hereby granted, free of charge, to any person obtaining a copy\n\t// of this software and associated documentation files (the \"Software\"), to deal\n\t// in the Software without restriction, including without limitation the rights\n\t// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n\t// copies of the Software, and to permit persons to whom the Software is\n\t// furnished to do so, subject to the following conditions:\n\t//\n\t// The above copyright notice and this permission notice shall be included in\n\t// all copies or substantial portions of the Software.\n\t//\n\t// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n\t// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n\t// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n\t// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n\t// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n\t// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n\t// THE SOFTWARE.\n\n\n\n\t(function(global, module, define) {\n\n\tfunction Alea(seed) {\n\t  var me = this, mash = Mash();\n\n\t  me.next = function() {\n\t    var t = 2091639 * me.s0 + me.c * 2.3283064365386963e-10; // 2^-32\n\t    me.s0 = me.s1;\n\t    me.s1 = me.s2;\n\t    return me.s2 = t - (me.c = t | 0);\n\t  };\n\n\t  // Apply the seeding algorithm from Baagoe.\n\t  me.c = 1;\n\t  me.s0 = mash(' ');\n\t  me.s1 = mash(' ');\n\t  me.s2 = mash(' ');\n\t  me.s0 -= mash(seed);\n\t  if (me.s0 < 0) { me.s0 += 1; }\n\t  me.s1 -= mash(seed);\n\t  if (me.s1 < 0) { me.s1 += 1; }\n\t  me.s2 -= mash(seed);\n\t  if (me.s2 < 0) { me.s2 += 1; }\n\t  mash = null;\n\t}\n\n\tfunction copy(f, t) {\n\t  t.c = f.c;\n\t  t.s0 = f.s0;\n\t  t.s1 = f.s1;\n\t  t.s2 = f.s2;\n\t  return t;\n\t}\n\n\tfunction impl(seed, opts) {\n\t  var xg = new Alea(seed),\n\t      state = opts && opts.state,\n\t      prng = xg.next;\n\t  prng.int32 = function() { return (xg.next() * 0x100000000) | 0; };\n\t  prng.double = function() {\n\t    return prng() + (prng() * 0x200000 | 0) * 1.1102230246251565e-16; // 2^-53\n\t  };\n\t  prng.quick = prng;\n\t  if (state) {\n\t    if (typeof(state) == 'object') copy(state, xg);\n\t    prng.state = function() { return copy(xg, {}); };\n\t  }\n\t  return prng;\n\t}\n\n\tfunction Mash() {\n\t  var n = 0xefc8249d;\n\n\t  var mash = function(data) {\n\t    data = String(data);\n\t    for (var i = 0; i < data.length; i++) {\n\t      n += data.charCodeAt(i);\n\t      var h = 0.02519603282416938 * n;\n\t      n = h >>> 0;\n\t      h -= n;\n\t      h *= n;\n\t      n = h >>> 0;\n\t      h -= n;\n\t      n += h * 0x100000000; // 2^32\n\t    }\n\t    return (n >>> 0) * 2.3283064365386963e-10; // 2^-32\n\t  };\n\n\t  return mash;\n\t}\n\n\n\tif (module && module.exports) {\n\t  module.exports = impl;\n\t} else if (define && define.amd) {\n\t  define(function() { return impl; });\n\t} else {\n\t  this.alea = impl;\n\t}\n\n\t})(\n\t  commonjsGlobal,\n\t  module,    // present in node.js\n\t  (typeof undefined) == 'function'    // present with an AMD loader\n\t); \n} (alea$1));\n\nvar aleaExports = alea$1.exports;\nvar seedrandom$3 = /*@__PURE__*/getDefaultExportFromCjs(aleaExports);\n\nvar xor128$1 = {exports: {}};\n\nxor128$1.exports;\n\n(function (module) {\n\t// A Javascript implementaion of the \"xor128\" prng algorithm by\n\t// George Marsaglia.  See http://www.jstatsoft.org/v08/i14/paper\n\n\t(function(global, module, define) {\n\n\tfunction XorGen(seed) {\n\t  var me = this, strseed = '';\n\n\t  me.x = 0;\n\t  me.y = 0;\n\t  me.z = 0;\n\t  me.w = 0;\n\n\t  // Set up generator function.\n\t  me.next = function() {\n\t    var t = me.x ^ (me.x << 11);\n\t    me.x = me.y;\n\t    me.y = me.z;\n\t    me.z = me.w;\n\t    return me.w ^= (me.w >>> 19) ^ t ^ (t >>> 8);\n\t  };\n\n\t  if (seed === (seed | 0)) {\n\t    // Integer seed.\n\t    me.x = seed;\n\t  } else {\n\t    // String seed.\n\t    strseed += seed;\n\t  }\n\n\t  // Mix in string seed, then discard an initial batch of 64 values.\n\t  for (var k = 0; k < strseed.length + 64; k++) {\n\t    me.x ^= strseed.charCodeAt(k) | 0;\n\t    me.next();\n\t  }\n\t}\n\n\tfunction copy(f, t) {\n\t  t.x = f.x;\n\t  t.y = f.y;\n\t  t.z = f.z;\n\t  t.w = f.w;\n\t  return t;\n\t}\n\n\tfunction impl(seed, opts) {\n\t  var xg = new XorGen(seed),\n\t      state = opts && opts.state,\n\t      prng = function() { return (xg.next() >>> 0) / 0x100000000; };\n\t  prng.double = function() {\n\t    do {\n\t      var top = xg.next() >>> 11,\n\t          bot = (xg.next() >>> 0) / 0x100000000,\n\t          result = (top + bot) / (1 << 21);\n\t    } while (result === 0);\n\t    return result;\n\t  };\n\t  prng.int32 = xg.next;\n\t  prng.quick = prng;\n\t  if (state) {\n\t    if (typeof(state) == 'object') copy(state, xg);\n\t    prng.state = function() { return copy(xg, {}); };\n\t  }\n\t  return prng;\n\t}\n\n\tif (module && module.exports) {\n\t  module.exports = impl;\n\t} else if (define && define.amd) {\n\t  define(function() { return impl; });\n\t} else {\n\t  this.xor128 = impl;\n\t}\n\n\t})(\n\t  commonjsGlobal,\n\t  module,    // present in node.js\n\t  (typeof undefined) == 'function'    // present with an AMD loader\n\t); \n} (xor128$1));\n\nvar xor128Exports = xor128$1.exports;\n\nvar xorwow$1 = {exports: {}};\n\nxorwow$1.exports;\n\n(function (module) {\n\t// A Javascript implementaion of the \"xorwow\" prng algorithm by\n\t// George Marsaglia.  See http://www.jstatsoft.org/v08/i14/paper\n\n\t(function(global, module, define) {\n\n\tfunction XorGen(seed) {\n\t  var me = this, strseed = '';\n\n\t  // Set up generator function.\n\t  me.next = function() {\n\t    var t = (me.x ^ (me.x >>> 2));\n\t    me.x = me.y; me.y = me.z; me.z = me.w; me.w = me.v;\n\t    return (me.d = (me.d + 362437 | 0)) +\n\t       (me.v = (me.v ^ (me.v << 4)) ^ (t ^ (t << 1))) | 0;\n\t  };\n\n\t  me.x = 0;\n\t  me.y = 0;\n\t  me.z = 0;\n\t  me.w = 0;\n\t  me.v = 0;\n\n\t  if (seed === (seed | 0)) {\n\t    // Integer seed.\n\t    me.x = seed;\n\t  } else {\n\t    // String seed.\n\t    strseed += seed;\n\t  }\n\n\t  // Mix in string seed, then discard an initial batch of 64 values.\n\t  for (var k = 0; k < strseed.length + 64; k++) {\n\t    me.x ^= strseed.charCodeAt(k) | 0;\n\t    if (k == strseed.length) {\n\t      me.d = me.x << 10 ^ me.x >>> 4;\n\t    }\n\t    me.next();\n\t  }\n\t}\n\n\tfunction copy(f, t) {\n\t  t.x = f.x;\n\t  t.y = f.y;\n\t  t.z = f.z;\n\t  t.w = f.w;\n\t  t.v = f.v;\n\t  t.d = f.d;\n\t  return t;\n\t}\n\n\tfunction impl(seed, opts) {\n\t  var xg = new XorGen(seed),\n\t      state = opts && opts.state,\n\t      prng = function() { return (xg.next() >>> 0) / 0x100000000; };\n\t  prng.double = function() {\n\t    do {\n\t      var top = xg.next() >>> 11,\n\t          bot = (xg.next() >>> 0) / 0x100000000,\n\t          result = (top + bot) / (1 << 21);\n\t    } while (result === 0);\n\t    return result;\n\t  };\n\t  prng.int32 = xg.next;\n\t  prng.quick = prng;\n\t  if (state) {\n\t    if (typeof(state) == 'object') copy(state, xg);\n\t    prng.state = function() { return copy(xg, {}); };\n\t  }\n\t  return prng;\n\t}\n\n\tif (module && module.exports) {\n\t  module.exports = impl;\n\t} else if (define && define.amd) {\n\t  define(function() { return impl; });\n\t} else {\n\t  this.xorwow = impl;\n\t}\n\n\t})(\n\t  commonjsGlobal,\n\t  module,    // present in node.js\n\t  (typeof undefined) == 'function'    // present with an AMD loader\n\t); \n} (xorwow$1));\n\nvar xorwowExports = xorwow$1.exports;\n\nvar xorshift7$1 = {exports: {}};\n\nxorshift7$1.exports;\n\n(function (module) {\n\t// A Javascript implementaion of the \"xorshift7\" algorithm by\n\t// François Panneton and Pierre L'ecuyer:\n\t// \"On the Xorgshift Random Number Generators\"\n\t// http://saluc.engr.uconn.edu/refs/crypto/rng/panneton05onthexorshift.pdf\n\n\t(function(global, module, define) {\n\n\tfunction XorGen(seed) {\n\t  var me = this;\n\n\t  // Set up generator function.\n\t  me.next = function() {\n\t    // Update xor generator.\n\t    var X = me.x, i = me.i, t, v;\n\t    t = X[i]; t ^= (t >>> 7); v = t ^ (t << 24);\n\t    t = X[(i + 1) & 7]; v ^= t ^ (t >>> 10);\n\t    t = X[(i + 3) & 7]; v ^= t ^ (t >>> 3);\n\t    t = X[(i + 4) & 7]; v ^= t ^ (t << 7);\n\t    t = X[(i + 7) & 7]; t = t ^ (t << 13); v ^= t ^ (t << 9);\n\t    X[i] = v;\n\t    me.i = (i + 1) & 7;\n\t    return v;\n\t  };\n\n\t  function init(me, seed) {\n\t    var j, X = [];\n\n\t    if (seed === (seed | 0)) {\n\t      // Seed state array using a 32-bit integer.\n\t      X[0] = seed;\n\t    } else {\n\t      // Seed state using a string.\n\t      seed = '' + seed;\n\t      for (j = 0; j < seed.length; ++j) {\n\t        X[j & 7] = (X[j & 7] << 15) ^\n\t            (seed.charCodeAt(j) + X[(j + 1) & 7] << 13);\n\t      }\n\t    }\n\t    // Enforce an array length of 8, not all zeroes.\n\t    while (X.length < 8) X.push(0);\n\t    for (j = 0; j < 8 && X[j] === 0; ++j);\n\t    if (j == 8) X[7] = -1; else X[j];\n\n\t    me.x = X;\n\t    me.i = 0;\n\n\t    // Discard an initial 256 values.\n\t    for (j = 256; j > 0; --j) {\n\t      me.next();\n\t    }\n\t  }\n\n\t  init(me, seed);\n\t}\n\n\tfunction copy(f, t) {\n\t  t.x = f.x.slice();\n\t  t.i = f.i;\n\t  return t;\n\t}\n\n\tfunction impl(seed, opts) {\n\t  if (seed == null) seed = +(new Date);\n\t  var xg = new XorGen(seed),\n\t      state = opts && opts.state,\n\t      prng = function() { return (xg.next() >>> 0) / 0x100000000; };\n\t  prng.double = function() {\n\t    do {\n\t      var top = xg.next() >>> 11,\n\t          bot = (xg.next() >>> 0) / 0x100000000,\n\t          result = (top + bot) / (1 << 21);\n\t    } while (result === 0);\n\t    return result;\n\t  };\n\t  prng.int32 = xg.next;\n\t  prng.quick = prng;\n\t  if (state) {\n\t    if (state.x) copy(state, xg);\n\t    prng.state = function() { return copy(xg, {}); };\n\t  }\n\t  return prng;\n\t}\n\n\tif (module && module.exports) {\n\t  module.exports = impl;\n\t} else if (define && define.amd) {\n\t  define(function() { return impl; });\n\t} else {\n\t  this.xorshift7 = impl;\n\t}\n\n\t})(\n\t  commonjsGlobal,\n\t  module,    // present in node.js\n\t  (typeof undefined) == 'function'    // present with an AMD loader\n\t); \n} (xorshift7$1));\n\nvar xorshift7Exports = xorshift7$1.exports;\n\nvar xor4096$1 = {exports: {}};\n\nxor4096$1.exports;\n\n(function (module) {\n\t// A Javascript implementaion of Richard Brent's Xorgens xor4096 algorithm.\n\t//\n\t// This fast non-cryptographic random number generator is designed for\n\t// use in Monte-Carlo algorithms. It combines a long-period xorshift\n\t// generator with a Weyl generator, and it passes all common batteries\n\t// of stasticial tests for randomness while consuming only a few nanoseconds\n\t// for each prng generated.  For background on the generator, see Brent's\n\t// paper: \"Some long-period random number generators using shifts and xors.\"\n\t// http://arxiv.org/pdf/1004.3115v1.pdf\n\t//\n\t// Usage:\n\t//\n\t// var xor4096 = require('xor4096');\n\t// random = xor4096(1);                        // Seed with int32 or string.\n\t// assert.equal(random(), 0.1520436450538547); // (0, 1) range, 53 bits.\n\t// assert.equal(random.int32(), 1806534897);   // signed int32, 32 bits.\n\t//\n\t// For nonzero numeric keys, this impelementation provides a sequence\n\t// identical to that by Brent's xorgens 3 implementaion in C.  This\n\t// implementation also provides for initalizing the generator with\n\t// string seeds, or for saving and restoring the state of the generator.\n\t//\n\t// On Chrome, this prng benchmarks about 2.1 times slower than\n\t// Javascript's built-in Math.random().\n\n\t(function(global, module, define) {\n\n\tfunction XorGen(seed) {\n\t  var me = this;\n\n\t  // Set up generator function.\n\t  me.next = function() {\n\t    var w = me.w,\n\t        X = me.X, i = me.i, t, v;\n\t    // Update Weyl generator.\n\t    me.w = w = (w + 0x61c88647) | 0;\n\t    // Update xor generator.\n\t    v = X[(i + 34) & 127];\n\t    t = X[i = ((i + 1) & 127)];\n\t    v ^= v << 13;\n\t    t ^= t << 17;\n\t    v ^= v >>> 15;\n\t    t ^= t >>> 12;\n\t    // Update Xor generator array state.\n\t    v = X[i] = v ^ t;\n\t    me.i = i;\n\t    // Result is the combination.\n\t    return (v + (w ^ (w >>> 16))) | 0;\n\t  };\n\n\t  function init(me, seed) {\n\t    var t, v, i, j, w, X = [], limit = 128;\n\t    if (seed === (seed | 0)) {\n\t      // Numeric seeds initialize v, which is used to generates X.\n\t      v = seed;\n\t      seed = null;\n\t    } else {\n\t      // String seeds are mixed into v and X one character at a time.\n\t      seed = seed + '\\0';\n\t      v = 0;\n\t      limit = Math.max(limit, seed.length);\n\t    }\n\t    // Initialize circular array and weyl value.\n\t    for (i = 0, j = -32; j < limit; ++j) {\n\t      // Put the unicode characters into the array, and shuffle them.\n\t      if (seed) v ^= seed.charCodeAt((j + 32) % seed.length);\n\t      // After 32 shuffles, take v as the starting w value.\n\t      if (j === 0) w = v;\n\t      v ^= v << 10;\n\t      v ^= v >>> 15;\n\t      v ^= v << 4;\n\t      v ^= v >>> 13;\n\t      if (j >= 0) {\n\t        w = (w + 0x61c88647) | 0;     // Weyl.\n\t        t = (X[j & 127] ^= (v + w));  // Combine xor and weyl to init array.\n\t        i = (0 == t) ? i + 1 : 0;     // Count zeroes.\n\t      }\n\t    }\n\t    // We have detected all zeroes; make the key nonzero.\n\t    if (i >= 128) {\n\t      X[(seed && seed.length || 0) & 127] = -1;\n\t    }\n\t    // Run the generator 512 times to further mix the state before using it.\n\t    // Factoring this as a function slows the main generator, so it is just\n\t    // unrolled here.  The weyl generator is not advanced while warming up.\n\t    i = 127;\n\t    for (j = 4 * 128; j > 0; --j) {\n\t      v = X[(i + 34) & 127];\n\t      t = X[i = ((i + 1) & 127)];\n\t      v ^= v << 13;\n\t      t ^= t << 17;\n\t      v ^= v >>> 15;\n\t      t ^= t >>> 12;\n\t      X[i] = v ^ t;\n\t    }\n\t    // Storing state as object members is faster than using closure variables.\n\t    me.w = w;\n\t    me.X = X;\n\t    me.i = i;\n\t  }\n\n\t  init(me, seed);\n\t}\n\n\tfunction copy(f, t) {\n\t  t.i = f.i;\n\t  t.w = f.w;\n\t  t.X = f.X.slice();\n\t  return t;\n\t}\n\tfunction impl(seed, opts) {\n\t  if (seed == null) seed = +(new Date);\n\t  var xg = new XorGen(seed),\n\t      state = opts && opts.state,\n\t      prng = function() { return (xg.next() >>> 0) / 0x100000000; };\n\t  prng.double = function() {\n\t    do {\n\t      var top = xg.next() >>> 11,\n\t          bot = (xg.next() >>> 0) / 0x100000000,\n\t          result = (top + bot) / (1 << 21);\n\t    } while (result === 0);\n\t    return result;\n\t  };\n\t  prng.int32 = xg.next;\n\t  prng.quick = prng;\n\t  if (state) {\n\t    if (state.X) copy(state, xg);\n\t    prng.state = function() { return copy(xg, {}); };\n\t  }\n\t  return prng;\n\t}\n\n\tif (module && module.exports) {\n\t  module.exports = impl;\n\t} else if (define && define.amd) {\n\t  define(function() { return impl; });\n\t} else {\n\t  this.xor4096 = impl;\n\t}\n\n\t})(\n\t  commonjsGlobal,                                     // window object or global\n\t  module,    // present in node.js\n\t  (typeof undefined) == 'function'    // present with an AMD loader\n\t); \n} (xor4096$1));\n\nvar xor4096Exports = xor4096$1.exports;\n\nvar tychei$1 = {exports: {}};\n\ntychei$1.exports;\n\n(function (module) {\n\t// A Javascript implementaion of the \"Tyche-i\" prng algorithm by\n\t// Samuel Neves and Filipe Araujo.\n\t// See https://eden.dei.uc.pt/~sneves/pubs/2011-snfa2.pdf\n\n\t(function(global, module, define) {\n\n\tfunction XorGen(seed) {\n\t  var me = this, strseed = '';\n\n\t  // Set up generator function.\n\t  me.next = function() {\n\t    var b = me.b, c = me.c, d = me.d, a = me.a;\n\t    b = (b << 25) ^ (b >>> 7) ^ c;\n\t    c = (c - d) | 0;\n\t    d = (d << 24) ^ (d >>> 8) ^ a;\n\t    a = (a - b) | 0;\n\t    me.b = b = (b << 20) ^ (b >>> 12) ^ c;\n\t    me.c = c = (c - d) | 0;\n\t    me.d = (d << 16) ^ (c >>> 16) ^ a;\n\t    return me.a = (a - b) | 0;\n\t  };\n\n\t  /* The following is non-inverted tyche, which has better internal\n\t   * bit diffusion, but which is about 25% slower than tyche-i in JS.\n\t  me.next = function() {\n\t    var a = me.a, b = me.b, c = me.c, d = me.d;\n\t    a = (me.a + me.b | 0) >>> 0;\n\t    d = me.d ^ a; d = d << 16 ^ d >>> 16;\n\t    c = me.c + d | 0;\n\t    b = me.b ^ c; b = b << 12 ^ d >>> 20;\n\t    me.a = a = a + b | 0;\n\t    d = d ^ a; me.d = d = d << 8 ^ d >>> 24;\n\t    me.c = c = c + d | 0;\n\t    b = b ^ c;\n\t    return me.b = (b << 7 ^ b >>> 25);\n\t  }\n\t  */\n\n\t  me.a = 0;\n\t  me.b = 0;\n\t  me.c = 2654435769 | 0;\n\t  me.d = 1367130551;\n\n\t  if (seed === Math.floor(seed)) {\n\t    // Integer seed.\n\t    me.a = (seed / 0x100000000) | 0;\n\t    me.b = seed | 0;\n\t  } else {\n\t    // String seed.\n\t    strseed += seed;\n\t  }\n\n\t  // Mix in string seed, then discard an initial batch of 64 values.\n\t  for (var k = 0; k < strseed.length + 20; k++) {\n\t    me.b ^= strseed.charCodeAt(k) | 0;\n\t    me.next();\n\t  }\n\t}\n\n\tfunction copy(f, t) {\n\t  t.a = f.a;\n\t  t.b = f.b;\n\t  t.c = f.c;\n\t  t.d = f.d;\n\t  return t;\n\t}\n\tfunction impl(seed, opts) {\n\t  var xg = new XorGen(seed),\n\t      state = opts && opts.state,\n\t      prng = function() { return (xg.next() >>> 0) / 0x100000000; };\n\t  prng.double = function() {\n\t    do {\n\t      var top = xg.next() >>> 11,\n\t          bot = (xg.next() >>> 0) / 0x100000000,\n\t          result = (top + bot) / (1 << 21);\n\t    } while (result === 0);\n\t    return result;\n\t  };\n\t  prng.int32 = xg.next;\n\t  prng.quick = prng;\n\t  if (state) {\n\t    if (typeof(state) == 'object') copy(state, xg);\n\t    prng.state = function() { return copy(xg, {}); };\n\t  }\n\t  return prng;\n\t}\n\n\tif (module && module.exports) {\n\t  module.exports = impl;\n\t} else if (define && define.amd) {\n\t  define(function() { return impl; });\n\t} else {\n\t  this.tychei = impl;\n\t}\n\n\t})(\n\t  commonjsGlobal,\n\t  module,    // present in node.js\n\t  (typeof undefined) == 'function'    // present with an AMD loader\n\t); \n} (tychei$1));\n\nvar tycheiExports = tychei$1.exports;\n\nvar seedrandom$2 = {exports: {}};\n\n/*\nCopyright 2019 David Bau.\n\nPermission is hereby granted, free of charge, to any person obtaining\na copy of this software and associated documentation files (the\n\"Software\"), to deal in the Software without restriction, including\nwithout limitation the rights to use, copy, modify, merge, publish,\ndistribute, sublicense, and/or sell copies of the Software, and to\npermit persons to whom the Software is furnished to do so, subject to\nthe following conditions:\n\nThe above copyright notice and this permission notice shall be\nincluded in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\nIN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\nCLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\nTORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\nSOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n*/\n\n(function (module) {\n\t(function (global, pool, math) {\n\t//\n\t// The following constants are related to IEEE 754 limits.\n\t//\n\n\tvar width = 256,        // each RC4 output is 0 <= x < 256\n\t    chunks = 6,         // at least six RC4 outputs for each double\n\t    digits = 52,        // there are 52 significant digits in a double\n\t    rngname = 'random', // rngname: name for Math.random and Math.seedrandom\n\t    startdenom = math.pow(width, chunks),\n\t    significance = math.pow(2, digits),\n\t    overflow = significance * 2,\n\t    mask = width - 1,\n\t    nodecrypto;         // node.js crypto module, initialized at the bottom.\n\n\t//\n\t// seedrandom()\n\t// This is the seedrandom function described above.\n\t//\n\tfunction seedrandom(seed, options, callback) {\n\t  var key = [];\n\t  options = (options == true) ? { entropy: true } : (options || {});\n\n\t  // Flatten the seed string or build one from local entropy if needed.\n\t  var shortseed = mixkey(flatten(\n\t    options.entropy ? [seed, tostring(pool)] :\n\t    (seed == null) ? autoseed() : seed, 3), key);\n\n\t  // Use the seed to initialize an ARC4 generator.\n\t  var arc4 = new ARC4(key);\n\n\t  // This function returns a random double in [0, 1) that contains\n\t  // randomness in every bit of the mantissa of the IEEE 754 value.\n\t  var prng = function() {\n\t    var n = arc4.g(chunks),             // Start with a numerator n < 2 ^ 48\n\t        d = startdenom,                 //   and denominator d = 2 ^ 48.\n\t        x = 0;                          //   and no 'extra last byte'.\n\t    while (n < significance) {          // Fill up all significant digits by\n\t      n = (n + x) * width;              //   shifting numerator and\n\t      d *= width;                       //   denominator and generating a\n\t      x = arc4.g(1);                    //   new least-significant-byte.\n\t    }\n\t    while (n >= overflow) {             // To avoid rounding up, before adding\n\t      n /= 2;                           //   last byte, shift everything\n\t      d /= 2;                           //   right using integer math until\n\t      x >>>= 1;                         //   we have exactly the desired bits.\n\t    }\n\t    return (n + x) / d;                 // Form the number within [0, 1).\n\t  };\n\n\t  prng.int32 = function() { return arc4.g(4) | 0; };\n\t  prng.quick = function() { return arc4.g(4) / 0x100000000; };\n\t  prng.double = prng;\n\n\t  // Mix the randomness into accumulated entropy.\n\t  mixkey(tostring(arc4.S), pool);\n\n\t  // Calling convention: what to return as a function of prng, seed, is_math.\n\t  return (options.pass || callback ||\n\t      function(prng, seed, is_math_call, state) {\n\t        if (state) {\n\t          // Load the arc4 state from the given state if it has an S array.\n\t          if (state.S) { copy(state, arc4); }\n\t          // Only provide the .state method if requested via options.state.\n\t          prng.state = function() { return copy(arc4, {}); };\n\t        }\n\n\t        // If called as a method of Math (Math.seedrandom()), mutate\n\t        // Math.random because that is how seedrandom.js has worked since v1.0.\n\t        if (is_math_call) { math[rngname] = prng; return seed; }\n\n\t        // Otherwise, it is a newer calling convention, so return the\n\t        // prng directly.\n\t        else return prng;\n\t      })(\n\t  prng,\n\t  shortseed,\n\t  'global' in options ? options.global : (this == math),\n\t  options.state);\n\t}\n\n\t//\n\t// ARC4\n\t//\n\t// An ARC4 implementation.  The constructor takes a key in the form of\n\t// an array of at most (width) integers that should be 0 <= x < (width).\n\t//\n\t// The g(count) method returns a pseudorandom integer that concatenates\n\t// the next (count) outputs from ARC4.  Its return value is a number x\n\t// that is in the range 0 <= x < (width ^ count).\n\t//\n\tfunction ARC4(key) {\n\t  var t, keylen = key.length,\n\t      me = this, i = 0, j = me.i = me.j = 0, s = me.S = [];\n\n\t  // The empty key [] is treated as [0].\n\t  if (!keylen) { key = [keylen++]; }\n\n\t  // Set up S using the standard key scheduling algorithm.\n\t  while (i < width) {\n\t    s[i] = i++;\n\t  }\n\t  for (i = 0; i < width; i++) {\n\t    s[i] = s[j = mask & (j + key[i % keylen] + (t = s[i]))];\n\t    s[j] = t;\n\t  }\n\n\t  // The \"g\" method returns the next (count) outputs as one number.\n\t  (me.g = function(count) {\n\t    // Using instance members instead of closure state nearly doubles speed.\n\t    var t, r = 0,\n\t        i = me.i, j = me.j, s = me.S;\n\t    while (count--) {\n\t      t = s[i = mask & (i + 1)];\n\t      r = r * width + s[mask & ((s[i] = s[j = mask & (j + t)]) + (s[j] = t))];\n\t    }\n\t    me.i = i; me.j = j;\n\t    return r;\n\t    // For robust unpredictability, the function call below automatically\n\t    // discards an initial batch of values.  This is called RC4-drop[256].\n\t    // See http://google.com/search?q=rsa+fluhrer+response&btnI\n\t  })(width);\n\t}\n\n\t//\n\t// copy()\n\t// Copies internal state of ARC4 to or from a plain object.\n\t//\n\tfunction copy(f, t) {\n\t  t.i = f.i;\n\t  t.j = f.j;\n\t  t.S = f.S.slice();\n\t  return t;\n\t}\n\t//\n\t// flatten()\n\t// Converts an object tree to nested arrays of strings.\n\t//\n\tfunction flatten(obj, depth) {\n\t  var result = [], typ = (typeof obj), prop;\n\t  if (depth && typ == 'object') {\n\t    for (prop in obj) {\n\t      try { result.push(flatten(obj[prop], depth - 1)); } catch (e) {}\n\t    }\n\t  }\n\t  return (result.length ? result : typ == 'string' ? obj : obj + '\\0');\n\t}\n\n\t//\n\t// mixkey()\n\t// Mixes a string seed into a key that is an array of integers, and\n\t// returns a shortened string seed that is equivalent to the result key.\n\t//\n\tfunction mixkey(seed, key) {\n\t  var stringseed = seed + '', smear, j = 0;\n\t  while (j < stringseed.length) {\n\t    key[mask & j] =\n\t      mask & ((smear ^= key[mask & j] * 19) + stringseed.charCodeAt(j++));\n\t  }\n\t  return tostring(key);\n\t}\n\n\t//\n\t// autoseed()\n\t// Returns an object for autoseeding, using window.crypto and Node crypto\n\t// module if available.\n\t//\n\tfunction autoseed() {\n\t  try {\n\t    var out;\n\t    if (nodecrypto && (out = nodecrypto.randomBytes)) {\n\t      // The use of 'out' to remember randomBytes makes tight minified code.\n\t      out = out(width);\n\t    } else {\n\t      out = new Uint8Array(width);\n\t      (global.crypto || global.msCrypto).getRandomValues(out);\n\t    }\n\t    return tostring(out);\n\t  } catch (e) {\n\t    var browser = global.navigator,\n\t        plugins = browser && browser.plugins;\n\t    return [+new Date, global, plugins, global.screen, tostring(pool)];\n\t  }\n\t}\n\n\t//\n\t// tostring()\n\t// Converts an array of charcodes to a string\n\t//\n\tfunction tostring(a) {\n\t  return String.fromCharCode.apply(0, a);\n\t}\n\n\t//\n\t// When seedrandom.js is loaded, we immediately mix a few bits\n\t// from the built-in RNG into the entropy pool.  Because we do\n\t// not want to interfere with deterministic PRNG state later,\n\t// seedrandom will not call math.random on its own again after\n\t// initialization.\n\t//\n\tmixkey(math.random(), pool);\n\n\t//\n\t// Nodejs and AMD support: export the implementation as a module using\n\t// either convention.\n\t//\n\tif (module.exports) {\n\t  module.exports = seedrandom;\n\t  // When in node.js, try using crypto package for autoseeding.\n\t  try {\n\t    nodecrypto = require('crypto');\n\t  } catch (ex) {}\n\t} else {\n\t  // When included as a plain script, set up Math.seedrandom global.\n\t  math['seed' + rngname] = seedrandom;\n\t}\n\n\n\t// End anonymous scope, and pass initial values.\n\t})(\n\t  // global: `self` in browsers (including strict mode and web workers),\n\t  // otherwise `this` in Node and other environments\n\t  (typeof self !== 'undefined') ? self : commonjsGlobal,\n\t  [],     // pool: entropy pool starts empty\n\t  Math    // math: package containing random, pow, and seedrandom\n\t); \n} (seedrandom$2));\n\nvar seedrandomExports = seedrandom$2.exports;\n\n// A library of seedable RNGs implemented in Javascript.\n//\n// Usage:\n//\n// var seedrandom = require('seedrandom');\n// var random = seedrandom(1); // or any seed.\n// var x = random();       // 0 <= x < 1.  Every bit is random.\n// var x = random.quick(); // 0 <= x < 1.  32 bits of randomness.\n\n// alea, a 53-bit multiply-with-carry generator by Johannes Baagøe.\n// Period: ~2^116\n// Reported to pass all BigCrush tests.\nvar alea = aleaExports;\n\n// xor128, a pure xor-shift generator by George Marsaglia.\n// Period: 2^128-1.\n// Reported to fail: MatrixRank and LinearComp.\nvar xor128 = xor128Exports;\n\n// xorwow, George Marsaglia's 160-bit xor-shift combined plus weyl.\n// Period: 2^192-2^32\n// Reported to fail: CollisionOver, SimpPoker, and LinearComp.\nvar xorwow = xorwowExports;\n\n// xorshift7, by François Panneton and Pierre L'ecuyer, takes\n// a different approach: it adds robustness by allowing more shifts\n// than Marsaglia's original three.  It is a 7-shift generator\n// with 256 bits, that passes BigCrush with no systmatic failures.\n// Period 2^256-1.\n// No systematic BigCrush failures reported.\nvar xorshift7 = xorshift7Exports;\n\n// xor4096, by Richard Brent, is a 4096-bit xor-shift with a\n// very long period that also adds a Weyl generator. It also passes\n// BigCrush with no systematic failures.  Its long period may\n// be useful if you have many generators and need to avoid\n// collisions.\n// Period: 2^4128-2^32.\n// No systematic BigCrush failures reported.\nvar xor4096 = xor4096Exports;\n\n// Tyche-i, by Samuel Neves and Filipe Araujo, is a bit-shifting random\n// number generator derived from ChaCha, a modern stream cipher.\n// https://eden.dei.uc.pt/~sneves/pubs/2011-snfa2.pdf\n// Period: ~2^127\n// No systematic BigCrush failures reported.\nvar tychei = tycheiExports;\n\n// The original ARC4-based prng included in this library.\n// Period: ~2^1600\nvar sr = seedrandomExports;\n\nsr.alea = alea;\nsr.xor128 = xor128;\nsr.xorwow = xorwow;\nsr.xorshift7 = xorshift7;\nsr.xor4096 = xor4096;\nsr.tychei = tychei;\n\nvar seedrandom$1 = sr;\n\nvar seedrandom = seedrandom$1;\n\nvar wordList = [\n  // Borrowed from xkcd password generator which borrowed it from wherever\n  \"ability\",\"able\",\"aboard\",\"about\",\"above\",\"accept\",\"accident\",\"according\",\n  \"account\",\"accurate\",\"acres\",\"across\",\"act\",\"action\",\"active\",\"activity\",\n  \"actual\",\"actually\",\"add\",\"addition\",\"additional\",\"adjective\",\"adult\",\"adventure\",\n  \"advice\",\"affect\",\"afraid\",\"after\",\"afternoon\",\"again\",\"against\",\"age\",\n  \"ago\",\"agree\",\"ahead\",\"aid\",\"air\",\"airplane\",\"alike\",\"alive\",\n  \"all\",\"allow\",\"almost\",\"alone\",\"along\",\"aloud\",\"alphabet\",\"already\",\n  \"also\",\"although\",\"am\",\"among\",\"amount\",\"ancient\",\"angle\",\"angry\",\n  \"animal\",\"announced\",\"another\",\"answer\",\"ants\",\"any\",\"anybody\",\"anyone\",\n  \"anything\",\"anyway\",\"anywhere\",\"apart\",\"apartment\",\"appearance\",\"apple\",\"applied\",\n  \"appropriate\",\"are\",\"area\",\"arm\",\"army\",\"around\",\"arrange\",\"arrangement\",\n  \"arrive\",\"arrow\",\"art\",\"article\",\"as\",\"aside\",\"ask\",\"asleep\",\n  \"at\",\"ate\",\"atmosphere\",\"atom\",\"atomic\",\"attached\",\"attack\",\"attempt\",\n  \"attention\",\"audience\",\"author\",\"automobile\",\"available\",\"average\",\"avoid\",\"aware\",\n  \"away\",\"baby\",\"back\",\"bad\",\"badly\",\"bag\",\"balance\",\"ball\",\n  \"balloon\",\"band\",\"bank\",\"bar\",\"bare\",\"bark\",\"barn\",\"base\",\n  \"baseball\",\"basic\",\"basis\",\"basket\",\"bat\",\"battle\",\"be\",\"bean\",\n  \"bear\",\"beat\",\"beautiful\",\"beauty\",\"became\",\"because\",\"become\",\"becoming\",\n  \"bee\",\"been\",\"before\",\"began\",\"beginning\",\"begun\",\"behavior\",\"behind\",\n  \"being\",\"believed\",\"bell\",\"belong\",\"below\",\"belt\",\"bend\",\"beneath\",\n  \"bent\",\"beside\",\"best\",\"bet\",\"better\",\"between\",\"beyond\",\"bicycle\",\n  \"bigger\",\"biggest\",\"bill\",\"birds\",\"birth\",\"birthday\",\"bit\",\"bite\",\n  \"black\",\"blank\",\"blanket\",\"blew\",\"blind\",\"block\",\"blood\",\"blow\",\n  \"blue\",\"board\",\"boat\",\"body\",\"bone\",\"book\",\"border\",\"born\",\n  \"both\",\"bottle\",\"bottom\",\"bound\",\"bow\",\"bowl\",\"box\",\"boy\",\n  \"brain\",\"branch\",\"brass\",\"brave\",\"bread\",\"break\",\"breakfast\",\"breath\",\n  \"breathe\",\"breathing\",\"breeze\",\"brick\",\"bridge\",\"brief\",\"bright\",\"bring\",\n  \"broad\",\"broke\",\"broken\",\"brother\",\"brought\",\"brown\",\"brush\",\"buffalo\",\n  \"build\",\"building\",\"built\",\"buried\",\"burn\",\"burst\",\"bus\",\"bush\",\n  \"business\",\"busy\",\"but\",\"butter\",\"buy\",\"by\",\"cabin\",\"cage\",\n  \"cake\",\"call\",\"calm\",\"came\",\"camera\",\"camp\",\"can\",\"canal\",\n  \"cannot\",\"cap\",\"capital\",\"captain\",\"captured\",\"car\",\"carbon\",\"card\",\n  \"care\",\"careful\",\"carefully\",\"carried\",\"carry\",\"case\",\"cast\",\"castle\",\n  \"cat\",\"catch\",\"cattle\",\"caught\",\"cause\",\"cave\",\"cell\",\"cent\",\n  \"center\",\"central\",\"century\",\"certain\",\"certainly\",\"chain\",\"chair\",\"chamber\",\n  \"chance\",\"change\",\"changing\",\"chapter\",\"character\",\"characteristic\",\"charge\",\"chart\",\n  \"check\",\"cheese\",\"chemical\",\"chest\",\"chicken\",\"chief\",\"child\",\"children\",\n  \"choice\",\"choose\",\"chose\",\"chosen\",\"church\",\"circle\",\"circus\",\"citizen\",\n  \"city\",\"class\",\"classroom\",\"claws\",\"clay\",\"clean\",\"clear\",\"clearly\",\n  \"climate\",\"climb\",\"clock\",\"close\",\"closely\",\"closer\",\"cloth\",\"clothes\",\n  \"clothing\",\"cloud\",\"club\",\"coach\",\"coal\",\"coast\",\"coat\",\"coffee\",\n  \"cold\",\"collect\",\"college\",\"colony\",\"color\",\"column\",\"combination\",\"combine\",\n  \"come\",\"comfortable\",\"coming\",\"command\",\"common\",\"community\",\"company\",\"compare\",\n  \"compass\",\"complete\",\"completely\",\"complex\",\"composed\",\"composition\",\"compound\",\"concerned\",\n  \"condition\",\"congress\",\"connected\",\"consider\",\"consist\",\"consonant\",\"constantly\",\"construction\",\n  \"contain\",\"continent\",\"continued\",\"contrast\",\"control\",\"conversation\",\"cook\",\"cookies\",\n  \"cool\",\"copper\",\"copy\",\"corn\",\"corner\",\"correct\",\"correctly\",\"cost\",\n  \"cotton\",\"could\",\"count\",\"country\",\"couple\",\"courage\",\"course\",\"court\",\n  \"cover\",\"cow\",\"cowboy\",\"crack\",\"cream\",\"create\",\"creature\",\"crew\",\n  \"crop\",\"cross\",\"crowd\",\"cry\",\"cup\",\"curious\",\"current\",\"curve\",\n  \"customs\",\"cut\",\"cutting\",\"daily\",\"damage\",\"dance\",\"danger\",\"dangerous\",\n  \"dark\",\"darkness\",\"date\",\"daughter\",\"dawn\",\"day\",\"dead\",\"deal\",\n  \"dear\",\"death\",\"decide\",\"declared\",\"deep\",\"deeply\",\"deer\",\"definition\",\n  \"degree\",\"depend\",\"depth\",\"describe\",\"desert\",\"design\",\"desk\",\"detail\",\n  \"determine\",\"develop\",\"development\",\"diagram\",\"diameter\",\"did\",\"die\",\"differ\",\n  \"difference\",\"different\",\"difficult\",\"difficulty\",\"dig\",\"dinner\",\"direct\",\"direction\",\n  \"directly\",\"dirt\",\"dirty\",\"disappear\",\"discover\",\"discovery\",\"discuss\",\"discussion\",\n  \"disease\",\"dish\",\"distance\",\"distant\",\"divide\",\"division\",\"do\",\"doctor\",\n  \"does\",\"dog\",\"doing\",\"doll\",\"dollar\",\"done\",\"donkey\",\"door\",\n  \"dot\",\"double\",\"doubt\",\"down\",\"dozen\",\"draw\",\"drawn\",\"dream\",\n  \"dress\",\"drew\",\"dried\",\"drink\",\"drive\",\"driven\",\"driver\",\"driving\",\n  \"drop\",\"dropped\",\"drove\",\"dry\",\"duck\",\"due\",\"dug\",\"dull\",\n  \"during\",\"dust\",\"duty\",\"each\",\"eager\",\"ear\",\"earlier\",\"early\",\n  \"earn\",\"earth\",\"easier\",\"easily\",\"east\",\"easy\",\"eat\",\"eaten\",\n  \"edge\",\"education\",\"effect\",\"effort\",\"egg\",\"eight\",\"either\",\"electric\",\n  \"electricity\",\"element\",\"elephant\",\"eleven\",\"else\",\"empty\",\"end\",\"enemy\",\n  \"energy\",\"engine\",\"engineer\",\"enjoy\",\"enough\",\"enter\",\"entire\",\"entirely\",\n  \"environment\",\"equal\",\"equally\",\"equator\",\"equipment\",\"escape\",\"especially\",\"essential\",\n  \"establish\",\"even\",\"evening\",\"event\",\"eventually\",\"ever\",\"every\",\"everybody\",\n  \"everyone\",\"everything\",\"everywhere\",\"evidence\",\"exact\",\"exactly\",\"examine\",\"example\",\n  \"excellent\",\"except\",\"exchange\",\"excited\",\"excitement\",\"exciting\",\"exclaimed\",\"exercise\",\n  \"exist\",\"expect\",\"experience\",\"experiment\",\"explain\",\"explanation\",\"explore\",\"express\",\n  \"expression\",\"extra\",\"eye\",\"face\",\"facing\",\"fact\",\"factor\",\"factory\",\n  \"failed\",\"fair\",\"fairly\",\"fall\",\"fallen\",\"familiar\",\"family\",\"famous\",\n  \"far\",\"farm\",\"farmer\",\"farther\",\"fast\",\"fastened\",\"faster\",\"fat\",\n  \"father\",\"favorite\",\"fear\",\"feathers\",\"feature\",\"fed\",\"feed\",\"feel\",\n  \"feet\",\"fell\",\"fellow\",\"felt\",\"fence\",\"few\",\"fewer\",\"field\",\n  \"fierce\",\"fifteen\",\"fifth\",\"fifty\",\"fight\",\"fighting\",\"figure\",\"fill\",\n  \"film\",\"final\",\"finally\",\"find\",\"fine\",\"finest\",\"finger\",\"finish\",\n  \"fire\",\"fireplace\",\"firm\",\"first\",\"fish\",\"five\",\"fix\",\"flag\",\n  \"flame\",\"flat\",\"flew\",\"flies\",\"flight\",\"floating\",\"floor\",\"flow\",\n  \"flower\",\"fly\",\"fog\",\"folks\",\"follow\",\"food\",\"foot\",\"football\",\n  \"for\",\"force\",\"foreign\",\"forest\",\"forget\",\"forgot\",\"forgotten\",\"form\",\n  \"former\",\"fort\",\"forth\",\"forty\",\"forward\",\"fought\",\"found\",\"four\",\n  \"fourth\",\"fox\",\"frame\",\"free\",\"freedom\",\"frequently\",\"fresh\",\"friend\",\n  \"friendly\",\"frighten\",\"frog\",\"from\",\"front\",\"frozen\",\"fruit\",\"fuel\",\n  \"full\",\"fully\",\"fun\",\"function\",\"funny\",\"fur\",\"furniture\",\"further\",\n  \"future\",\"gain\",\"game\",\"garage\",\"garden\",\"gas\",\"gasoline\",\"gate\",\n  \"gather\",\"gave\",\"general\",\"generally\",\"gentle\",\"gently\",\"get\",\"getting\",\n  \"giant\",\"gift\",\"girl\",\"give\",\"given\",\"giving\",\"glad\",\"glass\",\n  \"globe\",\"go\",\"goes\",\"gold\",\"golden\",\"gone\",\"good\",\"goose\",\n  \"got\",\"government\",\"grabbed\",\"grade\",\"gradually\",\"grain\",\"grandfather\",\"grandmother\",\n  \"graph\",\"grass\",\"gravity\",\"gray\",\"great\",\"greater\",\"greatest\",\"greatly\",\n  \"green\",\"grew\",\"ground\",\"group\",\"grow\",\"grown\",\"growth\",\"guard\",\n  \"guess\",\"guide\",\"gulf\",\"gun\",\"habit\",\"had\",\"hair\",\"half\",\n  \"halfway\",\"hall\",\"hand\",\"handle\",\"handsome\",\"hang\",\"happen\",\"happened\",\n  \"happily\",\"happy\",\"harbor\",\"hard\",\"harder\",\"hardly\",\"has\",\"hat\",\n  \"have\",\"having\",\"hay\",\"he\",\"headed\",\"heading\",\"health\",\"heard\",\n  \"hearing\",\"heart\",\"heat\",\"heavy\",\"height\",\"held\",\"hello\",\"help\",\n  \"helpful\",\"her\",\"herd\",\"here\",\"herself\",\"hidden\",\"hide\",\"high\",\n  \"higher\",\"highest\",\"highway\",\"hill\",\"him\",\"himself\",\"his\",\"history\",\n  \"hit\",\"hold\",\"hole\",\"hollow\",\"home\",\"honor\",\"hope\",\"horn\",\n  \"horse\",\"hospital\",\"hot\",\"hour\",\"house\",\"how\",\"however\",\"huge\",\n  \"human\",\"hundred\",\"hung\",\"hungry\",\"hunt\",\"hunter\",\"hurried\",\"hurry\",\n  \"hurt\",\"husband\",\"ice\",\"idea\",\"identity\",\"if\",\"ill\",\"image\",\n  \"imagine\",\"immediately\",\"importance\",\"important\",\"impossible\",\"improve\",\"in\",\"inch\",\n  \"include\",\"including\",\"income\",\"increase\",\"indeed\",\"independent\",\"indicate\",\"individual\",\n  \"industrial\",\"industry\",\"influence\",\"information\",\"inside\",\"instance\",\"instant\",\"instead\",\n  \"instrument\",\"interest\",\"interior\",\"into\",\"introduced\",\"invented\",\"involved\",\"iron\",\n  \"is\",\"island\",\"it\",\"its\",\"itself\",\"jack\",\"jar\",\"jet\",\n  \"job\",\"join\",\"joined\",\"journey\",\"joy\",\"judge\",\"jump\",\"jungle\",\n  \"just\",\"keep\",\"kept\",\"key\",\"kids\",\"kill\",\"kind\",\"kitchen\",\n  \"knew\",\"knife\",\"know\",\"knowledge\",\"known\",\"label\",\"labor\",\"lack\",\n  \"lady\",\"laid\",\"lake\",\"lamp\",\"land\",\"language\",\"large\",\"larger\",\n  \"largest\",\"last\",\"late\",\"later\",\"laugh\",\"law\",\"lay\",\"layers\",\n  \"lead\",\"leader\",\"leaf\",\"learn\",\"least\",\"leather\",\"leave\",\"leaving\",\n  \"led\",\"left\",\"leg\",\"length\",\"lesson\",\"let\",\"letter\",\"level\",\n  \"library\",\"lie\",\"life\",\"lift\",\"light\",\"like\",\"likely\",\"limited\",\n  \"line\",\"lion\",\"lips\",\"liquid\",\"list\",\"listen\",\"little\",\"live\",\n  \"living\",\"load\",\"local\",\"locate\",\"location\",\"log\",\"lonely\",\"long\",\n  \"longer\",\"look\",\"loose\",\"lose\",\"loss\",\"lost\",\"lot\",\"loud\",\n  \"love\",\"lovely\",\"low\",\"lower\",\"luck\",\"lucky\",\"lunch\",\"lungs\",\n  \"lying\",\"machine\",\"machinery\",\"mad\",\"made\",\"magic\",\"magnet\",\"mail\",\n  \"main\",\"mainly\",\"major\",\"make\",\"making\",\"man\",\"managed\",\"manner\",\n  \"manufacturing\",\"many\",\"map\",\"mark\",\"market\",\"married\",\"mass\",\"massage\",\n  \"master\",\"material\",\"mathematics\",\"matter\",\"may\",\"maybe\",\"me\",\"meal\",\n  \"mean\",\"means\",\"meant\",\"measure\",\"meat\",\"medicine\",\"meet\",\"melted\",\n  \"member\",\"memory\",\"men\",\"mental\",\"merely\",\"met\",\"metal\",\"method\",\n  \"mice\",\"middle\",\"might\",\"mighty\",\"mile\",\"military\",\"milk\",\"mill\",\n  \"mind\",\"mine\",\"minerals\",\"minute\",\"mirror\",\"missing\",\"mission\",\"mistake\",\n  \"mix\",\"mixture\",\"model\",\"modern\",\"molecular\",\"moment\",\"money\",\"monkey\",\n  \"month\",\"mood\",\"moon\",\"more\",\"morning\",\"most\",\"mostly\",\"mother\",\n  \"motion\",\"motor\",\"mountain\",\"mouse\",\"mouth\",\"move\",\"movement\",\"movie\",\n  \"moving\",\"mud\",\"muscle\",\"music\",\"musical\",\"must\",\"my\",\"myself\",\n  \"mysterious\",\"nails\",\"name\",\"nation\",\"national\",\"native\",\"natural\",\"naturally\",\n  \"nature\",\"near\",\"nearby\",\"nearer\",\"nearest\",\"nearly\",\"necessary\",\"neck\",\n  \"needed\",\"needle\",\"needs\",\"negative\",\"neighbor\",\"neighborhood\",\"nervous\",\"nest\",\n  \"never\",\"new\",\"news\",\"newspaper\",\"next\",\"nice\",\"night\",\"nine\",\n  \"no\",\"nobody\",\"nodded\",\"noise\",\"none\",\"noon\",\"nor\",\"north\",\n  \"nose\",\"not\",\"note\",\"noted\",\"nothing\",\"notice\",\"noun\",\"now\",\n  \"number\",\"numeral\",\"nuts\",\"object\",\"observe\",\"obtain\",\"occasionally\",\"occur\",\n  \"ocean\",\"of\",\"off\",\"offer\",\"office\",\"officer\",\"official\",\"oil\",\n  \"old\",\"older\",\"oldest\",\"on\",\"once\",\"one\",\"only\",\"onto\",\n  \"open\",\"operation\",\"opinion\",\"opportunity\",\"opposite\",\"or\",\"orange\",\"orbit\",\n  \"order\",\"ordinary\",\"organization\",\"organized\",\"origin\",\"original\",\"other\",\"ought\",\n  \"our\",\"ourselves\",\"out\",\"outer\",\"outline\",\"outside\",\"over\",\"own\",\n  \"owner\",\"oxygen\",\"pack\",\"package\",\"page\",\"paid\",\"pain\",\"paint\",\n  \"pair\",\"palace\",\"pale\",\"pan\",\"paper\",\"paragraph\",\"parallel\",\"parent\",\n  \"park\",\"part\",\"particles\",\"particular\",\"particularly\",\"partly\",\"parts\",\"party\",\n  \"pass\",\"passage\",\"past\",\"path\",\"pattern\",\"pay\",\"peace\",\"pen\",\n  \"pencil\",\"people\",\"per\",\"percent\",\"perfect\",\"perfectly\",\"perhaps\",\"period\",\n  \"person\",\"personal\",\"pet\",\"phrase\",\"physical\",\"piano\",\"pick\",\"picture\",\n  \"pictured\",\"pie\",\"piece\",\"pig\",\"pile\",\"pilot\",\"pine\",\"pink\",\n  \"pipe\",\"pitch\",\"place\",\"plain\",\"plan\",\"plane\",\"planet\",\"planned\",\n  \"planning\",\"plant\",\"plastic\",\"plate\",\"plates\",\"play\",\"pleasant\",\"please\",\n  \"pleasure\",\"plenty\",\"plural\",\"plus\",\"pocket\",\"poem\",\"poet\",\"poetry\",\n  \"point\",\"pole\",\"police\",\"policeman\",\"political\",\"pond\",\"pony\",\"pool\",\n  \"poor\",\"popular\",\"population\",\"porch\",\"port\",\"position\",\"positive\",\"possible\",\n  \"possibly\",\"post\",\"pot\",\"potatoes\",\"pound\",\"pour\",\"powder\",\"power\",\n  \"powerful\",\"practical\",\"practice\",\"prepare\",\"present\",\"president\",\"press\",\"pressure\",\n  \"pretty\",\"prevent\",\"previous\",\"price\",\"pride\",\"primitive\",\"principal\",\"principle\",\n  \"printed\",\"private\",\"prize\",\"probably\",\"problem\",\"process\",\"produce\",\"product\",\n  \"production\",\"program\",\"progress\",\"promised\",\"proper\",\"properly\",\"property\",\"protection\",\n  \"proud\",\"prove\",\"provide\",\"public\",\"pull\",\"pupil\",\"pure\",\"purple\",\n  \"purpose\",\"push\",\"put\",\"putting\",\"quarter\",\"queen\",\"question\",\"quick\",\n  \"quickly\",\"quiet\",\"quietly\",\"quite\",\"rabbit\",\"race\",\"radio\",\"railroad\",\n  \"rain\",\"raise\",\"ran\",\"ranch\",\"range\",\"rapidly\",\"rate\",\"rather\",\n  \"raw\",\"rays\",\"reach\",\"read\",\"reader\",\"ready\",\"real\",\"realize\",\n  \"rear\",\"reason\",\"recall\",\"receive\",\"recent\",\"recently\",\"recognize\",\"record\",\n  \"red\",\"refer\",\"refused\",\"region\",\"regular\",\"related\",\"relationship\",\"religious\",\n  \"remain\",\"remarkable\",\"remember\",\"remove\",\"repeat\",\"replace\",\"replied\",\"report\",\n  \"represent\",\"require\",\"research\",\"respect\",\"rest\",\"result\",\"return\",\"review\",\n  \"rhyme\",\"rhythm\",\"rice\",\"rich\",\"ride\",\"riding\",\"right\",\"ring\",\n  \"rise\",\"rising\",\"river\",\"road\",\"roar\",\"rock\",\"rocket\",\"rocky\",\n  \"rod\",\"roll\",\"roof\",\"room\",\"root\",\"rope\",\"rose\",\"rough\",\n  \"round\",\"route\",\"row\",\"rubbed\",\"rubber\",\"rule\",\"ruler\",\"run\",\n  \"running\",\"rush\",\"sad\",\"saddle\",\"safe\",\"safety\",\"said\",\"sail\",\n  \"sale\",\"salmon\",\"salt\",\"same\",\"sand\",\"sang\",\"sat\",\"satellites\",\n  \"satisfied\",\"save\",\"saved\",\"saw\",\"say\",\"scale\",\"scared\",\"scene\",\n  \"school\",\"science\",\"scientific\",\"scientist\",\"score\",\"screen\",\"sea\",\"search\",\n  \"season\",\"seat\",\"second\",\"secret\",\"section\",\"see\",\"seed\",\"seeing\",\n  \"seems\",\"seen\",\"seldom\",\"select\",\"selection\",\"sell\",\"send\",\"sense\",\n  \"sent\",\"sentence\",\"separate\",\"series\",\"serious\",\"serve\",\"service\",\"sets\",\n  \"setting\",\"settle\",\"settlers\",\"seven\",\"several\",\"shade\",\"shadow\",\"shake\",\n  \"shaking\",\"shall\",\"shallow\",\"shape\",\"share\",\"sharp\",\"she\",\"sheep\",\n  \"sheet\",\"shelf\",\"shells\",\"shelter\",\"shine\",\"shinning\",\"ship\",\"shirt\",\n  \"shoe\",\"shoot\",\"shop\",\"shore\",\"short\",\"shorter\",\"shot\",\"should\",\n  \"shoulder\",\"shout\",\"show\",\"shown\",\"shut\",\"sick\",\"sides\",\"sight\",\n  \"sign\",\"signal\",\"silence\",\"silent\",\"silk\",\"silly\",\"silver\",\"similar\",\n  \"simple\",\"simplest\",\"simply\",\"since\",\"sing\",\"single\",\"sink\",\"sister\",\n  \"sit\",\"sitting\",\"situation\",\"six\",\"size\",\"skill\",\"skin\",\"sky\",\n  \"slabs\",\"slave\",\"sleep\",\"slept\",\"slide\",\"slight\",\"slightly\",\"slip\",\n  \"slipped\",\"slope\",\"slow\",\"slowly\",\"small\",\"smaller\",\"smallest\",\"smell\",\n  \"smile\",\"smoke\",\"smooth\",\"snake\",\"snow\",\"so\",\"soap\",\"social\",\n  \"society\",\"soft\",\"softly\",\"soil\",\"solar\",\"sold\",\"soldier\",\"solid\",\n  \"solution\",\"solve\",\"some\",\"somebody\",\"somehow\",\"someone\",\"something\",\"sometime\",\n  \"somewhere\",\"son\",\"song\",\"soon\",\"sort\",\"sound\",\"source\",\"south\",\n  \"southern\",\"space\",\"speak\",\"special\",\"species\",\"specific\",\"speech\",\"speed\",\n  \"spell\",\"spend\",\"spent\",\"spider\",\"spin\",\"spirit\",\"spite\",\"split\",\n  \"spoken\",\"sport\",\"spread\",\"spring\",\"square\",\"stage\",\"stairs\",\"stand\",\n  \"standard\",\"star\",\"stared\",\"start\",\"state\",\"statement\",\"station\",\"stay\",\n  \"steady\",\"steam\",\"steel\",\"steep\",\"stems\",\"step\",\"stepped\",\"stick\",\n  \"stiff\",\"still\",\"stock\",\"stomach\",\"stone\",\"stood\",\"stop\",\"stopped\",\n  \"store\",\"storm\",\"story\",\"stove\",\"straight\",\"strange\",\"stranger\",\"straw\",\n  \"stream\",\"street\",\"strength\",\"stretch\",\"strike\",\"string\",\"strip\",\"strong\",\n  \"stronger\",\"struck\",\"structure\",\"struggle\",\"stuck\",\"student\",\"studied\",\"studying\",\n  \"subject\",\"substance\",\"success\",\"successful\",\"such\",\"sudden\",\"suddenly\",\"sugar\",\n  \"suggest\",\"suit\",\"sum\",\"summer\",\"sun\",\"sunlight\",\"supper\",\"supply\",\n  \"support\",\"suppose\",\"sure\",\"surface\",\"surprise\",\"surrounded\",\"swam\",\"sweet\",\n  \"swept\",\"swim\",\"swimming\",\"swing\",\"swung\",\"syllable\",\"symbol\",\"system\",\n  \"table\",\"tail\",\"take\",\"taken\",\"tales\",\"talk\",\"tall\",\"tank\",\n  \"tape\",\"task\",\"taste\",\"taught\",\"tax\",\"tea\",\"teach\",\"teacher\",\n  \"team\",\"tears\",\"teeth\",\"telephone\",\"television\",\"tell\",\"temperature\",\"ten\",\n  \"tent\",\"term\",\"terrible\",\"test\",\"than\",\"thank\",\"that\",\"thee\",\n  \"them\",\"themselves\",\"then\",\"theory\",\"there\",\"therefore\",\"these\",\"they\",\n  \"thick\",\"thin\",\"thing\",\"think\",\"third\",\"thirty\",\"this\",\"those\",\n  \"thou\",\"though\",\"thought\",\"thousand\",\"thread\",\"three\",\"threw\",\"throat\",\n  \"through\",\"throughout\",\"throw\",\"thrown\",\"thumb\",\"thus\",\"thy\",\"tide\",\n  \"tie\",\"tight\",\"tightly\",\"till\",\"time\",\"tin\",\"tiny\",\"tip\",\n  \"tired\",\"title\",\"to\",\"tobacco\",\"today\",\"together\",\"told\",\"tomorrow\",\n  \"tone\",\"tongue\",\"tonight\",\"too\",\"took\",\"tool\",\"top\",\"topic\",\n  \"torn\",\"total\",\"touch\",\"toward\",\"tower\",\"town\",\"toy\",\"trace\",\n  \"track\",\"trade\",\"traffic\",\"trail\",\"train\",\"transportation\",\"trap\",\"travel\",\n  \"treated\",\"tree\",\"triangle\",\"tribe\",\"trick\",\"tried\",\"trip\",\"troops\",\n  \"tropical\",\"trouble\",\"truck\",\"trunk\",\"truth\",\"try\",\"tube\",\"tune\",\n  \"turn\",\"twelve\",\"twenty\",\"twice\",\"two\",\"type\",\"typical\",\"uncle\",\n  \"under\",\"underline\",\"understanding\",\"unhappy\",\"union\",\"unit\",\"universe\",\"unknown\",\n  \"unless\",\"until\",\"unusual\",\"up\",\"upon\",\"upper\",\"upward\",\"us\",\n  \"use\",\"useful\",\"using\",\"usual\",\"usually\",\"valley\",\"valuable\",\"value\",\n  \"vapor\",\"variety\",\"various\",\"vast\",\"vegetable\",\"verb\",\"vertical\",\"very\",\n  \"vessels\",\"victory\",\"view\",\"village\",\"visit\",\"visitor\",\"voice\",\"volume\",\n  \"vote\",\"vowel\",\"voyage\",\"wagon\",\"wait\",\"walk\",\"wall\",\"want\",\n  \"war\",\"warm\",\"warn\",\"was\",\"wash\",\"waste\",\"watch\",\"water\",\n  \"wave\",\"way\",\"we\",\"weak\",\"wealth\",\"wear\",\"weather\",\"week\",\n  \"weigh\",\"weight\",\"welcome\",\"well\",\"went\",\"were\",\"west\",\"western\",\n  \"wet\",\"whale\",\"what\",\"whatever\",\"wheat\",\"wheel\",\"when\",\"whenever\",\n  \"where\",\"wherever\",\"whether\",\"which\",\"while\",\"whispered\",\"whistle\",\"white\",\n  \"who\",\"whole\",\"whom\",\"whose\",\"why\",\"wide\",\"widely\",\"wife\",\n  \"wild\",\"will\",\"willing\",\"win\",\"wind\",\"window\",\"wing\",\"winter\",\n  \"wire\",\"wise\",\"wish\",\"with\",\"within\",\"without\",\"wolf\",\"women\",\n  \"won\",\"wonder\",\"wonderful\",\"wood\",\"wooden\",\"wool\",\"word\",\"wore\",\n  \"work\",\"worker\",\"world\",\"worried\",\"worry\",\"worse\",\"worth\",\"would\",\n  \"wrapped\",\"write\",\"writer\",\"writing\",\"written\",\"wrong\",\"wrote\",\"yard\",\n  \"year\",\"yellow\",\"yes\",\"yesterday\",\"yet\",\"you\",\"young\",\"younger\",\n  \"your\",\"yourself\",\"youth\",\"zero\",\"zebra\",\"zipper\",\"zoo\",\"zulu\"\n];\n\nfunction words(options) {\n  // initalize random number generator for words if options.seed is provided\n  const random = options?.seed ? new seedrandom(options.seed) : null;\n\n  function word() {\n    if (options && options.maxLength > 1) {\n      return generateWordWithMaxLength();\n    } else {\n      return generateRandomWord();\n    }\n  }\n\n  function generateWordWithMaxLength() {\n    var rightSize = false;\n    var wordUsed;\n    while (!rightSize) {  \n      wordUsed = generateRandomWord();\n      if(wordUsed.length <= options.maxLength) {\n        rightSize = true;\n      }\n\n    }\n    return wordUsed;\n  }\n\n  function generateRandomWord() {\n    return wordList[randInt(wordList.length)];\n  }\n\n  // random int as seeded by options.seed if applicable, or Math.random() otherwise\n  function randInt(lessThan) {\n    const r = random ? random() : Math.random();\n    return Math.floor(r * lessThan);\n  }\n\n  // No arguments = generate one word\n  if (typeof(options) === 'undefined') {\n    return word();\n  }\n\n  // Just a number = return that many words\n  if (typeof(options) === 'number') {\n    options = { exactly: options };\n  }\n\n  // options supported: exactly, min, max, join\n  if (options.exactly) {\n    options.min = options.exactly;\n    options.max = options.exactly;\n  }\n  \n  // not a number = one word par string\n  if (typeof(options.wordsPerString) !== 'number') {\n    options.wordsPerString = 1;\n  }\n\n  //not a function = returns the raw word\n  if (typeof(options.formatter) !== 'function') {\n    options.formatter = (word) => word;\n  }\n\n  //not a string = separator is a space\n  if (typeof(options.separator) !== 'string') {\n    options.separator = ' ';\n  }\n\n  var total = options.min + randInt(options.max + 1 - options.min);\n  var results = [];\n  var token = '';\n  var relativeIndex = 0;\n\n  for (var i = 0; (i < total * options.wordsPerString); i++) {\n    if (relativeIndex === options.wordsPerString - 1) {\n      token += options.formatter(word(), relativeIndex);\n    }\n    else {\n      token += options.formatter(word(), relativeIndex) + options.separator;\n    }\n    relativeIndex++;\n    if ((i + 1) % options.wordsPerString === 0) {\n      results.push(token);\n      token = ''; \n      relativeIndex = 0;\n    }\n   \n  }\n  if (typeof options.join === 'string') {\n    results = results.join(options.join);\n  }\n\n  return results;\n}\n\nvar randomWords$1 = words;\n// Export the word list as it is often useful\nwords.wordList = wordList;\n\nvar rw = /*@__PURE__*/getDefaultExportFromCjs(randomWords$1);\n\n/**\n * Uses the `seedrandom` package to replace Math.random() with a seedable PRNG.\n *\n * @param seed An optional seed. If none is given, a random seed will be generated.\n * @returns The seed value.\n */\nfunction setSeed(seed = Math.random().toString()) {\n    Math.random = seedrandom$3(seed);\n    return seed;\n}\nfunction repeat(array, repetitions, unpack = false) {\n    const arr_isArray = Array.isArray(array);\n    const rep_isArray = Array.isArray(repetitions);\n    // if array is not an array, then we just repeat the item\n    if (!arr_isArray) {\n        if (!rep_isArray) {\n            array = [array];\n            repetitions = [repetitions];\n        }\n        else {\n            repetitions = [repetitions[0]];\n            console.log(\"Unclear parameters given to randomization.repeat. Multiple set sizes specified, but only one item exists to sample. Proceeding using the first set size.\");\n        }\n    }\n    else {\n        // if repetitions is not an array, but array is, then we\n        // repeat repetitions for each entry in array\n        if (!rep_isArray) {\n            let reps = [];\n            for (let i = 0; i < array.length; i++) {\n                reps.push(repetitions);\n            }\n            repetitions = reps;\n        }\n        else {\n            if (array.length != repetitions.length) {\n                console.warn(\"Unclear parameters given to randomization.repeat. Items and repetitions are unequal lengths. Behavior may not be as expected.\");\n                // throw warning if repetitions is too short, use first rep ONLY.\n                if (repetitions.length < array.length) {\n                    let reps = [];\n                    for (let i = 0; i < array.length; i++) {\n                        reps.push(repetitions);\n                    }\n                    repetitions = reps;\n                }\n                else {\n                    // throw warning if too long, and then use the first N\n                    repetitions = repetitions.slice(0, array.length);\n                }\n            }\n        }\n    }\n    // should be clear at this point to assume that array and repetitions are arrays with == length\n    let allsamples = [];\n    for (let i = 0; i < array.length; i++) {\n        for (let j = 0; j < repetitions[i]; j++) {\n            if (array[i] == null || typeof array[i] != \"object\") {\n                allsamples.push(array[i]);\n            }\n            else {\n                allsamples.push(Object.assign({}, array[i]));\n            }\n        }\n    }\n    let out = shuffle(allsamples);\n    if (unpack) {\n        out = unpackArray(out);\n    }\n    return out;\n}\nfunction shuffle(array) {\n    if (!Array.isArray(array)) {\n        console.error(\"Argument to shuffle() must be an array.\");\n    }\n    const copy_array = array.slice(0);\n    let m = copy_array.length, t, i;\n    // While there remain elements to shuffle…\n    while (m) {\n        // Pick a remaining element…\n        i = Math.floor(Math.random() * m--);\n        // And swap it with the current element.\n        t = copy_array[m];\n        copy_array[m] = copy_array[i];\n        copy_array[i] = t;\n    }\n    return copy_array;\n}\nfunction shuffleNoRepeats(arr, equalityTest) {\n    if (!Array.isArray(arr)) {\n        console.error(\"First argument to shuffleNoRepeats() must be an array.\");\n    }\n    if (typeof equalityTest !== \"undefined\" && typeof equalityTest !== \"function\") {\n        console.error(\"Second argument to shuffleNoRepeats() must be a function.\");\n    }\n    // define a default equalityTest\n    if (typeof equalityTest == \"undefined\") {\n        equalityTest = function (a, b) {\n            if (a === b) {\n                return true;\n            }\n            else {\n                return false;\n            }\n        };\n    }\n    const random_shuffle = shuffle(arr);\n    for (let i = 0; i < random_shuffle.length - 1; i++) {\n        if (equalityTest(random_shuffle[i], random_shuffle[i + 1])) {\n            // neighbors are equal, pick a new random neighbor to swap (not the first or last element, to avoid edge cases)\n            let random_pick = Math.floor(Math.random() * (random_shuffle.length - 2)) + 1;\n            // test to make sure the new neighbor isn't equal to the old one\n            while (equalityTest(random_shuffle[i + 1], random_shuffle[random_pick]) ||\n                equalityTest(random_shuffle[i + 1], random_shuffle[random_pick + 1]) ||\n                equalityTest(random_shuffle[i + 1], random_shuffle[random_pick - 1]) ||\n                equalityTest(random_shuffle[i], random_shuffle[random_pick])) {\n                random_pick = Math.floor(Math.random() * (random_shuffle.length - 2)) + 1;\n            }\n            const new_neighbor = random_shuffle[random_pick];\n            random_shuffle[random_pick] = random_shuffle[i + 1];\n            random_shuffle[i + 1] = new_neighbor;\n        }\n    }\n    return random_shuffle;\n}\nfunction shuffleAlternateGroups(arr_groups, random_group_order = false) {\n    const n_groups = arr_groups.length;\n    if (n_groups == 1) {\n        console.warn(\"shuffleAlternateGroups() was called with only one group. Defaulting to simple shuffle.\");\n        return shuffle(arr_groups[0]);\n    }\n    let group_order = [];\n    for (let i = 0; i < n_groups; i++) {\n        group_order.push(i);\n    }\n    if (random_group_order) {\n        group_order = shuffle(group_order);\n    }\n    const randomized_groups = [];\n    let min_length = null;\n    for (let i = 0; i < n_groups; i++) {\n        min_length =\n            min_length === null ? arr_groups[i].length : Math.min(min_length, arr_groups[i].length);\n        randomized_groups.push(shuffle(arr_groups[i]));\n    }\n    const out = [];\n    for (let i = 0; i < min_length; i++) {\n        for (let j = 0; j < group_order.length; j++) {\n            out.push(randomized_groups[group_order[j]][i]);\n        }\n    }\n    return out;\n}\nfunction sampleWithoutReplacement(arr, size) {\n    if (!Array.isArray(arr)) {\n        console.error(\"First argument to sampleWithoutReplacement() must be an array\");\n    }\n    if (size > arr.length) {\n        console.error(\"Cannot take a sample larger than the size of the set of items to sample.\");\n    }\n    return shuffle(arr).slice(0, size);\n}\nfunction sampleWithReplacement(arr, size, weights) {\n    if (!Array.isArray(arr)) {\n        console.error(\"First argument to sampleWithReplacement() must be an array\");\n    }\n    const normalized_weights = [];\n    if (typeof weights !== \"undefined\") {\n        if (weights.length !== arr.length) {\n            console.error(\"The length of the weights array must equal the length of the array \" +\n                \"to be sampled from.\");\n        }\n        let weight_sum = 0;\n        for (const weight of weights) {\n            weight_sum += weight;\n        }\n        for (const weight of weights) {\n            normalized_weights.push(weight / weight_sum);\n        }\n    }\n    else {\n        for (let i = 0; i < arr.length; i++) {\n            normalized_weights.push(1 / arr.length);\n        }\n    }\n    const cumulative_weights = [normalized_weights[0]];\n    for (let i = 1; i < normalized_weights.length; i++) {\n        cumulative_weights.push(normalized_weights[i] + cumulative_weights[i - 1]);\n    }\n    const samp = [];\n    for (let i = 0; i < size; i++) {\n        const rnd = Math.random();\n        let index = 0;\n        while (rnd > cumulative_weights[index]) {\n            index++;\n        }\n        samp.push(arr[index]);\n    }\n    return samp;\n}\nfunction factorial(factors, repetitions = 1, unpack = false) {\n    let design = [{}];\n    for (const [factorName, factor] of Object.entries(factors)) {\n        const new_design = [];\n        for (const level of factor) {\n            for (const cell of design) {\n                new_design.push(Object.assign(Object.assign({}, cell), { [factorName]: level }));\n            }\n        }\n        design = new_design;\n    }\n    return repeat(design, repetitions, unpack);\n}\nfunction randomID(length = 32) {\n    let result = \"\";\n    const chars = \"0123456789abcdefghjklmnopqrstuvwxyz\";\n    for (let i = 0; i < length; i++) {\n        result += chars[Math.floor(Math.random() * chars.length)];\n    }\n    return result;\n}\n/**\n * Generate a random integer from `lower` to `upper`, inclusive of both end points.\n * @param lower The lowest value it is possible to generate\n * @param upper The highest value it is possible to generate\n * @returns A random integer\n */\nfunction randomInt(lower, upper) {\n    if (upper < lower) {\n        throw new Error(\"Upper boundary must be less than or equal to lower boundary\");\n    }\n    return lower + Math.floor(Math.random() * (upper - lower + 1));\n}\n/**\n * Generates a random sample from a Bernoulli distribution.\n * @param p The probability of sampling 1.\n * @returns 0, with probability 1-p, or 1, with probability p.\n */\nfunction sampleBernoulli(p) {\n    return Math.random() <= p ? 1 : 0;\n}\nfunction sampleNormal(mean, standard_deviation) {\n    return randn_bm() * standard_deviation + mean;\n}\nfunction sampleExponential(rate) {\n    return -Math.log(Math.random()) / rate;\n}\nfunction sampleExGaussian(mean, standard_deviation, rate, positive = false) {\n    let s = sampleNormal(mean, standard_deviation) + sampleExponential(rate);\n    if (positive) {\n        while (s <= 0) {\n            s = sampleNormal(mean, standard_deviation) + sampleExponential(rate);\n        }\n    }\n    return s;\n}\n/**\n * Generate one or more random words.\n *\n * This is a wrapper function for the {@link https://www.npmjs.com/package/random-words `random-words` npm package}.\n *\n * @param opts An object with optional properties `min`, `max`, `exactly`,\n * `join`, `maxLength`, `wordsPerString`, `separator`, and `formatter`.\n *\n * @returns An array of words or a single string, depending on parameter choices.\n */\nfunction randomWords(opts) {\n    return rw(opts);\n}\n// Box-Muller transformation for a random sample from normal distribution with mean = 0, std = 1\n// https://stackoverflow.com/a/36481059/3726673\nfunction randn_bm() {\n    var u = 0, v = 0;\n    while (u === 0)\n        u = Math.random(); //Converting [0,1) to (0,1)\n    while (v === 0)\n        v = Math.random();\n    return Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v);\n}\nfunction unpackArray(array) {\n    const out = {};\n    for (const x of array) {\n        for (const key of Object.keys(x)) {\n            if (typeof out[key] === \"undefined\") {\n                out[key] = [];\n            }\n            out[key].push(x[key]);\n        }\n    }\n    return out;\n}\n\nvar randomization = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    factorial: factorial,\n    randomID: randomID,\n    randomInt: randomInt,\n    randomWords: randomWords,\n    repeat: repeat,\n    sampleBernoulli: sampleBernoulli,\n    sampleExGaussian: sampleExGaussian,\n    sampleExponential: sampleExponential,\n    sampleNormal: sampleNormal,\n    sampleWithReplacement: sampleWithReplacement,\n    sampleWithoutReplacement: sampleWithoutReplacement,\n    setSeed: setSeed,\n    shuffle: shuffle,\n    shuffleAlternateGroups: shuffleAlternateGroups,\n    shuffleNoRepeats: shuffleNoRepeats\n});\n\n/**\n * Gets information about the Mechanical Turk Environment, HIT, Assignment, and Worker\n * by parsing the URL variables that Mechanical Turk generates.\n * @returns An object containing information about the Mechanical Turk Environment, HIT, Assignment, and Worker.\n */\nfunction turkInfo() {\n    const turk = {\n        previewMode: false,\n        outsideTurk: false,\n        hitId: \"INVALID_URL_PARAMETER\",\n        assignmentId: \"INVALID_URL_PARAMETER\",\n        workerId: \"INVALID_URL_PARAMETER\",\n        turkSubmitTo: \"INVALID_URL_PARAMETER\",\n    };\n    const param = function (url, name) {\n        name = name.replace(/[\\[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\");\n        const regexS = \"[\\\\?&]\" + name + \"=([^&#]*)\";\n        const regex = new RegExp(regexS);\n        const results = regex.exec(url);\n        return results == null ? \"\" : results[1];\n    };\n    const src = param(window.location.href, \"assignmentId\")\n        ? window.location.href\n        : document.referrer;\n    const keys = [\"assignmentId\", \"hitId\", \"workerId\", \"turkSubmitTo\"];\n    keys.map(function (key) {\n        turk[key] = unescape(param(src, key));\n    });\n    turk.previewMode = turk.assignmentId == \"ASSIGNMENT_ID_NOT_AVAILABLE\";\n    turk.outsideTurk =\n        !turk.previewMode && turk.hitId === \"\" && turk.assignmentId == \"\" && turk.workerId == \"\";\n    return turk;\n}\n/**\n * Send data to Mechnical Turk for storage.\n * @param data An object containing `key:value` pairs to send to Mechanical Turk. Values\n * cannot contain nested objects, arrays, or functions.\n * @returns Nothing\n */\nfunction submitToTurk(data) {\n    const turk = turkInfo();\n    const assignmentId = turk.assignmentId;\n    const turkSubmitTo = turk.turkSubmitTo;\n    if (!assignmentId || !turkSubmitTo)\n        return;\n    const form = document.createElement(\"form\");\n    form.method = \"POST\";\n    form.action = turkSubmitTo + \"/mturk/externalSubmit?assignmentId=\" + assignmentId;\n    for (const key in data) {\n        if (data.hasOwnProperty(key)) {\n            const hiddenField = document.createElement(\"input\");\n            hiddenField.type = \"hidden\";\n            hiddenField.name = key;\n            hiddenField.id = key;\n            hiddenField.value = data[key];\n            form.appendChild(hiddenField);\n        }\n    }\n    document.body.appendChild(form);\n    form.submit();\n}\n\nvar turk = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    submitToTurk: submitToTurk,\n    turkInfo: turkInfo\n});\n\nclass TimelineNode {\n    // constructor\n    constructor(jsPsych, parameters, parent, relativeID) {\n        this.jsPsych = jsPsych;\n        // track progress through the node\n        this.progress = {\n            current_location: -1,\n            current_variable_set: 0,\n            current_repetition: 0,\n            current_iteration: 0,\n            done: false,\n        };\n        // store a link to the parent of this node\n        this.parent_node = parent;\n        // create the ID for this node\n        this.relative_id = typeof parent === \"undefined\" ? 0 : relativeID;\n        // check if there is a timeline parameter\n        // if there is, then this node has its own timeline\n        if (typeof parameters.timeline !== \"undefined\") {\n            // create timeline properties\n            this.timeline_parameters = {\n                timeline: [],\n                loop_function: parameters.loop_function,\n                conditional_function: parameters.conditional_function,\n                sample: parameters.sample,\n                randomize_order: typeof parameters.randomize_order == \"undefined\" ? false : parameters.randomize_order,\n                repetitions: typeof parameters.repetitions == \"undefined\" ? 1 : parameters.repetitions,\n                timeline_variables: typeof parameters.timeline_variables == \"undefined\"\n                    ? [{}]\n                    : parameters.timeline_variables,\n                on_timeline_finish: parameters.on_timeline_finish,\n                on_timeline_start: parameters.on_timeline_start,\n            };\n            this.setTimelineVariablesOrder();\n            // extract all of the node level data and parameters\n            // but remove all of the timeline-level specific information\n            // since this will be used to copy things down hierarchically\n            var node_data = Object.assign({}, parameters);\n            delete node_data.timeline;\n            delete node_data.conditional_function;\n            delete node_data.loop_function;\n            delete node_data.randomize_order;\n            delete node_data.repetitions;\n            delete node_data.timeline_variables;\n            delete node_data.sample;\n            delete node_data.on_timeline_start;\n            delete node_data.on_timeline_finish;\n            this.node_trial_data = node_data; // store for later...\n            // create a TimelineNode for each element in the timeline\n            for (var i = 0; i < parameters.timeline.length; i++) {\n                // merge parameters\n                var merged_parameters = Object.assign({}, node_data, parameters.timeline[i]);\n                // merge any data from the parent node into child nodes\n                if (typeof node_data.data == \"object\" && typeof parameters.timeline[i].data == \"object\") {\n                    var merged_data = Object.assign({}, node_data.data, parameters.timeline[i].data);\n                    merged_parameters.data = merged_data;\n                }\n                this.timeline_parameters.timeline.push(new TimelineNode(this.jsPsych, merged_parameters, this, i));\n            }\n        }\n        // if there is no timeline parameter, then this node is a trial node\n        else {\n            // check to see if a valid trial type is defined\n            if (typeof parameters.type === \"undefined\") {\n                console.error('Trial level node is missing the \"type\" parameter. The parameters for the node are: ' +\n                    JSON.stringify(parameters));\n            }\n            // create a deep copy of the parameters for the trial\n            this.trial_parameters = Object.assign({}, parameters);\n        }\n    }\n    // recursively get the next trial to run.\n    // if this node is a leaf (trial), then return the trial.\n    // otherwise, recursively find the next trial in the child timeline.\n    trial() {\n        if (typeof this.timeline_parameters == \"undefined\") {\n            // returns a clone of the trial_parameters to\n            // protect functions.\n            return deepCopy(this.trial_parameters);\n        }\n        else {\n            if (this.progress.current_location >= this.timeline_parameters.timeline.length) {\n                return null;\n            }\n            else {\n                return this.timeline_parameters.timeline[this.progress.current_location].trial();\n            }\n        }\n    }\n    markCurrentTrialComplete() {\n        if (typeof this.timeline_parameters === \"undefined\") {\n            this.progress.done = true;\n        }\n        else {\n            this.timeline_parameters.timeline[this.progress.current_location].markCurrentTrialComplete();\n        }\n    }\n    nextRepetiton() {\n        this.setTimelineVariablesOrder();\n        this.progress.current_location = -1;\n        this.progress.current_variable_set = 0;\n        this.progress.current_repetition++;\n        for (var i = 0; i < this.timeline_parameters.timeline.length; i++) {\n            this.timeline_parameters.timeline[i].reset();\n        }\n    }\n    // set the order for going through the timeline variables array\n    setTimelineVariablesOrder() {\n        const timeline_parameters = this.timeline_parameters;\n        // check to make sure this node has variables\n        if (typeof timeline_parameters === \"undefined\" ||\n            typeof timeline_parameters.timeline_variables === \"undefined\") {\n            return;\n        }\n        var order = [];\n        for (var i = 0; i < timeline_parameters.timeline_variables.length; i++) {\n            order.push(i);\n        }\n        if (typeof timeline_parameters.sample !== \"undefined\") {\n            if (timeline_parameters.sample.type == \"custom\") {\n                order = timeline_parameters.sample.fn(order);\n            }\n            else if (timeline_parameters.sample.type == \"with-replacement\") {\n                order = sampleWithReplacement(order, timeline_parameters.sample.size, timeline_parameters.sample.weights);\n            }\n            else if (timeline_parameters.sample.type == \"without-replacement\") {\n                order = sampleWithoutReplacement(order, timeline_parameters.sample.size);\n            }\n            else if (timeline_parameters.sample.type == \"fixed-repetitions\") {\n                order = repeat(order, timeline_parameters.sample.size, false);\n            }\n            else if (timeline_parameters.sample.type == \"alternate-groups\") {\n                order = shuffleAlternateGroups(timeline_parameters.sample.groups, timeline_parameters.sample.randomize_group_order);\n            }\n            else {\n                console.error('Invalid type in timeline sample parameters. Valid options for type are \"custom\", \"with-replacement\", \"without-replacement\", \"fixed-repetitions\", and \"alternate-groups\"');\n            }\n        }\n        if (timeline_parameters.randomize_order) {\n            order = shuffle(order);\n        }\n        this.progress.order = order;\n    }\n    // next variable set\n    nextSet() {\n        this.progress.current_location = -1;\n        this.progress.current_variable_set++;\n        for (var i = 0; i < this.timeline_parameters.timeline.length; i++) {\n            this.timeline_parameters.timeline[i].reset();\n        }\n    }\n    // update the current trial node to be completed\n    // returns true if the node is complete after advance (all subnodes are also complete)\n    // returns false otherwise\n    advance() {\n        const progress = this.progress;\n        const timeline_parameters = this.timeline_parameters;\n        const internal = this.jsPsych.internal;\n        // first check to see if done\n        if (progress.done) {\n            return true;\n        }\n        // if node has not started yet (progress.current_location == -1),\n        // then try to start the node.\n        if (progress.current_location == -1) {\n            // check for on_timeline_start and conditonal function on nodes with timelines\n            if (typeof timeline_parameters !== \"undefined\") {\n                // only run the conditional function if this is the first repetition of the timeline when\n                // repetitions > 1, and only when on the first variable set\n                if (typeof timeline_parameters.conditional_function !== \"undefined\" &&\n                    progress.current_repetition == 0 &&\n                    progress.current_variable_set == 0) {\n                    internal.call_immediate = true;\n                    var conditional_result = timeline_parameters.conditional_function();\n                    internal.call_immediate = false;\n                    // if the conditional_function() returns false, then the timeline\n                    // doesn't run and is marked as complete.\n                    if (conditional_result == false) {\n                        progress.done = true;\n                        return true;\n                    }\n                }\n                // if we reach this point then the node has its own timeline and will start\n                // so we need to check if there is an on_timeline_start function if we are on the first variable set\n                if (typeof timeline_parameters.on_timeline_start !== \"undefined\" &&\n                    progress.current_variable_set == 0) {\n                    timeline_parameters.on_timeline_start();\n                }\n            }\n            // if we reach this point, then either the node doesn't have a timeline of the\n            // conditional function returned true and it can start\n            progress.current_location = 0;\n            // call advance again on this node now that it is pointing to a new location\n            return this.advance();\n        }\n        // if this node has a timeline, propogate down to the current trial.\n        if (typeof timeline_parameters !== \"undefined\") {\n            var have_node_to_run = false;\n            // keep incrementing the location in the timeline until one of the nodes reached is incomplete\n            while (progress.current_location < timeline_parameters.timeline.length &&\n                have_node_to_run == false) {\n                // check to see if the node currently pointed at is done\n                var target_complete = timeline_parameters.timeline[progress.current_location].advance();\n                if (!target_complete) {\n                    have_node_to_run = true;\n                    return false;\n                }\n                else {\n                    progress.current_location++;\n                }\n            }\n            // if we've reached the end of the timeline (which, if the code is here, we have)\n            // there are a few steps to see what to do next...\n            // first, check the timeline_variables to see if we need to loop through again\n            // with a new set of variables\n            if (progress.current_variable_set < progress.order.length - 1) {\n                // reset the progress of the node to be with the new set\n                this.nextSet();\n                // then try to advance this node again.\n                return this.advance();\n            }\n            // if we're all done with the timeline_variables, then check to see if there are more repetitions\n            else if (progress.current_repetition < timeline_parameters.repetitions - 1) {\n                this.nextRepetiton();\n                // check to see if there is an on_timeline_finish function\n                if (typeof timeline_parameters.on_timeline_finish !== \"undefined\") {\n                    timeline_parameters.on_timeline_finish();\n                }\n                return this.advance();\n            }\n            // if we're all done with the repetitions...\n            else {\n                // check to see if there is an on_timeline_finish function\n                if (typeof timeline_parameters.on_timeline_finish !== \"undefined\") {\n                    timeline_parameters.on_timeline_finish();\n                }\n                // if we're all done with the repetitions, check if there is a loop function.\n                if (typeof timeline_parameters.loop_function !== \"undefined\") {\n                    internal.call_immediate = true;\n                    if (timeline_parameters.loop_function(this.generatedData())) {\n                        this.reset();\n                        internal.call_immediate = false;\n                        return this.parent_node.advance();\n                    }\n                    else {\n                        progress.done = true;\n                        internal.call_immediate = false;\n                        return true;\n                    }\n                }\n            }\n            // no more loops on this timeline, we're done!\n            progress.done = true;\n            return true;\n        }\n    }\n    // check the status of the done flag\n    isComplete() {\n        return this.progress.done;\n    }\n    // getter method for timeline variables\n    getTimelineVariableValue(variable_name) {\n        if (typeof this.timeline_parameters == \"undefined\") {\n            return undefined;\n        }\n        var v = this.timeline_parameters.timeline_variables[this.progress.order[this.progress.current_variable_set]][variable_name];\n        return v;\n    }\n    // recursive upward search for timeline variables\n    findTimelineVariable(variable_name) {\n        var v = this.getTimelineVariableValue(variable_name);\n        if (typeof v == \"undefined\") {\n            if (typeof this.parent_node !== \"undefined\") {\n                return this.parent_node.findTimelineVariable(variable_name);\n            }\n            else {\n                return undefined;\n            }\n        }\n        else {\n            return v;\n        }\n    }\n    // recursive downward search for active trial to extract timeline variable\n    timelineVariable(variable_name) {\n        if (typeof this.timeline_parameters == \"undefined\") {\n            const val = this.findTimelineVariable(variable_name);\n            if (typeof val === \"undefined\") {\n                console.warn(\"Timeline variable \" + variable_name + \" not found.\");\n            }\n            return val;\n        }\n        else {\n            // if progress.current_location is -1, then the timeline variable is being evaluated\n            // in a function that runs prior to the trial starting, so we should treat that trial\n            // as being the active trial for purposes of finding the value of the timeline variable\n            var loc = Math.max(0, this.progress.current_location);\n            // if loc is greater than the number of elements on this timeline, then the timeline\n            // variable is being evaluated in a function that runs after the trial on the timeline\n            // are complete but before advancing to the next (like a loop_function).\n            // treat the last active trial as the active trial for this purpose.\n            if (loc == this.timeline_parameters.timeline.length) {\n                loc = loc - 1;\n            }\n            // now find the variable\n            const val = this.timeline_parameters.timeline[loc].timelineVariable(variable_name);\n            if (typeof val === \"undefined\") {\n                console.warn(\"Timeline variable \" + variable_name + \" not found.\");\n            }\n            return val;\n        }\n    }\n    // recursively get all the timeline variables for this trial\n    allTimelineVariables() {\n        var all_tvs = this.allTimelineVariablesNames();\n        var all_tvs_vals = {};\n        for (var i = 0; i < all_tvs.length; i++) {\n            all_tvs_vals[all_tvs[i]] = this.timelineVariable(all_tvs[i]);\n        }\n        return all_tvs_vals;\n    }\n    // helper to get all the names at this stage.\n    allTimelineVariablesNames(so_far = []) {\n        if (typeof this.timeline_parameters !== \"undefined\") {\n            so_far = so_far.concat(Object.keys(this.timeline_parameters.timeline_variables[this.progress.order[this.progress.current_variable_set]]));\n            // if progress.current_location is -1, then the timeline variable is being evaluated\n            // in a function that runs prior to the trial starting, so we should treat that trial\n            // as being the active trial for purposes of finding the value of the timeline variable\n            var loc = Math.max(0, this.progress.current_location);\n            // if loc is greater than the number of elements on this timeline, then the timeline\n            // variable is being evaluated in a function that runs after the trial on the timeline\n            // are complete but before advancing to the next (like a loop_function).\n            // treat the last active trial as the active trial for this purpose.\n            if (loc == this.timeline_parameters.timeline.length) {\n                loc = loc - 1;\n            }\n            // now find the variable\n            return this.timeline_parameters.timeline[loc].allTimelineVariablesNames(so_far);\n        }\n        if (typeof this.timeline_parameters == \"undefined\") {\n            return so_far;\n        }\n    }\n    // recursively get the number of **trials** contained in the timeline\n    // assuming that while loops execute exactly once and if conditionals\n    // always run\n    length() {\n        var length = 0;\n        if (typeof this.timeline_parameters !== \"undefined\") {\n            for (var i = 0; i < this.timeline_parameters.timeline.length; i++) {\n                length += this.timeline_parameters.timeline[i].length();\n            }\n        }\n        else {\n            return 1;\n        }\n        return length;\n    }\n    // return the percentage of trials completed, grouped at the first child level\n    // counts a set of trials as complete when the child node is done\n    percentComplete() {\n        var total_trials = this.length();\n        var completed_trials = 0;\n        for (var i = 0; i < this.timeline_parameters.timeline.length; i++) {\n            if (this.timeline_parameters.timeline[i].isComplete()) {\n                completed_trials += this.timeline_parameters.timeline[i].length();\n            }\n        }\n        return (completed_trials / total_trials) * 100;\n    }\n    // resets the node and all subnodes to original state\n    // but increments the current_iteration counter\n    reset() {\n        this.progress.current_location = -1;\n        this.progress.current_repetition = 0;\n        this.progress.current_variable_set = 0;\n        this.progress.current_iteration++;\n        this.progress.done = false;\n        this.setTimelineVariablesOrder();\n        if (typeof this.timeline_parameters != \"undefined\") {\n            for (var i = 0; i < this.timeline_parameters.timeline.length; i++) {\n                this.timeline_parameters.timeline[i].reset();\n            }\n        }\n    }\n    // mark this node as finished\n    end() {\n        this.progress.done = true;\n    }\n    // recursively end whatever sub-node is running the current trial\n    endActiveNode() {\n        if (typeof this.timeline_parameters == \"undefined\") {\n            this.end();\n            this.parent_node.end();\n        }\n        else {\n            this.timeline_parameters.timeline[this.progress.current_location].endActiveNode();\n        }\n    }\n    // get a unique ID associated with this node\n    // the ID reflects the current iteration through this node.\n    ID() {\n        var id = \"\";\n        if (typeof this.parent_node == \"undefined\") {\n            return \"0.\" + this.progress.current_iteration;\n        }\n        else {\n            id += this.parent_node.ID() + \"-\";\n            id += this.relative_id + \".\" + this.progress.current_iteration;\n            return id;\n        }\n    }\n    // get the ID of the active trial\n    activeID() {\n        if (typeof this.timeline_parameters == \"undefined\") {\n            return this.ID();\n        }\n        else {\n            return this.timeline_parameters.timeline[this.progress.current_location].activeID();\n        }\n    }\n    // get all the data generated within this node\n    generatedData() {\n        return this.jsPsych.data.getDataByTimelineNode(this.ID());\n    }\n    // get all the trials of a particular type\n    trialsOfType(type) {\n        if (typeof this.timeline_parameters == \"undefined\") {\n            if (this.trial_parameters.type == type) {\n                return this.trial_parameters;\n            }\n            else {\n                return [];\n            }\n        }\n        else {\n            var trials = [];\n            for (var i = 0; i < this.timeline_parameters.timeline.length; i++) {\n                var t = this.timeline_parameters.timeline[i].trialsOfType(type);\n                trials = trials.concat(t);\n            }\n            return trials;\n        }\n    }\n    // add new trials to end of this timeline\n    insert(parameters) {\n        if (typeof this.timeline_parameters === \"undefined\") {\n            console.error(\"Cannot add new trials to a trial-level node.\");\n        }\n        else {\n            this.timeline_parameters.timeline.push(new TimelineNode(this.jsPsych, Object.assign(Object.assign({}, this.node_trial_data), parameters), this, this.timeline_parameters.timeline.length));\n        }\n    }\n}\n\nfunction delay(ms) {\n    return new Promise((resolve) => setTimeout(resolve, ms));\n}\nclass JsPsych {\n    version() {\n        return version;\n    }\n    constructor(options) {\n        this.extensions = {};\n        this.turk = turk;\n        this.randomization = randomization;\n        this.utils = utils;\n        //\n        // private variables\n        //\n        /**\n         * options\n         */\n        this.opts = {};\n        // flow control\n        this.global_trial_index = 0;\n        this.current_trial = {};\n        this.current_trial_finished = false;\n        /**\n         * is the experiment paused?\n         */\n        this.paused = false;\n        this.waiting = false;\n        /**\n         * is the page retrieved directly via file:// protocol (true) or hosted on a server (false)?\n         */\n        this.file_protocol = false;\n        /**\n         * is the experiment running in `simulate()` mode\n         */\n        this.simulation_mode = null;\n        // storing a single webaudio context to prevent problems with multiple inits\n        // of jsPsych\n        this.webaudio_context = null;\n        this.internal = {\n            /**\n             * this flag is used to determine whether we are in a scope where\n             * jsPsych.timelineVariable() should be executed immediately or\n             * whether it should return a function to access the variable later.\n             *\n             **/\n            call_immediate: false,\n        };\n        this.progress_bar_amount = 0;\n        // override default options if user specifies an option\n        options = Object.assign({ display_element: undefined, on_finish: () => { }, on_trial_start: () => { }, on_trial_finish: () => { }, on_data_update: () => { }, on_interaction_data_update: () => { }, on_close: () => { }, use_webaudio: true, exclusions: {}, show_progress_bar: false, message_progress_bar: \"Completion Progress\", auto_update_progress_bar: true, default_iti: 0, minimum_valid_rt: 0, experiment_width: null, override_safe_mode: false, case_sensitive_responses: false, extensions: [] }, options);\n        this.opts = options;\n        autoBind$1(this); // so we can pass JsPsych methods as callbacks and `this` remains the JsPsych instance\n        this.webaudio_context =\n            typeof window !== \"undefined\" && typeof window.AudioContext !== \"undefined\"\n                ? new AudioContext()\n                : null;\n        // detect whether page is running in browser as a local file, and if so, disable web audio and video preloading to prevent CORS issues\n        if (window.location.protocol == \"file:\" &&\n            (options.override_safe_mode === false || typeof options.override_safe_mode === \"undefined\")) {\n            options.use_webaudio = false;\n            this.file_protocol = true;\n            console.warn(\"jsPsych detected that it is running via the file:// protocol and not on a web server. \" +\n                \"To prevent issues with cross-origin requests, Web Audio and video preloading have been disabled. \" +\n                \"If you would like to override this setting, you can set 'override_safe_mode' to 'true' in initJsPsych. \" +\n                \"For more information, see: https://www.jspsych.org/overview/running-experiments\");\n        }\n        // initialize modules\n        this.data = new JsPsychData(this);\n        this.pluginAPI = createJointPluginAPIObject(this);\n        // create instances of extensions\n        for (const extension of options.extensions) {\n            this.extensions[extension.type.info.name] = new extension.type(this);\n        }\n        // initialize audio context based on options and browser capabilities\n        this.pluginAPI.initAudio();\n    }\n    /**\n     * Starts an experiment using the provided timeline and returns a promise that is resolved when\n     * the experiment is finished.\n     *\n     * @param timeline The timeline to be run\n     */\n    run(timeline) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (typeof timeline === \"undefined\") {\n                console.error(\"No timeline declared in jsPsych.run. Cannot start experiment.\");\n            }\n            if (timeline.length === 0) {\n                console.error(\"No trials have been added to the timeline (the timeline is an empty array). Cannot start experiment.\");\n            }\n            // create experiment timeline\n            this.timelineDescription = timeline;\n            this.timeline = new TimelineNode(this, { timeline });\n            yield this.prepareDom();\n            yield this.checkExclusions(this.opts.exclusions);\n            yield this.loadExtensions(this.opts.extensions);\n            document.documentElement.setAttribute(\"jspsych\", \"present\");\n            this.startExperiment();\n            yield this.finished;\n        });\n    }\n    simulate(timeline, simulation_mode = \"data-only\", simulation_options = {}) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.simulation_mode = simulation_mode;\n            this.simulation_options = simulation_options;\n            yield this.run(timeline);\n        });\n    }\n    getProgress() {\n        return {\n            total_trials: typeof this.timeline === \"undefined\" ? undefined : this.timeline.length(),\n            current_trial_global: this.global_trial_index,\n            percent_complete: typeof this.timeline === \"undefined\" ? 0 : this.timeline.percentComplete(),\n        };\n    }\n    getStartTime() {\n        return this.exp_start_time;\n    }\n    getTotalTime() {\n        if (typeof this.exp_start_time === \"undefined\") {\n            return 0;\n        }\n        return new Date().getTime() - this.exp_start_time.getTime();\n    }\n    getDisplayElement() {\n        return this.DOM_target;\n    }\n    getDisplayContainerElement() {\n        return this.DOM_container;\n    }\n    finishTrial(data = {}) {\n        var _a;\n        if (this.current_trial_finished) {\n            return;\n        }\n        this.current_trial_finished = true;\n        // remove any CSS classes that were added to the DOM via css_classes parameter\n        if (typeof this.current_trial.css_classes !== \"undefined\" &&\n            Array.isArray(this.current_trial.css_classes)) {\n            this.DOM_target.classList.remove(...this.current_trial.css_classes);\n        }\n        // write the data from the trial\n        this.data.write(data);\n        // get back the data with all of the defaults in\n        const trial_data = this.data.getLastTrialData();\n        // for trial-level callbacks, we just want to pass in a reference to the values\n        // of the DataCollection, for easy access and editing.\n        const trial_data_values = trial_data.values()[0];\n        const current_trial = this.current_trial;\n        if (typeof current_trial.save_trial_parameters === \"object\") {\n            for (const key of Object.keys(current_trial.save_trial_parameters)) {\n                const key_val = current_trial.save_trial_parameters[key];\n                if (key_val === true) {\n                    if (typeof current_trial[key] === \"undefined\") {\n                        console.warn(`Invalid parameter specified in save_trial_parameters. Trial has no property called \"${key}\".`);\n                    }\n                    else if (typeof current_trial[key] === \"function\") {\n                        trial_data_values[key] = current_trial[key].toString();\n                    }\n                    else {\n                        trial_data_values[key] = current_trial[key];\n                    }\n                }\n                if (key_val === false) {\n                    // we don't allow internal_node_id or trial_index to be deleted because it would break other things\n                    if (key !== \"internal_node_id\" && key !== \"trial_index\") {\n                        delete trial_data_values[key];\n                    }\n                }\n            }\n        }\n        // handle extension callbacks\n        const extensionCallbackResults = ((_a = current_trial.extensions) !== null && _a !== void 0 ? _a : []).map((extension) => this.extensions[extension.type.info.name].on_finish(extension.params));\n        const onExtensionCallbacksFinished = () => {\n            // about to execute lots of callbacks, so switch context.\n            this.internal.call_immediate = true;\n            // handle callback at plugin level\n            if (typeof current_trial.on_finish === \"function\") {\n                current_trial.on_finish(trial_data_values);\n            }\n            // handle callback at whole-experiment level\n            this.opts.on_trial_finish(trial_data_values);\n            // after the above callbacks are complete, then the data should be finalized\n            // for this trial. call the on_data_update handler, passing in the same\n            // data object that just went through the trial's finish handlers.\n            this.opts.on_data_update(trial_data_values);\n            // done with callbacks\n            this.internal.call_immediate = false;\n            // wait for iti\n            if (this.simulation_mode === \"data-only\") {\n                this.nextTrial();\n            }\n            else if (typeof current_trial.post_trial_gap === null ||\n                typeof current_trial.post_trial_gap === \"undefined\") {\n                if (this.opts.default_iti > 0) {\n                    setTimeout(this.nextTrial, this.opts.default_iti);\n                }\n                else {\n                    this.nextTrial();\n                }\n            }\n            else {\n                if (current_trial.post_trial_gap > 0) {\n                    setTimeout(this.nextTrial, current_trial.post_trial_gap);\n                }\n                else {\n                    this.nextTrial();\n                }\n            }\n        };\n        // Strictly using Promise.resolve to turn all values into promises would be cleaner here, but it\n        // would require user test code to make the event loop tick after every simulated key press even\n        // if there are no async `on_finish` methods. Hence, in order to avoid a breaking change, we\n        // only rely on the event loop if at least one `on_finish` method returns a promise.\n        if (extensionCallbackResults.some((result) => typeof result.then === \"function\")) {\n            Promise.all(extensionCallbackResults.map((result) => Promise.resolve(result).then((ext_data_values) => {\n                Object.assign(trial_data_values, ext_data_values);\n            }))).then(onExtensionCallbacksFinished);\n        }\n        else {\n            for (const values of extensionCallbackResults) {\n                Object.assign(trial_data_values, values);\n            }\n            onExtensionCallbacksFinished();\n        }\n    }\n    endExperiment(end_message = \"\", data = {}) {\n        this.timeline.end_message = end_message;\n        this.timeline.end();\n        this.pluginAPI.cancelAllKeyboardResponses();\n        this.pluginAPI.clearAllTimeouts();\n        this.finishTrial(data);\n    }\n    endCurrentTimeline() {\n        this.timeline.endActiveNode();\n    }\n    getCurrentTrial() {\n        return this.current_trial;\n    }\n    getInitSettings() {\n        return this.opts;\n    }\n    getCurrentTimelineNodeID() {\n        return this.timeline.activeID();\n    }\n    timelineVariable(varname, immediate = false) {\n        if (this.internal.call_immediate || immediate === true) {\n            return this.timeline.timelineVariable(varname);\n        }\n        else {\n            return {\n                timelineVariablePlaceholder: true,\n                timelineVariableFunction: () => this.timeline.timelineVariable(varname),\n            };\n        }\n    }\n    getAllTimelineVariables() {\n        return this.timeline.allTimelineVariables();\n    }\n    addNodeToEndOfTimeline(new_timeline, preload_callback) {\n        this.timeline.insert(new_timeline);\n    }\n    pauseExperiment() {\n        this.paused = true;\n    }\n    resumeExperiment() {\n        this.paused = false;\n        if (this.waiting) {\n            this.waiting = false;\n            this.nextTrial();\n        }\n    }\n    loadFail(message) {\n        message = message || \"<p>The experiment failed to load.</p>\";\n        this.DOM_target.innerHTML = message;\n    }\n    getSafeModeStatus() {\n        return this.file_protocol;\n    }\n    getTimeline() {\n        return this.timelineDescription;\n    }\n    prepareDom() {\n        return __awaiter(this, void 0, void 0, function* () {\n            // Wait until the document is ready\n            if (document.readyState !== \"complete\") {\n                yield new Promise((resolve) => {\n                    window.addEventListener(\"load\", resolve);\n                });\n            }\n            const options = this.opts;\n            // set DOM element where jsPsych will render content\n            // if undefined, then jsPsych will use the <body> tag and the entire page\n            if (typeof options.display_element === \"undefined\") {\n                // check if there is a body element on the page\n                const body = document.querySelector(\"body\");\n                if (body === null) {\n                    document.documentElement.appendChild(document.createElement(\"body\"));\n                }\n                // using the full page, so we need the HTML element to\n                // have 100% height, and body to be full width and height with\n                // no margin\n                document.querySelector(\"html\").style.height = \"100%\";\n                document.querySelector(\"body\").style.margin = \"0px\";\n                document.querySelector(\"body\").style.height = \"100%\";\n                document.querySelector(\"body\").style.width = \"100%\";\n                options.display_element = document.querySelector(\"body\");\n            }\n            else {\n                // make sure that the display element exists on the page\n                const display = options.display_element instanceof Element\n                    ? options.display_element\n                    : document.querySelector(\"#\" + options.display_element);\n                if (display === null) {\n                    console.error(\"The display_element specified in initJsPsych() does not exist in the DOM.\");\n                }\n                else {\n                    options.display_element = display;\n                }\n            }\n            options.display_element.innerHTML =\n                '<div class=\"jspsych-content-wrapper\"><div id=\"jspsych-content\"></div></div>';\n            this.DOM_container = options.display_element;\n            this.DOM_target = document.querySelector(\"#jspsych-content\");\n            // set experiment_width if not null\n            if (options.experiment_width !== null) {\n                this.DOM_target.style.width = options.experiment_width + \"px\";\n            }\n            // add tabIndex attribute to scope event listeners\n            options.display_element.tabIndex = 0;\n            // add CSS class to DOM_target\n            if (options.display_element.className.indexOf(\"jspsych-display-element\") === -1) {\n                options.display_element.className += \" jspsych-display-element\";\n            }\n            this.DOM_target.className += \"jspsych-content\";\n            // create listeners for user browser interaction\n            this.data.createInteractionListeners();\n            // add event for closing window\n            window.addEventListener(\"beforeunload\", options.on_close);\n        });\n    }\n    loadExtensions(extensions) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // run the .initialize method of any extensions that are in use\n            // these should return a Promise to indicate when loading is complete\n            try {\n                yield Promise.all(extensions.map((extension) => this.extensions[extension.type.info.name].initialize(extension.params || {})));\n            }\n            catch (error_message) {\n                console.error(error_message);\n                throw new Error(error_message);\n            }\n        });\n    }\n    startExperiment() {\n        this.finished = new Promise((resolve) => {\n            this.resolveFinishedPromise = resolve;\n        });\n        // show progress bar if requested\n        if (this.opts.show_progress_bar === true) {\n            this.drawProgressBar(this.opts.message_progress_bar);\n        }\n        // record the start time\n        this.exp_start_time = new Date();\n        // begin!\n        this.timeline.advance();\n        this.doTrial(this.timeline.trial());\n    }\n    finishExperiment() {\n        const finish_result = this.opts.on_finish(this.data.get());\n        const done_handler = () => {\n            if (typeof this.timeline.end_message !== \"undefined\") {\n                this.DOM_target.innerHTML = this.timeline.end_message;\n            }\n            this.resolveFinishedPromise();\n        };\n        if (finish_result) {\n            Promise.resolve(finish_result).then(done_handler);\n        }\n        else {\n            done_handler();\n        }\n    }\n    nextTrial() {\n        // if experiment is paused, don't do anything.\n        if (this.paused) {\n            this.waiting = true;\n            return;\n        }\n        this.global_trial_index++;\n        // advance timeline\n        this.timeline.markCurrentTrialComplete();\n        const complete = this.timeline.advance();\n        // update progress bar if shown\n        if (this.opts.show_progress_bar === true && this.opts.auto_update_progress_bar === true) {\n            this.updateProgressBar();\n        }\n        // check if experiment is over\n        if (complete) {\n            this.finishExperiment();\n            return;\n        }\n        this.doTrial(this.timeline.trial());\n    }\n    doTrial(trial) {\n        this.current_trial = trial;\n        this.current_trial_finished = false;\n        // process all timeline variables for this trial\n        this.evaluateTimelineVariables(trial);\n        if (typeof trial.type === \"string\") {\n            throw new MigrationError(\"A string was provided as the trial's `type` parameter. Since jsPsych v7, the `type` parameter needs to be a plugin object.\");\n        }\n        // instantiate the plugin for this trial\n        trial.type = Object.assign(Object.assign({}, autoBind$1(new trial.type(this))), { info: trial.type.info });\n        // evaluate variables that are functions\n        this.evaluateFunctionParameters(trial);\n        // get default values for parameters\n        this.setDefaultValues(trial);\n        // about to execute callbacks\n        this.internal.call_immediate = true;\n        // call experiment wide callback\n        this.opts.on_trial_start(trial);\n        // call trial specific callback if it exists\n        if (typeof trial.on_start === \"function\") {\n            trial.on_start(trial);\n        }\n        // call any on_start functions for extensions\n        if (Array.isArray(trial.extensions)) {\n            for (const extension of trial.extensions) {\n                this.extensions[extension.type.info.name].on_start(extension.params);\n            }\n        }\n        // apply the focus to the element containing the experiment.\n        this.DOM_container.focus();\n        // reset the scroll on the DOM target\n        this.DOM_target.scrollTop = 0;\n        // add CSS classes to the DOM_target if they exist in trial.css_classes\n        if (typeof trial.css_classes !== \"undefined\") {\n            if (!Array.isArray(trial.css_classes) && typeof trial.css_classes === \"string\") {\n                trial.css_classes = [trial.css_classes];\n            }\n            if (Array.isArray(trial.css_classes)) {\n                this.DOM_target.classList.add(...trial.css_classes);\n            }\n        }\n        // setup on_load event callback\n        const load_callback = () => {\n            if (typeof trial.on_load === \"function\") {\n                trial.on_load();\n            }\n            // call any on_load functions for extensions\n            if (Array.isArray(trial.extensions)) {\n                for (const extension of trial.extensions) {\n                    this.extensions[extension.type.info.name].on_load(extension.params);\n                }\n            }\n        };\n        let trial_complete;\n        let trial_sim_opts;\n        let trial_sim_opts_merged;\n        if (!this.simulation_mode) {\n            trial_complete = trial.type.trial(this.DOM_target, trial, load_callback);\n        }\n        if (this.simulation_mode) {\n            // check if the trial supports simulation\n            if (trial.type.simulate) {\n                if (!trial.simulation_options) {\n                    trial_sim_opts = this.simulation_options.default;\n                }\n                if (trial.simulation_options) {\n                    if (typeof trial.simulation_options == \"string\") {\n                        if (this.simulation_options[trial.simulation_options]) {\n                            trial_sim_opts = this.simulation_options[trial.simulation_options];\n                        }\n                        else if (this.simulation_options.default) {\n                            console.log(`No matching simulation options found for \"${trial.simulation_options}\". Using \"default\" options.`);\n                            trial_sim_opts = this.simulation_options.default;\n                        }\n                        else {\n                            console.log(`No matching simulation options found for \"${trial.simulation_options}\" and no \"default\" options provided. Using the default values provided by the plugin.`);\n                            trial_sim_opts = {};\n                        }\n                    }\n                    else {\n                        trial_sim_opts = trial.simulation_options;\n                    }\n                }\n                // merge in default options that aren't overriden by the trial's simulation_options\n                // including nested parameters in the simulation_options\n                trial_sim_opts_merged = this.utils.deepMerge(this.simulation_options.default, trial_sim_opts);\n                trial_sim_opts_merged = this.utils.deepCopy(trial_sim_opts_merged);\n                trial_sim_opts_merged = this.replaceFunctionsWithValues(trial_sim_opts_merged, null);\n                if ((trial_sim_opts_merged === null || trial_sim_opts_merged === void 0 ? void 0 : trial_sim_opts_merged.simulate) === false) {\n                    trial_complete = trial.type.trial(this.DOM_target, trial, load_callback);\n                }\n                else {\n                    trial_complete = trial.type.simulate(trial, (trial_sim_opts_merged === null || trial_sim_opts_merged === void 0 ? void 0 : trial_sim_opts_merged.mode) || this.simulation_mode, trial_sim_opts_merged, load_callback);\n                }\n            }\n            else {\n                // trial doesn't have a simulate method, so just run as usual\n                trial_complete = trial.type.trial(this.DOM_target, trial, load_callback);\n            }\n        }\n        // see if trial_complete is a Promise by looking for .then() function\n        const is_promise = trial_complete && typeof trial_complete.then == \"function\";\n        // in simulation mode we let the simulate function call the load_callback always,\n        // so we don't need to call it here. however, if we are in simulation mode but not simulating\n        // this particular trial we need to call it.\n        if (!is_promise &&\n            (!this.simulation_mode || (this.simulation_mode && (trial_sim_opts_merged === null || trial_sim_opts_merged === void 0 ? void 0 : trial_sim_opts_merged.simulate) === false))) {\n            load_callback();\n        }\n        // done with callbacks\n        this.internal.call_immediate = false;\n    }\n    evaluateTimelineVariables(trial) {\n        for (const key of Object.keys(trial)) {\n            if (typeof trial[key] === \"object\" &&\n                trial[key] !== null &&\n                typeof trial[key].timelineVariablePlaceholder !== \"undefined\") {\n                trial[key] = trial[key].timelineVariableFunction();\n            }\n            // timeline variables that are nested in objects\n            if (typeof trial[key] === \"object\" &&\n                trial[key] !== null &&\n                key !== \"timeline\" &&\n                key !== \"timeline_variables\") {\n                this.evaluateTimelineVariables(trial[key]);\n            }\n        }\n    }\n    evaluateFunctionParameters(trial) {\n        // set a flag so that jsPsych.timelineVariable() is immediately executed in this context\n        this.internal.call_immediate = true;\n        // iterate over each parameter\n        for (const key of Object.keys(trial)) {\n            // check to make sure parameter is not \"type\", since that was eval'd above.\n            if (key !== \"type\") {\n                // this if statement is checking to see if the parameter type is expected to be a function, in which case we should NOT evaluate it.\n                // the first line checks if the parameter is defined in the universalPluginParameters set\n                // the second line checks the plugin-specific parameters\n                if (typeof universalPluginParameters[key] !== \"undefined\" &&\n                    universalPluginParameters[key].type !== ParameterType.FUNCTION) {\n                    trial[key] = this.replaceFunctionsWithValues(trial[key], null);\n                }\n                if (typeof trial.type.info.parameters[key] !== \"undefined\" &&\n                    trial.type.info.parameters[key].type !== ParameterType.FUNCTION) {\n                    trial[key] = this.replaceFunctionsWithValues(trial[key], trial.type.info.parameters[key]);\n                }\n            }\n        }\n        // reset so jsPsych.timelineVariable() is no longer immediately executed\n        this.internal.call_immediate = false;\n    }\n    replaceFunctionsWithValues(obj, info) {\n        // null typeof is 'object' (?!?!), so need to run this first!\n        if (obj === null) {\n            return obj;\n        }\n        // arrays\n        else if (Array.isArray(obj)) {\n            for (let i = 0; i < obj.length; i++) {\n                obj[i] = this.replaceFunctionsWithValues(obj[i], info);\n            }\n        }\n        // objects\n        else if (typeof obj === \"object\") {\n            if (info === null || !info.nested) {\n                for (const key of Object.keys(obj)) {\n                    if (key === \"type\" || key === \"timeline\" || key === \"timeline_variables\") {\n                        // Ignore the object's `type` field because it contains a plugin and we do not want to\n                        // call plugin functions. Also ignore `timeline` and `timeline_variables` because they\n                        // are used in the `trials` parameter of the preload plugin and we don't want to actually\n                        // evaluate those in that context.\n                        continue;\n                    }\n                    obj[key] = this.replaceFunctionsWithValues(obj[key], null);\n                }\n            }\n            else {\n                for (const key of Object.keys(obj)) {\n                    if (typeof info.nested[key] === \"object\" &&\n                        info.nested[key].type !== ParameterType.FUNCTION) {\n                        obj[key] = this.replaceFunctionsWithValues(obj[key], info.nested[key]);\n                    }\n                }\n            }\n        }\n        else if (typeof obj === \"function\") {\n            return obj();\n        }\n        return obj;\n    }\n    setDefaultValues(trial) {\n        for (const param in trial.type.info.parameters) {\n            // check if parameter is complex with nested defaults\n            if (trial.type.info.parameters[param].type === ParameterType.COMPLEX) {\n                // check if parameter is undefined and has a default value\n                if (typeof trial[param] === \"undefined\" && trial.type.info.parameters[param].default) {\n                    trial[param] = trial.type.info.parameters[param].default;\n                }\n                // if parameter is an array, iterate over each entry after confirming that there are\n                // entries to iterate over. this is common when some parameters in a COMPLEX type have\n                // default values and others do not.\n                if (trial.type.info.parameters[param].array === true && Array.isArray(trial[param])) {\n                    // iterate over each entry in the array\n                    trial[param].forEach(function (ip, i) {\n                        // check each parameter in the plugin description\n                        for (const p in trial.type.info.parameters[param].nested) {\n                            if (typeof trial[param][i][p] === \"undefined\" || trial[param][i][p] === null) {\n                                if (typeof trial.type.info.parameters[param].nested[p].default === \"undefined\") {\n                                    console.error(`You must specify a value for the ${p} parameter (nested in the ${param} parameter) in the ${trial.type.info.name} plugin.`);\n                                }\n                                else {\n                                    trial[param][i][p] = trial.type.info.parameters[param].nested[p].default;\n                                }\n                            }\n                        }\n                    });\n                }\n            }\n            // if it's not nested, checking is much easier and do that here:\n            else if (typeof trial[param] === \"undefined\" || trial[param] === null) {\n                if (typeof trial.type.info.parameters[param].default === \"undefined\") {\n                    console.error(`You must specify a value for the ${param} parameter in the ${trial.type.info.name} plugin.`);\n                }\n                else {\n                    trial[param] = trial.type.info.parameters[param].default;\n                }\n            }\n        }\n    }\n    checkExclusions(exclusions) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (exclusions.min_width || exclusions.min_height || exclusions.audio) {\n                console.warn(\"The exclusions option in `initJsPsych()` is deprecated and will be removed in a future version. We recommend using the browser-check plugin instead. See https://www.jspsych.org/latest/plugins/browser-check/.\");\n            }\n            // MINIMUM SIZE\n            if (exclusions.min_width || exclusions.min_height) {\n                const mw = exclusions.min_width || 0;\n                const mh = exclusions.min_height || 0;\n                if (window.innerWidth < mw || window.innerHeight < mh) {\n                    this.getDisplayElement().innerHTML =\n                        \"<p>Your browser window is too small to complete this experiment. \" +\n                            \"Please maximize the size of your browser window. If your browser window is already maximized, \" +\n                            \"you will not be able to complete this experiment.</p>\" +\n                            \"<p>The minimum width is \" +\n                            mw +\n                            \"px. Your current width is \" +\n                            window.innerWidth +\n                            \"px.</p>\" +\n                            \"<p>The minimum height is \" +\n                            mh +\n                            \"px. Your current height is \" +\n                            window.innerHeight +\n                            \"px.</p>\";\n                    // Wait for window size to increase\n                    while (window.innerWidth < mw || window.innerHeight < mh) {\n                        yield delay(100);\n                    }\n                    this.getDisplayElement().innerHTML = \"\";\n                }\n            }\n            // WEB AUDIO API\n            if (typeof exclusions.audio !== \"undefined\" && exclusions.audio) {\n                if (!window.hasOwnProperty(\"AudioContext\") && !window.hasOwnProperty(\"webkitAudioContext\")) {\n                    this.getDisplayElement().innerHTML =\n                        \"<p>Your browser does not support the WebAudio API, which means that you will not \" +\n                            \"be able to complete the experiment.</p><p>Browsers that support the WebAudio API include \" +\n                            \"Chrome, Firefox, Safari, and Edge.</p>\";\n                    throw new Error();\n                }\n            }\n        });\n    }\n    drawProgressBar(msg) {\n        document\n            .querySelector(\".jspsych-display-element\")\n            .insertAdjacentHTML(\"afterbegin\", '<div id=\"jspsych-progressbar-container\">' +\n            \"<span>\" +\n            msg +\n            \"</span>\" +\n            '<div id=\"jspsych-progressbar-outer\">' +\n            '<div id=\"jspsych-progressbar-inner\"></div>' +\n            \"</div></div>\");\n    }\n    updateProgressBar() {\n        this.setProgressBar(this.getProgress().percent_complete / 100);\n    }\n    setProgressBar(proportion_complete) {\n        proportion_complete = Math.max(Math.min(1, proportion_complete), 0);\n        document.querySelector(\"#jspsych-progressbar-inner\").style.width =\n            proportion_complete * 100 + \"%\";\n        this.progress_bar_amount = proportion_complete;\n    }\n    getProgressBarCompleted() {\n        return this.progress_bar_amount;\n    }\n}\n\n// __rollup-babel-import-regenerator-runtime__\n// temporary patch for Safari\nif (typeof window !== \"undefined\" &&\n    window.hasOwnProperty(\"webkitAudioContext\") &&\n    !window.hasOwnProperty(\"AudioContext\")) {\n    // @ts-expect-error\n    window.AudioContext = webkitAudioContext;\n}\n// end patch\n// The following function provides a uniform interface to initialize jsPsych, no matter whether a\n// browser supports ES6 classes or not (and whether the ES6 build or the Babel build is used).\n/**\n * Creates a new JsPsych instance using the provided options.\n *\n * @param options The options to pass to the JsPsych constructor\n * @returns A new JsPsych instance\n */\nfunction initJsPsych(options) {\n    const jsPsych = new JsPsych(options);\n    // Handle invocations of non-existent v6 methods with migration errors\n    const migrationMessages = {\n        init: \"`jsPsych.init()` was replaced by `initJsPsych()` in jsPsych v7.\",\n        ALL_KEYS: 'jsPsych.ALL_KEYS was replaced by the \"ALL_KEYS\" string in jsPsych v7.',\n        NO_KEYS: 'jsPsych.NO_KEYS was replaced by the \"NO_KEYS\" string in jsPsych v7.',\n        // Getter functions that were renamed\n        currentTimelineNodeID: \"`currentTimelineNodeID()` was renamed to `getCurrentTimelineNodeID()` in jsPsych v7.\",\n        progress: \"`progress()` was renamed to `getProgress()` in jsPsych v7.\",\n        startTime: \"`startTime()` was renamed to `getStartTime()` in jsPsych v7.\",\n        totalTime: \"`totalTime()` was renamed to `getTotalTime()` in jsPsych v7.\",\n        currentTrial: \"`currentTrial()` was renamed to `getCurrentTrial()` in jsPsych v7.\",\n        initSettings: \"`initSettings()` was renamed to `getInitSettings()` in jsPsych v7.\",\n        allTimelineVariables: \"`allTimelineVariables()` was renamed to `getAllTimelineVariables()` in jsPsych v7.\",\n    };\n    Object.defineProperties(jsPsych, Object.fromEntries(Object.entries(migrationMessages).map(([key, message]) => [\n        key,\n        {\n            get() {\n                throw new MigrationError(message);\n            },\n        },\n    ])));\n    return jsPsych;\n}\n\nexport { JsPsych, ParameterType, initJsPsych, universalPluginParameters };\n//# sourceMappingURL=index.js.map\n","import { ParameterType } from 'jspsych';\n\nconst info = {\n    name: \"preload\",\n    parameters: {\n        /** Whether or not to automatically preload any media files based on the timeline passed to jsPsych.run. */\n        auto_preload: {\n            type: ParameterType.BOOL,\n            pretty_name: \"Auto-preload\",\n            default: false,\n        },\n        /** A timeline of trials to automatically preload. If one or more trial objects is provided in the timeline array, then the plugin will attempt to preload the media files used in the trial(s). */\n        trials: {\n            type: ParameterType.TIMELINE,\n            pretty_name: \"Trials\",\n            default: [],\n        },\n        /**\n         * Array with one or more image files to load. This parameter is often used in cases where media files cannot#\n         * be automatically preloaded based on the timeline, e.g. because the media files are passed into an image plugin/parameter with\n         * timeline variables or dynamic parameters, or because the image is embedded in an HTML string.\n         */\n        images: {\n            type: ParameterType.STRING,\n            pretty_name: \"Images\",\n            default: [],\n            array: true,\n        },\n        /**\n         * Array with one or more audio files to load. This parameter is often used in cases where media files cannot\n         * be automatically preloaded based on the timeline, e.g. because the media files are passed into an audio plugin/parameter with\n         * timeline variables or dynamic parameters, or because the audio is embedded in an HTML string.\n         */\n        audio: {\n            type: ParameterType.STRING,\n            pretty_name: \"Audio\",\n            default: [],\n            array: true,\n        },\n        /**\n         * Array with one or more video files to load. This parameter is often used in cases where media files cannot\n         * be automatically preloaded based on the timeline, e.g. because the media files are passed into a video plugin/parameter with\n         * timeline variables or dynamic parameters, or because the video is embedded in an HTML string.\n         */\n        video: {\n            type: ParameterType.STRING,\n            pretty_name: \"Video\",\n            default: [],\n            array: true,\n        },\n        /** HTML-formatted message to be shown above the progress bar while the files are loading. */\n        message: {\n            type: ParameterType.HTML_STRING,\n            pretty_name: \"Message\",\n            default: null,\n        },\n        /** Whether or not to show the loading progress bar. */\n        show_progress_bar: {\n            type: ParameterType.BOOL,\n            pretty_name: \"Show progress bar\",\n            default: true,\n        },\n        /**\n         * Whether or not to continue with the experiment if a loading error occurs. If false, then if a loading error occurs,\n         * the error_message will be shown on the page and the trial will not end. If true, then if if a loading error occurs, the trial will end\n         * and preloading failure will be logged in the trial data.\n         */\n        continue_after_error: {\n            type: ParameterType.BOOL,\n            pretty_name: \"Continue after error\",\n            default: false,\n        },\n        /** Error message to show on the page in case of any loading errors. This parameter is only relevant when continue_after_error is false. */\n        error_message: {\n            type: ParameterType.HTML_STRING,\n            pretty_name: \"Error message\",\n            default: \"The experiment failed to load.\",\n        },\n        /**\n         * Whether or not to show a detailed error message on the page. If true, then detailed error messages will be shown on the\n         * page for all files that failed to load, along with the general error_message. This parameter is only relevant when continue_after_error is false.\n         */\n        show_detailed_errors: {\n            type: ParameterType.BOOL,\n            pretty_name: \"Show detailed errors\",\n            default: false,\n        },\n        /**\n         * The maximum amount of time that the plugin should wait before stopping the preload and either ending the trial\n         * (if continue_after_error is true) or stopping the experiment with an error message (if continue_after_error is false).\n         * If null, the plugin will wait indefintely for the files to load.\n         */\n        max_load_time: {\n            type: ParameterType.INT,\n            pretty_name: \"Max load time\",\n            default: null,\n        },\n        /** Function to be called after a file fails to load. The function takes the file name as its only argument. */\n        on_error: {\n            type: ParameterType.FUNCTION,\n            pretty_name: \"On error\",\n            default: null,\n        },\n        /** Function to be called after a file loads successfully. The function takes the file name as its only argument. */\n        on_success: {\n            type: ParameterType.FUNCTION,\n            pretty_name: \"On success\",\n            default: null,\n        },\n    },\n};\n/**\n * **preload**\n *\n * jsPsych plugin for preloading image, audio, and video files\n *\n * @author Becky Gilbert\n * @see {@link https://www.jspsych.org/plugins/jspsych-preload/ preload plugin documentation on jspsych.org}\n */\nclass PreloadPlugin {\n    constructor(jsPsych) {\n        this.jsPsych = jsPsych;\n    }\n    trial(display_element, trial) {\n        var success = null;\n        var timeout = false;\n        var failed_images = [];\n        var failed_audio = [];\n        var failed_video = [];\n        var detailed_errors = [];\n        var in_safe_mode = this.jsPsych.getSafeModeStatus();\n        // create list of media to preload //\n        var images = [];\n        var audio = [];\n        var video = [];\n        if (trial.auto_preload) {\n            var experiment_timeline = this.jsPsych.getTimeline();\n            var auto_preload = this.jsPsych.pluginAPI.getAutoPreloadList(experiment_timeline);\n            images = images.concat(auto_preload.images);\n            audio = audio.concat(auto_preload.audio);\n            video = video.concat(auto_preload.video);\n        }\n        if (trial.trials.length > 0) {\n            var trial_preloads = this.jsPsych.pluginAPI.getAutoPreloadList(trial.trials);\n            images = images.concat(trial_preloads.images);\n            audio = audio.concat(trial_preloads.audio);\n            video = video.concat(trial_preloads.video);\n        }\n        images = images.concat(trial.images);\n        audio = audio.concat(trial.audio);\n        video = video.concat(trial.video);\n        images = this.jsPsych.utils.unique(images.flat());\n        audio = this.jsPsych.utils.unique(audio.flat());\n        video = this.jsPsych.utils.unique(video.flat());\n        if (in_safe_mode) {\n            // don't preload video if in safe mode (experiment is running via file protocol)\n            video = [];\n        }\n        // render display of message and progress bar\n        var html = \"\";\n        if (trial.message !== null) {\n            html += trial.message;\n        }\n        if (trial.show_progress_bar) {\n            html += `\n            <div id='jspsych-loading-progress-bar-container' style='height: 10px; width: 300px; background-color: #ddd; margin: auto;'>\n              <div id='jspsych-loading-progress-bar' style='height: 10px; width: 0%; background-color: #777;'></div>\n            </div>`;\n        }\n        display_element.innerHTML = html;\n        const update_loading_progress_bar = () => {\n            loaded++;\n            if (trial.show_progress_bar) {\n                var percent_loaded = (loaded / total_n) * 100;\n                var preload_progress_bar = display_element.querySelector(\"#jspsych-loading-progress-bar\");\n                if (preload_progress_bar !== null) {\n                    preload_progress_bar.style.width = percent_loaded + \"%\";\n                }\n            }\n        };\n        // called if all files load successfully\n        const on_success = () => {\n            if (typeof timeout !== \"undefined\" && timeout === false) {\n                // clear timeout immediately after finishing, to handle race condition with max_load_time\n                this.jsPsych.pluginAPI.clearAllTimeouts();\n                // need to call cancel preload function to clear global jsPsych preload_request list, even when they've all succeeded\n                this.jsPsych.pluginAPI.cancelPreloads();\n                success = true;\n                end_trial();\n            }\n        };\n        // called if all_files haven't finished loading when max_load_time is reached\n        const on_timeout = () => {\n            this.jsPsych.pluginAPI.cancelPreloads();\n            if (typeof success !== \"undefined\" && (success === false || success === null)) {\n                timeout = true;\n                if (loaded_success < total_n) {\n                    success = false;\n                }\n                after_error(\"timeout\"); // call trial's on_error event handler here, in case loading timed out with no file errors\n                detailed_errors.push(\"<p><strong>Loading timed out.</strong><br>\" +\n                    \"Consider compressing your stimuli files, loading your files in smaller batches,<br>\" +\n                    \"and/or increasing the <i>max_load_time</i> parameter.</p>\");\n                if (trial.continue_after_error) {\n                    end_trial();\n                }\n                else {\n                    stop_with_error_message();\n                }\n            }\n        };\n        const stop_with_error_message = () => {\n            this.jsPsych.pluginAPI.clearAllTimeouts();\n            this.jsPsych.pluginAPI.cancelPreloads();\n            // show error message\n            display_element.innerHTML = trial.error_message;\n            // show detailed errors, if necessary\n            if (trial.show_detailed_errors) {\n                display_element.innerHTML += \"<p><strong>Error details:</strong></p>\";\n                detailed_errors.forEach((e) => {\n                    display_element.innerHTML += e;\n                });\n            }\n        };\n        const end_trial = () => {\n            // clear timeout again when end_trial is called, to handle race condition with max_load_time\n            this.jsPsych.pluginAPI.clearAllTimeouts();\n            var trial_data = {\n                success: success,\n                timeout: timeout,\n                failed_images: failed_images,\n                failed_audio: failed_audio,\n                failed_video: failed_video,\n            };\n            // clear the display\n            display_element.innerHTML = \"\";\n            this.jsPsych.finishTrial(trial_data);\n        };\n        // do preloading\n        if (trial.max_load_time !== null) {\n            this.jsPsych.pluginAPI.setTimeout(on_timeout, trial.max_load_time);\n        }\n        var total_n = images.length + audio.length + video.length;\n        var loaded = 0; // success or error count\n        var loaded_success = 0; // success count\n        if (total_n == 0) {\n            on_success();\n        }\n        else {\n            const load_video = (cb) => {\n                this.jsPsych.pluginAPI.preloadVideo(video, cb, file_loading_success, file_loading_error);\n            };\n            const load_audio = (cb) => {\n                this.jsPsych.pluginAPI.preloadAudio(audio, cb, file_loading_success, file_loading_error);\n            };\n            const load_images = (cb) => {\n                this.jsPsych.pluginAPI.preloadImages(images, cb, file_loading_success, file_loading_error);\n            };\n            if (video.length > 0) {\n                load_video(() => { });\n            }\n            if (audio.length > 0) {\n                load_audio(() => { });\n            }\n            if (images.length > 0) {\n                load_images(() => { });\n            }\n        }\n        // helper functions and callbacks\n        // called when a single file loading fails\n        function file_loading_error(e) {\n            // update progress bar even if there's an error\n            update_loading_progress_bar();\n            // change success flag after first file loading error\n            if (success == null) {\n                success = false;\n            }\n            // add file to failed media list\n            var source = \"unknown file\";\n            if (e.source) {\n                source = e.source;\n            }\n            if (e.error && e.error.path && e.error.path.length > 0) {\n                if (e.error.path[0].localName == \"img\") {\n                    failed_images.push(source);\n                }\n                else if (e.error.path[0].localName == \"audio\") {\n                    failed_audio.push(source);\n                }\n                else if (e.error.path[0].localName == \"video\") {\n                    failed_video.push(source);\n                }\n            }\n            // construct detailed error message\n            var err_msg = \"<p><strong>Error loading file: \" + source + \"</strong><br>\";\n            if (e.error.statusText) {\n                err_msg += \"File request response status: \" + e.error.statusText + \"<br>\";\n            }\n            if (e.error == \"404\") {\n                err_msg += \"404 - file not found.<br>\";\n            }\n            if (typeof e.error.loaded !== \"undefined\" &&\n                e.error.loaded !== null &&\n                e.error.loaded !== 0) {\n                err_msg += e.error.loaded + \" bytes transferred.\";\n            }\n            else {\n                err_msg +=\n                    \"File did not begin loading. Check that file path is correct and reachable by the browser,<br>\" +\n                        \"and that loading is not blocked by cross-origin resource sharing (CORS) errors.\";\n            }\n            err_msg += \"</p>\";\n            detailed_errors.push(err_msg);\n            // call trial's on_error function\n            after_error(source);\n            // if this is the last file\n            if (loaded == total_n) {\n                if (trial.continue_after_error) {\n                    // if continue_after_error is false, then stop with an error\n                    end_trial();\n                }\n                else {\n                    // otherwise end the trial and continue\n                    stop_with_error_message();\n                }\n            }\n        }\n        // called when a single file loads successfully\n        function file_loading_success(source) {\n            update_loading_progress_bar();\n            // call trial's on_success function\n            after_success(source);\n            loaded_success++;\n            if (loaded_success == total_n) {\n                // if this is the last file and all loaded successfully, call success function\n                on_success();\n            }\n            else if (loaded == total_n) {\n                // if this is the last file and there was at least one error\n                if (trial.continue_after_error) {\n                    // end the trial and continue with experiment\n                    end_trial();\n                }\n                else {\n                    // if continue_after_error is false, then stop with an error\n                    stop_with_error_message();\n                }\n            }\n        }\n        function after_error(source) {\n            // call on_error function and pass file name\n            if (trial.on_error !== null) {\n                trial.on_error(source);\n            }\n        }\n        function after_success(source) {\n            // call on_success function and pass file name\n            if (trial.on_success !== null) {\n                trial.on_success(source);\n            }\n        }\n    }\n    simulate(trial, simulation_mode, simulation_options, load_callback) {\n        if (simulation_mode == \"data-only\") {\n            load_callback();\n            this.simulate_data_only(trial, simulation_options);\n        }\n        if (simulation_mode == \"visual\") {\n            this.simulate_visual(trial, simulation_options, load_callback);\n        }\n    }\n    create_simulation_data(trial, simulation_options) {\n        const default_data = {\n            success: true,\n            timeout: false,\n            failed_images: [],\n            failed_audio: [],\n            failed_video: [],\n        };\n        const data = this.jsPsych.pluginAPI.mergeSimulationData(default_data, simulation_options);\n        return data;\n    }\n    simulate_data_only(trial, simulation_options) {\n        const data = this.create_simulation_data(trial, simulation_options);\n        this.jsPsych.finishTrial(data);\n    }\n    simulate_visual(trial, simulation_options, load_callback) {\n        const display_element = this.jsPsych.getDisplayElement();\n        this.trial(display_element, trial);\n        load_callback();\n    }\n}\nPreloadPlugin.info = info;\n\nexport { PreloadPlugin as default };\n//# sourceMappingURL=index.js.map\n"],"names":["mimeDb","require$$0","db","extname","require$$1","EXTRACT_TYPE_REGEXP","TEXT_TYPE_REGEXP","exports","charset","contentType","extension","lookup","populateMaps","type","match","mime","str","exts","path","extensions","types","preference","i","from","to","camelize","string","_0","p1","p2","_1","getAgeData","birthMonth","birthYear","age","ageMonths","msPerYear","currDate","safeNumber","value","numValue","bm","by","yearsOld","ageM","ageData","birthDate","decimalYear","_birthDate","_decimalYear","_birthDate2","commonjsGlobal","global","MigrationError","message","ParameterType","alea$1","module","define","Alea","seed","me","mash","Mash","t","copy","f","impl","opts","xg","state","prng","n","data","h","aleaExports","xor128$1","XorGen","strseed","k","top","bot","result","xor128Exports","xorwow$1","xorwowExports","xorshift7$1","X","v","init","j","xorshift7Exports","xor4096$1","w","limit","xor4096Exports","tychei$1","b","c","d","a","tycheiExports","seedrandom$2","pool","math","width","chunks","digits","rngname","startdenom","significance","overflow","mask","nodecrypto","seedrandom","options","callback","key","shortseed","mixkey","flatten","tostring","autoseed","arc4","ARC4","x","is_math_call","keylen","s","count","r","obj","depth","typ","prop","stringseed","smear","out","browser","plugins","seedrandomExports","alea","xor128","xorwow","xorshift7","xor4096","tychei","sr","seedrandom$1","wordList","words","random","word","generateWordWithMaxLength","generateRandomWord","rightSize","wordUsed","randInt","lessThan","total","results","token","relativeIndex"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4]}