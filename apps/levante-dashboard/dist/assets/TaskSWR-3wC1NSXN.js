const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/swr-BDWwfr6z.js","assets/tanstack-CsBZeLmk.js","assets/sentry-CX5z418I.js","assets/phoneme-MNW3QAs-.js","assets/lodash-DAY8-RAI.js"])))=>i.map(i=>d[i]);
import{e as T,d as E,g as M,s as b,_ as R,L as B,n as w}from"./index-kdKfEdeI.js";import{u as C,a as j,p as q}from"./package-lock-D8MlMi_s.js";import{r as u,o as F,J as N,w as U,R as V,O as _,M as x,N as G,S as H,F as J}from"./tanstack-CsBZeLmk.js";import"./phoneme-MNW3QAs-.js";import"./sentry-CX5z418I.js";import"./lodash-DAY8-RAI.js";(function(){try{var a=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},r=new a.Error().stack;r&&(a._sentryDebugIds=a._sentryDebugIds||{},a._sentryDebugIds[r]="c1e43739-5f17-4734-95b6-d89edbffc4d7",a._sentryDebugIdIdentifier="sentry-dbid-c1e43739-5f17-4734-95b6-d89edbffc4d7")}catch{}})();const Z={__name:"TaskSWR",props:{taskId:{type:String,required:!0,default:"swr"}},setup(a){const r=a;let n;const c=r.taskId,{version:k}=q.packages["node_modules/@bdelab/roar-swr"],d=T(),l=u(!1),f=u(!1),o=E(),m=M(),{isFirekitInit:v,roarfirekit:I}=b(o),{mutateAsync:S}=C(),p=u(!1);let i;const g=()=>{i&&i(),p.value=!0},h=()=>{d.go(0)};i=o.$subscribe(async(e,t)=>{t.roarfirekit.restConfig&&g()});const{isLoading:A,data:y}=j({enabled:p});window.addEventListener("popstate",()=>{h()},{once:!0}),F(async()=>{try{n=(await R(async()=>{const{default:e}=await import("./swr-BDWwfr6z.js");return{default:e}},__vite__mapDeps([0,1,2,3,4]))).default}catch(e){console.error("An error occurred while importing the game module.",e)}I.value.restConfig&&g()}),N(()=>{window.removeEventListener("popstate",h)}),U([v,A],async([e,t])=>{if(e&&!t&&!l.value){l.value=!0;const{selectedAdmin:s}=b(m);await L(s)}},{immediate:!0});async function L(e){try{let t=setInterval(function(){document.querySelector(".jspsych-content-wrapper")&&(f.value=!0,clearInterval(t))},100);const s=await o.roarfirekit.startAssessment(e.value.id,c,k),D={grade:"",birthMonth:w(y.value,"birthMonth"),birthYear:w(y.value,"birthYear")},P={...s._taskInfo.variantParams};await new n(s,P,D,"jspsych-target").run().then(async()=>{await S({adminId:e.value.id,taskId:c}),m.requireHomeRefresh(),d.push({name:"Home"})})}catch(t){console.error("An error occurred while starting the task:",t),alert("An error occurred while starting the task. Please refresh the page and try again. If the error persists, please submit an issue report.")}}return(e,t)=>(_(),V(J,null,[f.value?G("",!0):(_(),x(B,{key:0,fullscreen:""})),t[0]||(t[0]=H("div",{id:"jspsych-target",class:"game-target",translate:"no"},null,-1))],64))}};export{Z as default};
//# sourceMappingURL=TaskSWR-3wC1NSXN.js.map
