const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/phoneme-MNW3QAs-.js","assets/tanstack-CsBZeLmk.js","assets/sentry-CX5z418I.js","assets/lodash-DAY8-RAI.js"])))=>i.map(i=>d[i]);
import{e as T,d as E,g as M,s as y,_ as B,L as C,n as _}from"./index-kdKfEdeI.js";import{u as R,a as j,p as F}from"./package-lock-D8MlMi_s.js";import{r as c,o as N,J as U,w as V,R as q,O as k,M as x,N as G,S as H,F as J}from"./tanstack-CsBZeLmk.js";import"./phoneme-MNW3QAs-.js";import"./sentry-CX5z418I.js";import"./lodash-DAY8-RAI.js";(function(){try{var a=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},r=new a.Error().stack;r&&(a._sentryDebugIds=a._sentryDebugIds||{},a._sentryDebugIds[r]="6dd57c5a-37bb-43bd-92c3-8bdd003ca4a3",a._sentryDebugIdIdentifier="sentry-dbid-6dd57c5a-37bb-43bd-92c3-8bdd003ca4a3")}catch{}})();const Z={__name:"TaskPA",props:{taskId:{type:String,default:"pa"}},setup(a){const r=a;let n;const u=r.taskId,{version:v}=F.packages["node_modules/@bdelab/roar-pa"],d=T(),l=c(!1),p=c(!1),o=E(),m=M(),{isFirekitInit:w,roarfirekit:I}=y(o),{mutateAsync:A}=R(),f=c(!1);let i;const g=()=>{i&&i(),f.value=!0},h=()=>{d.go(0)};i=o.$subscribe(async(t,e)=>{e.roarfirekit.restConfig&&g()});const{isLoading:S,data:b}=j({enabled:f});window.addEventListener("popstate",()=>{h()},{once:!0}),N(async()=>{try{n=(await B(async()=>{const{default:t}=await import("./phoneme-MNW3QAs-.js").then(e=>e.i);return{default:t}},__vite__mapDeps([0,1,2,3]))).default}catch(t){console.error("An error occurred while importing the game module.",t)}I.value.restConfig&&g()}),U(()=>{window.removeEventListener("popstate",h)}),V([w,S],async([t,e])=>{if(t&&!e&&!l.value){l.value=!0;const{selectedAdmin:s}=y(m);await L(s)}},{immediate:!0});async function L(t){try{let e=setInterval(function(){document.querySelector(".jspsych-content-wrapper")&&(p.value=!0,clearInterval(e))},100);const s=await o.roarfirekit.startAssessment(t.value.id,u,v),D={grade:"",birthMonth:_(b.value,"birthMonth"),birthYear:_(b.value,"birthYear")},P={...s._taskInfo.variantParams};await new n(s,P,D,"jspsych-target").run().then(async()=>{await A({adminId:t.value.id,taskId:u}),m.requireHomeRefresh(),d.push({name:"Home"})})}catch(e){console.error("An error occurred while starting the task:",e),alert("An error occurred while starting the task. Please refresh the page and try again. If the error persists, please submit an issue report.")}}return(t,e)=>(k(),q(J,null,[p.value?G("",!0):(k(),x(C,{key:0,fullscreen:""})),e[0]||(e[0]=H("div",{id:"jspsych-target",class:"game-target",translate:"no"},null,-1))],64))}};export{Z as default};
//# sourceMappingURL=TaskPA-DjPoHwOt.js.map
