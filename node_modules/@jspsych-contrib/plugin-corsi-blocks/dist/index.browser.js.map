{"version":3,"file":"index.browser.js","sources":["../src/index.ts"],"sourcesContent":["import { JsPsych, JsPsychPlugin, ParameterType, TrialType } from \"jspsych\";\n\nconst info = <const>{\n  name: \"corsi-blocks\",\n  parameters: {\n    /**\n     * An array of block indexes that specify the order of the sequence to be displayed. For example,\n     * [0, 1, 2, 3, 4] would display the first 5 blocks in the order they appear in the blocks parameter.\n     */\n    sequence: {\n      type: ParameterType.INT,\n      default: undefined,\n      array: true,\n    },\n    /**\n     * An array of objects that specify the x and y coordinates of each block. The coordinates represent the center\n     * of the block. The coordinates are specified as percentages of the width and height of the display. For example,\n     * {x: 50, y: 50} would place the block in the center of the display.\n     *\n     * The default value is an array of nine blocks that approximates the layout of the original Corsi blocks task.\n     */\n    blocks: {\n      type: ParameterType.COMPLEX,\n      array: true,\n      default: [\n        { y: 80, x: 45 },\n        { y: 94, x: 80 },\n        { y: 70, x: 20 },\n        { y: 60, x: 70 },\n        { y: 50, x: 35 },\n        { y: 40, x: 6 },\n        { y: 45, x: 94 },\n        { y: 25, x: 60 },\n        { y: 6, x: 47 },\n      ],\n      nested: {\n        x: {\n          type: ParameterType.INT,\n          default: undefined,\n        },\n        y: {\n          type: ParameterType.INT,\n          default: undefined,\n        },\n      },\n    },\n    /**\n     * The size of the blocks as a percentage of the overall display size.\n     */\n    block_size: {\n      type: ParameterType.INT,\n      default: 12,\n    },\n    /**\n     * The width of the display, specified as a valid CSS measurement.\n     */\n    display_width: {\n      type: ParameterType.STRING,\n      default: \"400px\",\n    },\n    /**\n     * The height of the display, specified as a valid CSS measurement.\n     */\n    display_height: {\n      type: ParameterType.STRING,\n      default: \"400px\",\n    },\n    /**\n     * An optional text prompt that can be shown below the display area.\n     */\n    prompt: {\n      type: ParameterType.STRING,\n      default: null,\n    },\n    /**\n     * The mode of the trial. If 'display', then the sequence is displayed and the trial ends after\n     * the sequence is complete. If 'input', then the use must click on the blocks in the correct order.\n     */\n    mode: {\n      type: ParameterType.STRING,\n      default: \"display\",\n      options: [\"display\", \"input\"],\n    },\n    /**\n     * The duration, in milliseconds, between each block in the sequence.\n     */\n    sequence_gap_duration: {\n      type: ParameterType.INT,\n      default: 250,\n    },\n    /**\n     * The duration, in milliseconds, that each block is displayed during the sequence.\n     */\n    sequence_block_duration: {\n      type: ParameterType.INT,\n      default: 1000,\n    },\n    /**\n     * The duration, in milliseconds, to show the blocks before the sequence begins.\n     */\n    pre_stim_duration: {\n      type: ParameterType.INT,\n      default: 500,\n    },\n    /**\n     * The duration, in milliseconds, to show the feedback response animation\n     * during input mode.\n     */\n    response_animation_duration: {\n      type: ParameterType.INT,\n      default: 500,\n    },\n    /**\n     * The color of unselected, unhighlighted blocks.\n     */\n    block_color: {\n      type: ParameterType.STRING,\n      default: \"#555\",\n    },\n    /**\n     * The color of the highlighted block.\n     */\n    highlight_color: {\n      type: ParameterType.STRING,\n      default: \"#ff0000\",\n    },\n    /**\n     * The color of correct feedback.\n     */\n    correct_color: {\n      type: ParameterType.STRING,\n      default: \"#00ff00\",\n    },\n    /**\n     * The color of incorrect feedback.\n     */\n    incorrect_color: {\n      type: ParameterType.STRING,\n      default: \"#ff0000\",\n    },\n  },\n};\n\ntype Info = typeof info;\n\n/**\n * **corsi-blocks**\n *\n * This plugin displays a sequence of blocks and then gets the\n * subject's response. The sequence can be displayed in either\n * 'display' mode or 'input' mode. In 'display' mode, the\n * sequence is displayed and the trial ends after the sequence\n * is complete. In 'input' mode, the subject must click on the\n * blocks in the correct order.\n *\n * @author Josh de Leeuw\n * @see {@link https://DOCUMENTATION_URL DOCUMENTATION LINK TEXT}\n */\nclass CorsiBlocksPlugin implements JsPsychPlugin<Info> {\n  static info = info;\n\n  constructor(private jsPsych: JsPsych) {}\n\n  trial(display_element: HTMLElement, trial: TrialType<Info>) {\n    let css = `<style id=\"jspsych-corsi-css\">\n      #jspsych-corsi-stimulus { \n        position: relative; \n        width:${trial.display_width}; \n        height:${trial.display_height};\n      }\n      .jspsych-corsi-block { \n        background-color: ${trial.block_color}; \n        position: absolute; \n        width: ${trial.block_size}%; \n        height: ${trial.block_size}%;\n        transform: translate(-50%, -50%);\n      }\n      #jspsych-corsi-prompt { \n        position: absolute; \n        text-align: center; \n        width: ${trial.display_width}; \n        top: 100%; \n      }\n      #jspsych-corsi-prompt p { \n        font-size: 18px; \n      }\n      ${trial.mode == \"input\" ? \".jspsych-corsi-block { cursor: pointer; }\" : \"\"}\n    </style>`;\n\n    let html = css;\n    html += '<div id=\"jspsych-corsi-stimulus\">';\n\n    for (let i = 0; i < trial.blocks.length; i++) {\n      html += `<div class=\"jspsych-corsi-block\" data-id=\"${i}\" style=\"top:${trial.blocks[i].y}%; left:${trial.blocks[i].x}%;\"></div>`;\n    }\n\n    if (trial.prompt != null) {\n      html += `<div id=\"jspsych-corsi-prompt\"><p>${trial.prompt}</p></div>`;\n    }\n    html += \"</div>\";\n\n    display_element.innerHTML = html;\n\n    const start_time = performance.now();\n\n    const trial_data = {\n      sequence: trial.sequence,\n      response: [],\n      rt: [],\n      blocks: trial.blocks,\n      correct: null,\n    };\n\n    const end_trial = () => {\n      display_element.innerHTML = \"\";\n      this.jsPsych.finishTrial(trial_data);\n    };\n\n    const wait = function (fn, t) {\n      const start = performance.now();\n\n      const _wait_help = (fn, t, s) => {\n        const duration = performance.now() - s;\n        if (duration >= t) {\n          fn();\n        } else {\n          window.requestAnimationFrame(() => _wait_help(fn, t, start));\n        }\n      };\n      window.requestAnimationFrame(() => _wait_help(fn, t, start));\n    };\n\n    if (trial.mode == \"display\") {\n      let sequence_location = 0;\n      let display_phase = \"pre-stim\";\n\n      const update_display = () => {\n        if (display_phase == \"pre-stim\") {\n          wait(update_display, trial.pre_stim_duration);\n          display_phase = \"sequence\";\n        } else if (display_phase == \"sequence\") {\n          const block: HTMLElement = display_element.querySelector(\n            `.jspsych-corsi-block[data-id=\"${trial.sequence[sequence_location]}\"]`\n          );\n          if (sequence_location < trial.sequence.length) {\n            block.style.backgroundColor = trial.highlight_color;\n            wait(update_display, trial.sequence_block_duration);\n            display_phase = \"iti\";\n          }\n          if (sequence_location == trial.sequence.length) {\n            end_trial();\n          }\n        } else if (display_phase == \"iti\") {\n          const block: HTMLElement = display_element.querySelector(\n            `.jspsych-corsi-block[data-id=\"${trial.sequence[sequence_location]}\"]`\n          );\n          block.style.backgroundColor = trial.block_color;\n          sequence_location++;\n          wait(update_display, trial.sequence_gap_duration);\n          display_phase = \"sequence\";\n        }\n      };\n\n      window.requestAnimationFrame(update_display);\n    }\n\n    if (trial.mode == \"input\") {\n      const correct_animation = [\n        { backgroundColor: trial.block_color },\n        { backgroundColor: trial.correct_color, offset: 0.2 },\n        { backgroundColor: trial.block_color },\n      ];\n\n      const incorrect_animation = [\n        { backgroundColor: trial.block_color },\n        { backgroundColor: trial.incorrect_color, offset: 0.2 },\n        { backgroundColor: trial.block_color },\n      ];\n\n      const animation_timing = {\n        duration: trial.response_animation_duration,\n        iterations: 1,\n      };\n\n      const register_click = (id: string) => {\n        if (trial_data.correct !== null) {\n          return; // extra click during timeout, do nothing\n        }\n        const rt = Math.round(performance.now() - start_time);\n        trial_data.response.push(parseInt(id));\n        trial_data.rt.push(rt);\n        const correct = parseInt(id) == trial.sequence[trial_data.response.length - 1];\n        if (correct) {\n          display_element\n            .querySelector(`.jspsych-corsi-block[data-id=\"${id}\"]`)\n            .animate(correct_animation, animation_timing);\n          if (trial_data.response.length == trial.sequence.length) {\n            trial_data.correct = true;\n            setTimeout(end_trial, trial.response_animation_duration); // allows animation to finish\n          }\n        } else {\n          display_element\n            .querySelector(`.jspsych-corsi-block[data-id=\"${id}\"]`)\n            .animate(incorrect_animation, animation_timing);\n          trial_data.correct = false;\n          setTimeout(end_trial, trial.response_animation_duration); // allows animation to finish\n        }\n      };\n\n      var blocks = display_element.querySelectorAll(\".jspsych-corsi-block\");\n      for (var i = 0; i < blocks.length; i++) {\n        blocks[i].addEventListener(\"click\", (e) => {\n          register_click((e.target as HTMLElement).getAttribute(\"data-id\"));\n        });\n      }\n    }\n  }\n}\n\nexport default CorsiBlocksPlugin;\n"],"names":["ParameterType"],"mappings":"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"}