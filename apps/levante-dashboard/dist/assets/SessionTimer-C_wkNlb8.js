import{u as S,a as M,b as O,A,c as L}from"./index-kdKfEdeI.js";import{s as x}from"./index-BfBVVvAI.js";import{u as D,a as E,b as C}from"./index-MdIIu1lP.js";import{r as m,w as y,o as N,f as U,M as k,O as B,_ as H,a1 as V,W as F,z as b}from"./tanstack-CsBZeLmk.js";import"./phoneme-MNW3QAs-.js";import"./sentry-CX5z418I.js";import"./lodash-DAY8-RAI.js";import"./index-CvlP-Xmk.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},a=new e.Error().stack;a&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[a]="5fcb6a38-bacd-4a07-bbdd-8f45786ad29a",e._sentryDebugIdIdentifier="sentry-dbid-5fcb6a38-bacd-4a07-bbdd-8f45786ad29a")}catch{}})();function R({idleThreshold:e,countdownDuration:a,onIdle:i,onTimeout:d}){const l=Math.max(0,Math.floor(Number(e)+Number(a))),s=m(!0),n=m(null),o=m(Math.floor(a/1e3)),u=m(!1),{idle:f,lastActive:r}=D(e,{listenForVisibilityChange:!1}),_=E({interval:1e3});let v=null;const T=async()=>{await d(),c()},h=()=>{if(document.hidden)s.value=!1,p();else{if(s.value=!0,!n.value)return;const t=Date.now()-n.value;if(t>=l){T();return}if(t>=e){const w=l-t;o.value=Math.floor(Math.max(w,0)/1e3),g();return}r.value=n.value,f.value=!1}},g=()=>{u.value||!s.value||(u.value=!0,i(),v=setInterval(async()=>{o.value-=1,o.value<=0&&(p(!1),await T())},1e3))},p=(t=!0)=>{u.value=!1,clearInterval(v),v=null,o.value=t?Math.floor(a/1e3):0},I=()=>{const t=_.value;n.value=t,r.value=t,f.value=!1},c=()=>{p(),I()};return y(f,t=>{t&&g()}),y(r,C(()=>{u.value||(n.value=r.value)},1e3)),N(()=>{c(),n.value=r.value,document.addEventListener("visibilitychange",h)}),U(()=>{c(),document.removeEventListener("visibilitychange",h)}),{countdownTimer:o,resetTimer:c}}const Q={__name:"SessionTimer",setup(e){const a=S(),i=M(),{mutate:d}=O(),{countdownTimer:l,resetTimer:s}=R({idleThreshold:A,countdownDuration:L,onIdle:()=>{a.require({group:"inactivity-logout",icon:"pi pi-exclamation-triangle",acceptLabel:i.t("homeSelector.inactivityLogoutAcceptLabel"),acceptIcon:"pi pi-check mr-2",blockScroll:!0,accept:s})},onTimeout:async()=>{await d()}});return(n,o)=>(B(),k(b(x),{group:"inactivity-logout",pt:{root:{class:"px-5"},content:{style:"max-width: 48rem"},closeButton:{class:"hidden"},rejectButton:{root:{class:"hidden"}}}},{message:H(()=>[V(F(b(i).t("homeSelector.inactivityLogout",{timeLeft:b(l)})),1)]),_:1}))}};export{Q as default};
//# sourceMappingURL=SessionTimer-C_wkNlb8.js.map
